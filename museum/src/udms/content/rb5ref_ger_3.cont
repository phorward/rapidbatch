template_ref.html§0TITLE§1SYNTAX§1DESCRIPTION§1EXAMPLE§1REMARKS
rb5ref_ger_3_chdirmkdirrmdir.html§CHDIR, MKDIR, RMDIR§CHDIR Pfad<br><!-- br -->MKDIR Pfad<br><!-- br -->RMDIR Pfad§CHDIR wechselt das aktuelle Arbeitsverzeichnis in das gegebene Verzeichnis, MKDIR legt das gegebene Verzeichnis neu an.<br><!-- br -->Mit RMDIR wird das gegebene Verzeichnis entfernt, wobei dieses komplett leer sein muss und keine Unterverzeichnisse enthalten darf.§chdir <font color="#0000ff">'c:\jmksf\rb5'</font><br /><!-- br -->mkdir <font color="#0000ff">'c:\test'</font><br /><!-- br -->rmdir <font color="#0000ff">'c:\test'</font><!-- br -->§War die jeweilige Operation erfolgreich, so erhält die Variable [errorcode] den Wert 0, andernfalls -1. Mit dieser Möglichkeit kann z.B. geprüft werden, ob ein Verzeichnis existiert oder nicht.<br /><br /><!-- br --><!-- br -->Um gesamte Verzeichnisse mitsamt Unterverzeichnissen und Dateien zu löschen, verwenden Sie die RapidBATCH Library-Funktion DELDIR, die in der SYSTEM.RB Bibliothek definiert ist.
rb5ref_ger_3_system.html§SYSTEM§SYSTEM Kommando§Führt ein Betriebssystemkommando oder Programm aus. Dies sind unter Windows reine DOS-Befehle. Das Script wartet solange mit der Ausführung bis das mit SYSTEM gestartete Programm beendet wurde.§system <font color="#0000ff">'dir &gt;list.txt'</font>§Die Variable [errorcode] erhält den Wert -1, wenn kein COMMAND.COM oder CMD.EXE gefunden wurde, andernfalls 0.
rb5ref_ger_3_shell.html§SHELL§SHELL Programmpfad, Anzeigemodus§Führt ein externes Programm aus.<br><!-- br --><br><!-- br -->Das Script wird dabei fortgeführt, so dass das gestartete Programm mit dem Script parallel läuft (Multitasking). Die Anweisung erwartet einen Programmpfad (.EXE, .COM oder .BAT) und einen Anzeigemodus, der entweder durch eine Zahl oder eine der build-in Konstanten repräsentiert wird. Mögliche Werte sind SHOW (0), HIDE (1), MAXIMIZED (2) und MINIMIZED (3).§shell <font color="#0000ff">'c:\windows\calc.exe'</font>, <font color="#0000ff">'show'</font><br /><!-- br -->shell <font color="#0000ff">'c:\windows\desktop\test.bat'</font>, <font color="#0000ff">'hide'</font><!-- br -->§[errorcode] erhält einen Wert > 32 (die Prozess-ID des Programms), wenn das Programm erfolgreich gestartet werden konnte.
rb5ref_ger_3_call.html§CALL§CALL Programmpfad, Anzeigemodus§Startet ein Programm im Modalmodus. Das bedeutet, dass das RapidBATCH-Script mit der Ausführung solange wartet, bis das mit CALL gestartete Programm beendet wurde.<br><!-- br -->Äquivalent zu SHELL benötigt CALL einen Anzeigemodus-Parameter, der entweder durch eine Zahl oder eine der build-in Konstanten repräsentiert wird. Mögliche Werte sind SHOW (0), HIDE (1), MAXIMIZED (2) und MINIMIZED (3), um Programme beispielsweise minimiert oder versteckt zu starten.§echo <font color="#0000ff">'Starten von Notepad...'</font><br /><!-- br -->call <font color="#0000ff">'notepad.exe'</font>,<font color="#0000ff">'show'</font><br /><!-- br -->echo <font color="#0000ff">'Notepad wurde beendet.'</font><br /><!-- br --><b>end</b><!-- br -->§[errorcode] erhält -1, wenn ein Fehler auftrat, ansonsten den Rückgabewert des gestarteten Programms.
rb5ref_ger_3_open.html§OPEN§OPEN Pfad§OPEN öffnet eine Datei mit dem dafür vorgesehenen Programm oder eine Internetseite im Browser. Mit OPEN können auch externe Programme gestartet werden.§open <font color="#0000ff">'hello.doc'</font><br /><!-- br -->open <font color="#0000ff">'http://www.jmksf.com/'</font><br /><!-- br -->open <font color="#0000ff">'c:\windows\calc.exe'</font><br /><!-- br -->open <font color="#0000ff">'c\jmksf\rb5\samples\hello.rb'</font><!-- br -->§keine
rb5ref_ger_3_newfiledelfile.html§NEWFILE, DELFILE§NEWFILE Dateiname<br><!-- br -->DELFILE Dateiname§NEWFILE legt eine neue, leere Datei an. Existiert die Datei bereits, wird Sie mit der neuen, leeren Datei überschrieben.<br><!-- br -->DELFILE löscht eine vorhandene Datei unwiderruflich.§<font color="#808080">rem Neue Datei anlegen</font><br /><!-- br -->newfile <font color="#0000ff">'neu.txt'</font><br /><!-- br --><br /><!-- br --><font color="#808080">rem Temp-Datei löschen</font><br /><!-- br -->delfile <font color="#0000ff">'ausgabe.tmp'</font><!-- br -->§Ist die jeweilige Operation erfolgreich, so erhält [errorcode] den Wert 0, ansonsten -1.
rb5ref_ger_3_copyfilerenamefile.html§COPYFILE, RENAMEFILE§COPYFILE Quelldatei, Zieldatei<br><!-- br -->RENAMEFILE Quelldatei, Zieldatei§COPYFILE kopiert eine Quelldatei in eine Zieldatei.<br><!-- br -->RENAMEFILE verschiebt oder benennt eine Quelldatei in eine Zieldatei um.§<font color="#808080">rem Datei kopieren...</font><br /><!-- br -->copyfile <font color="#0000ff">'c:\jmksf\rb5\samples\hello.rb'</font>, <font color="#0000ff">'a:\hello.rb'</font><br /><!-- br --><br /><!-- br --><font color="#808080">rem Datei umbenennen...</font><br /><!-- br -->renamefile <font color="#0000ff">'c:\test.neu'</font>, <font color="#0000ff">'c:\test.old'</font><!-- br -->§Ist die jeweilige Operation erfolgreich, so erhält [errorcode] den Wert 0, ansonsten -1.
rb5ref_ger_3_fileexists.html§FILEEXISTS§FILEEXISTS Existenz = Dateiname§Prüft die Existenz der angegebenen Datei. Wurde die Datei gefunden, gibt die Funktion den Wert 0, ansonsten -1 zurück.§fileexists <font color="#000080">[errorcode]</font> = <font color="#0000ff">'c:\windows\calc.exe'</font><br /><!-- br --><b>if</b> <font color="#000080">[errorcode]</font> = <font color="#0000ff">'0'</font> echo <font color="#0000ff">'Die Datei CALC.EXE existiert!'</font><!-- br -->§keine
rb5ref_ger_3_getenvletenv.html§GETENV, LETENV§GETENV Wert = Umgebungsvariable<br><!-- br -->LETENV Umgebungsvariablenzuweisung§GETENV ermöglicht das Auslesen von Umgebungsvariablen. Die Funktion erwartet eine Variable, die den Wert der auszulesende Umgebungsvariable erhält sowie den Namen der Umgebungsvariable, die gelesen werden soll.<br><!-- br -->LETENV erlaubt das Setzen/Erzeugen von Umgebungsvariablen. Dabei gibt man die Umgebungsvariable, gefolgt von einem Gleichheitszeichen oder Leerzeichen und einem Wert an (siehe Beispiel).§<font color="#808080">rem PATH auslesen</font><br /><!-- br -->getenv <font color="#000080">[pathvar]</font> = <font color="#0000ff">'PATH'</font><br /><!-- br --><br /><!-- br --><font color="#808080">rem Neue Umgebungsvariable TEST erzeugen</font><br /><!-- br -->letenv <font color="#0000ff">'TEST=Hello World'</font><!-- br -->§Geänderte oder neu erstellte Variablen werden nach Beendigung des Scripts durch das Betriebssystem automatisch wieder zurückgesetzt bzw. neue Variablen werden gelöscht.
rb5ref_ger_3_findfiles.html§FINDFILES§FINDFILES Dateiliste = Dateifilter, Verzeichnistiefe§Liest alle Dateien eines Verzeichnisses (mitsamt Unterverzeichnissen) aus und gibt diese als Dateiliste zurück.<br><!-- br --><br><!-- br -->Diese Funktion benötigt als Parameter einen so genannten Dateifilter (der die Wildcards * und ? beinhalten kann) und eine Ebenen-Angabe (Verzeichnistiefe), die angibt, wieviele Unterverzeichnis-Ebenen maximal mit eingelesen werden sollen. Wird als Verzeichnistiefe der Wert 0 übergeben, liest FINDFILES alle Verzeichnisse bis zu 255 Unterverzeichnis-Ebenen ein. Wird der Wert 1 als Tiefe übergeben, so wird nur das aktuelle Verzeichnis eingelesen, bei dem Wert 2 wird das aktuelle Verzeichnis mit einer Unterverzeichnis-Ebene eingelesen, usw..<br><!-- br --><br><!-- br -->Rückgabewert ist eine Liste an Dateien (mit relativen Unterverzeichnis-Pfaden), die durch den Listentrenner (definiert in der Variable [std_sep]) voneinander getrennt sind.§<font color="#808080">rem Alle Dateien im Verzeichnis RB5 (ohne Unterverzeichnisse) auflisten</font><br /><!-- br -->chdir <font color="#0000ff">'c:\jmksf\rb5'</font><br /><!-- br -->findfiles <font color="#000080">[filelist]</font> = <font color="#0000ff">'*.*'</font>,<font color="#0000ff">'1'</font><br /><!-- br -->replacevar <font color="#000080">[filelist]</font> = <font color="#000080">[filelist]</font>, <font color="#000080">[std_sep]</font>, <font color="#000080">[new_line]</font><br /><!-- br -->echo <font color="#000080">[filelist]</font><br /><!-- br --><br /><!-- br --><font color="#808080">rem Alle EXE-Dateien von C:\JMKSF auflisten</font><br /><!-- br -->findfiles <font color="#000080">[filelist]</font> = <font color="#0000ff">'c:\jmksf\*.exe'</font>,<font color="#0000ff">'0'</font><br /><!-- br -->replacevar <font color="#000080">[filelist]</font> = <font color="#000080">[filelist]</font>, <font color="#000080">[std_sep]</font>, <font color="#000080">[new_line]</font><br /><!-- br -->echo <font color="#000080">[filelist]</font><br /><!-- br --><b>end</b><!-- br -->§Wenn Sie die Dateien zur späteren Verwendung aus der Dateiliste extrahieren wollen, benutzen Sie bitte die Funktionen GETTOK und REPLACEVAR, wie in dem Beispiel gegeben.<br><!-- br -->Die Funktionsbibliothek ARRAY.RB bietet ausserdem nützliche Funktionen und Prozeduren zum Umwandeln von Dateilisten in Arrays.
rb5ref_ger_3_filesize.html§FILESIZE§FILESIZE Dateigröße = Dateiname§Ermittelt die Größe einer Datei und gibt diese Größe in Bytes zurück.§filesize <font color="#000080">[bytes]</font> = <font color="#0000ff">'c:\command.com'</font><br /><!-- br -->echo <font color="#0000ff">'COMMAND.COM hat eine Größe von '</font> # <font color="#000080">[bytes]</font> # <font color="#0000ff">' Bytes'</font><br /><!-- br --><b>end</b><!-- br -->§Um eine Dateigröße in Kilo-, Mega-, Giga- oder Terabyte auszugeben muss der Wert jeweils durch 1024 geteilt werden. Für Kilobyte teilt man 1-mal durch 1024, für Terabyte 4-mal durch 1024, usw.
rb5ref_ger_3_diskfreedisksize.html§DISKFREE, DISKSIZE§DISKFREE Speicherplatz = Laufwerksbuchstabe<br><!-- br -->DISKSIZE Speicherplatz = Laufwerksbuchstabe§DISKFREE gibt den freien verfügbaren Speicher eines Datenträgers in Bytes zurück.<br><!-- br -->DISKSIZE gibt die gesamte Speicherkapazität eines Datenträgers in Bytes zurück.§diskfree <font color="#000080">[df]</font> = <font color="#0000ff">'C:\'</font><br /><!-- br -->echo <font color="#0000ff">'Es sind noch '</font> # <font color="#000080">[df]</font> # <font color="#0000ff">' Bytes freier Festplattenspeicher auf Laufwerk C: verfügbar.'</font><br /><!-- br -->diskfree <font color="#000080">[ds]</font> = <font color="#0000ff">'C:\'</font><br /><!-- br -->echo <font color="#0000ff">'Laufwerk C: hat ein gesamtes Volumen von '</font> # <font color="#000080">[ds]</font> # <font color="#0000ff">' Bytes.'</font><br /><!-- br --><b>end</b><!-- br -->§Um den freien Speicher  in Kilo-, Mega-, Giga- oder Terabyte auszugeben, muss der Wert jeweils durch 1024 geteilt werden. Für Kilobyte teilt man 1-mal durch 1024, für Terabyte 4-mal durch 1024, usw.
rb5ref_ger_3_disktype.html§DISKTYPE§DISKTYPE Laufwerkstypen-ID = Laufwerksbuchstabe§Gibt Auskunft über den Typ eines Speichermediums. Der Rückgabewert ist einer der folgenden Werte:<br><!-- br --><br><!-- br -->0 = Unbekanntes Medium<br><!-- br -->1 = Wechselspeicher<br><!-- br -->2 = Fixiertes Laufwerk (z.B. Festplatte)<br><!-- br -->3 = Remote Laufwerk<br><!-- br -->4 = CD-ROM<br><!-- br -->5 = RAM-Disk (z.B. USB-Stick)§disktype <font color="#000080">[type]</font> = <font color="#0000ff">'C:\'</font><br /><!-- br --><b>if</b> <font color="#000080">[type]</font> = <font color="#0000ff">'0'</font> <font color="#000080">[type]</font> = <font color="#0000ff">'unbekanntes '</font><br /><!-- br --><b>if</b> <font color="#000080">[type]</font> = <font color="#0000ff">'1'</font> <font color="#000080">[type]</font> = <font color="#0000ff">'Wechselspeicher-'</font><br /><!-- br --><b>if</b> <font color="#000080">[type]</font> = <font color="#0000ff">'2'</font> <font color="#000080">[type]</font> = <font color="#0000ff">'fixiertes '</font><br /><!-- br --><b>if</b> <font color="#000080">[type]</font> = <font color="#0000ff">'3'</font> <font color="#000080">[type]</font> = <font color="#0000ff">'Remote-'</font><br /><!-- br --><b>if</b> <font color="#000080">[type]</font> = <font color="#0000ff">'4'</font> <font color="#000080">[type]</font> = <font color="#0000ff">'CD-ROM-'</font><br /><!-- br --><b>if</b> <font color="#000080">[type]</font> = <font color="#0000ff">'5'</font> <font color="#000080">[type]</font> = <font color="#0000ff">'RAM-Disk-'</font><br /><!-- br --><br /><!-- br -->echo <font color="#0000ff">'Laufwerk C: ist ein '</font> # <font color="#000080">[type]</font> # <font color="#0000ff">'Medium'</font><br /><!-- br --><b>end</b><!-- br -->§keine
rb5ref_ger_3_getfileattletfileatt.html§GETFILEATT, LETFILEATT§GETFILEATT Attributschalter = Dateiname, Attributnummer<br><!-- br -->LETFILEATT Dateiname, Attributnummer§GETFILEATT gibt Auskunft, ob ein angefordertes Dateiattribut bei der ebenfalls spezifizierten Datei gesetzt ist oder nicht. Mögliche Werte für die Dateiattributnummer sind NORMAL (0), ARCHIVED (1), READONLY (2), COMPRESSED (3), DIRECTORY (4), HIDDEN (5) und SYSTEM (6) (zu Deutsch: Normal, Archiviert, Schreibgeschützt, Komprimiert, Verzeichnis, Versteckt und Systemdatei). Neben den numerischen Werten lassen sich optional auch die englischen Bezeichner als Attribut-Typ angeben, z.B. ARCHIVED oder READONLY.<br><!-- br -->GETFILEATT gibt 0 zurück, wenn das abgefragte Dateiattribut gesetzt ist, andernfalls -1.<br><!-- br --><br><!-- br -->LETFILEATT setzt Dateiattribute, wenn diese nicht gesetzt sind. Mögliche Werte für die Dateiattribute sind identisch zu denen von GETFILEATT, allerdings lassen sich die Attribute COMPRESSED (3) und DIRECTORY (4) nicht setzen.<br><!-- br -->Schlägt LETFILEATT fehl, so erhält [errorcode] den Wert -1, ansonsten 0.§<font color="#000080">[file]</font> = <font color="#0000ff">'..\readme.txt'</font><br /><!-- br --><br /><!-- br --><font color="#808080">rem Attribute auslesen</font><br /><!-- br --><font color="#000080">[i]</font> = <font color="#0000ff">'1'</font><br /><!-- br --><b>repeat</b><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;getfileatt <font color="#000080">[ret]</font> = <font color="#000080">[file]</font>,<font color="#000080">[i]</font><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[res]</font> = <font color="#000080">[res]</font> # <font color="#000080">[i]</font> # <font color="#0000ff">' = '</font> # <font color="#000080">[ret]</font> # <font color="#000080">[new_line]</font><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[i]</font> + <font color="#0000ff">'1'</font><br /><!-- br --><b>until</b> <font color="#000080">[i]</font> &gt; <font color="#0000ff">'6'</font><br /><!-- br --><br /><!-- br -->echo <font color="#0000ff">'File Attributes of '</font> # <font color="#000080">[file]</font> # <font color="#000080">[new_line]</font> # <font color="#000080">[new_line]</font> # <font color="#000080">[res]</font><br /><!-- br --><br /><!-- br --><font color="#808080">rem Attribute setzen</font><br /><!-- br -->letfileatt <font color="#000080">[file]</font>, <font color="#0000ff">'normal'</font><br /><!-- br --><br /><!-- br --><b>end</b><!-- br -->§keine
rb5ref_ger_3_readfile.html§READFILE§READFILE Zeile = Dateiname, Zeilennummer§Liest die angegebene Zeile aus der gegebenen Datei und gibt diese als String zurück. Ist das Dateiende erreicht, erhält [errorcode] den Wert -1, und der Rückgabestring ist "EOF" (= "End Of File"). Wenn die Datei nicht gefunden wurde, erhält nur [errorcode] den Wert -1, der Rückgabewert ist dann ein Leerstring.<br><!-- br --><br><!-- br -->Wenn als Zeilennummer ein Wert kleiner 1 angegeben wird, liest READFILE den Inhalt der gesamten Datei und gibt diesen zurück.§<font color="#808080">rem Erste Zeile lesen...</font><br /><!-- br -->readfile <font color="#000080">[text]</font> = <font color="#0000ff">'c:\test.txt'</font>, <font color="#0000ff">'1'</font><br /><!-- br --><br /><!-- br --><font color="#808080">rem Gesamte Datei lesen...</font><br /><!-- br -->readfile <font color="#000080">[text]</font> = <font color="#0000ff">'c:\test.txt'</font>, <font color="#0000ff">'0'</font><br /><!-- br --><br /><!-- br --><font color="#808080">rem Ersten 10 Zeilen einer Datei ausgeben</font><br /><!-- br --><font color="#000080">[i]</font> = <font color="#0000ff">'0'</font><br /><!-- br --><font color="#000080">[text]</font> = <font color="#0000ff">''</font><br /><!-- br --><b>repeat</b><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[i]</font> + <font color="#0000ff">'1'</font><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;readfile <font color="#000080">[zeile]</font> = <font color="#0000ff">'C:\jmksf\rb5\readme.txt'</font>,<font color="#000080">[i]</font><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[zeile]</font> ! <font color="#0000ff">'EOF'</font><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[text]</font> # <font color="#000080">[zeile]</font> # <font color="#000080">[new_line]</font><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;<b>endif</b><br /><!-- br --><b>until</b> <font color="#000080">[i]</font> = <font color="#0000ff">'10'</font> | <font color="#000080">[zeile]</font> = <font color="#0000ff">'EOF'</font><br /><!-- br --><br /><!-- br -->echo <font color="#000080">[text]</font><br /><!-- br --><b>end</b><!-- br -->§Verwenden Sie die <a href="rb5ref_ger_3_getfile.html">GETFILE</a>-Funktion, um Daten auf Byte-Ebene aus einer Datei (z.B. Binärdatei) zu lesen.
rb5ref_ger_3_writefile.html§WRITEFILE§WRITEFILE Dateiname, Stringausdruck§Schreibt den angegebenen Stringausdruck in die ebenfalls angegebene Datei, wobei die Daten ans Dateiende angehängt werden. Der Inhalt der Datei wird dabei nicht überschrieben, sondern nur erweitert. Wenn die Datei nicht existiert, wird sie automatisch erstellt.§writefile <font color="#0000ff">'c:\test.txt'</font>, <font color="#0000ff">'Hello World'</font>§Die Variable [errorcode] erhält den Wert -1, wenn die Datei nicht erstellt oder geschrieben werden konnte, andernfalls 0.<br><!-- br --><br><!-- br -->Standardmäßig hängt WRITEFILE einen Windows-Zeilenumbruch (carriage-return und line-feed) an den zu schreibenden String an. Dies kann über die Variable [eol] (end-of-line) dynamisch angepasst werden, so dass beliebige Zeichen als Zeilenende (z.B. für Unix- oder Mac-Dateien) (oder auch gar kein Zeichen) angehängt werden.<!-- br --><br><br><!-- br -->Verwenden Sie die <a href="rb5ref_ger_3_putfile.html">PUTFILE</a>-Anweisung, um Daten auf Byte-Ebene in eine Datei (z.B. Binärdatei) zu schreiben.
rb5ref_ger_3_getfile.html§GETFILE§GETFILE Liste-von-Zeichencodes = Dateiname, Start-Position, Byte-Anzahl§Liest Daten auf Byte-Ebene aus einer Datei.<br><!-- br -->Neben dem Dateinamen benötigt diese Funktion ein Anfangsbyte, welches als <i>Start-Position</i> übergeben wird, und eine Anzahl an Bytes, wieviele Zeichen von <i>Start-Position</i> aus gelesen werden sollen.<br><!-- br -->Ein ASCII-Zeichen entspricht in einer Datei einem Byte und kann maximal einen Wert von 255 annehmen (dies entspricht einem Binärwert von &quot;1111 1111&quot;, also 8 Bit = 1 Byte).<!-- br --><br><br><!-- br -->Rückgabewert ist eine Liste an ASCII-Zeichencodes, die jeweils durch das RapidBATCH-Listentrennzeichen voneinander getrennt sind (im Normalfall das Pipe-Zeichen (|)).§<font color="#808080">rem Beispielscript zur Demonstration von Datei Lese- und Schreiboperationen auf Byteebene</font><br /><!-- br -->newfile <font color="#0000ff">'test.txt'</font><br /><!-- br --><font color="#808080">rem schreiben von "Hello World" (Liste von ASCII-Zeichencodes)</font><br /><!-- br -->putfile <font color="#0000ff">'test.txt'</font>, <font color="#0000ff">'1'</font>, <font color="#0000ff">'72|101|108|108|111|32|87|111|114|108|100'</font><br /><!-- br --><br /><!-- br --><font color="#808080">rem Lesen des Wortes "World" als Liste an ASCII-Zeichencodes</font><br /><!-- br -->getfile <font color="#000080">[wort]</font> = <font color="#0000ff">'test.txt'</font>, <font color="#0000ff">'7'</font>, <font color="#0000ff">'5'</font><br /><!-- br -->echo <font color="#0000ff">'Gelesene Zeichencodes: '</font> # <font color="#000080">[wort]</font><br /><!-- br --><br /><!-- br --><font color="#808080">rem Konvertierung und Zusammenfügung der ASCII-Werte zu Klartext</font><br /><!-- br --><font color="#000080">[i]</font> = <font color="#0000ff">'0'</font><br /><!-- br --><b>repeat</b><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[i]</font> + <font color="#0000ff">'1'</font><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;gettok <font color="#000080">[ch]</font> = <font color="#000080">[wort]</font>, <font color="#0000ff">'|'</font>, <font color="#000080">[i]</font><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[ch]</font> ! <font color="#0000ff">''</font><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;getchr <font color="#000080">[ch]</font> = <font color="#000080">[ch]</font><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[klartext]</font> # <font color="#000080">[ch]</font><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;<b>endif</b><br /><!-- br --><b>until</b> <font color="#000080">[ch]</font> = <font color="#0000ff">''</font><br /><!-- br --><br /><!-- br --><font color="#808080">rem Anzeigen des Klartextes:</font><br /><!-- br -->echo <font color="#0000ff">'Klartext: '</font> # <font color="#000080">[klartext]</font>§Verwenden Sie die PUTFILE-Anweisung, um einen Wert auf Byte-Ebene in eine Datei zu schreiben.<br><!-- br -->Schlägt GETFILE fehl, erhält [errorcode] den Wert '-1' und ein Leerstring wird zurückgegeben. Andernfalls erhält [errorcode] den Wert '0'.
rb5ref_ger_3_putfile.html§PUTFILE§PUTFILE Dateiname, Start-Position, Liste-von-Zeichencodes§Schreibt einen Stringausdruck auf Byte-Ebene in eine Datei.<br><!-- br -->Als Parameter wird ein Dateiname, eine Byte-Startposition in der Datei (wo der Schreibvorgang begonnen werden soll) und eine Liste an ASCII-Zeichencodes, die ab <i>Start-Position</i> als Zeichen byteweise in die Datei geschrieben werden sollen, erwartet.<br><!-- br -->Ein ASCII-Zeichen entspricht in einer Datei einem Byte und kann maximal einen Wert von 255 annehmen (dies entspricht einem Binärwert von &quot;1111 1111&quot;, also 8 Bit = 1 Byte).§<font color="#808080">rem Schreiben einer Datei auf Byte-Ebene</font><br /><!-- br --><br /><!-- br --><font color="#808080">rem Nicht existente Datei MUSS zuerst explizit erzeugt werden!</font><br /><!-- br -->newfile <font color="#0000ff">'bytefile.bin'</font><br /><!-- br --><br /><!-- br --><font color="#000080">[klartext]</font> = <font color="#0000ff">'Dies ist der Klartext, der in die Datei geschrieben wird!'</font><br /><!-- br --><br /><!-- br --><font color="#808080">rem Konvertierung des Klartextes in eine Liste an ASCII-Zeichencodes</font><br /><!-- br --><font color="#000080">[i]</font> = <font color="#0000ff">'0'</font><br /><!-- br -->getlen <font color="#000080">[len]</font> = <font color="#000080">[klartext]</font><br /><!-- br --><b>repeat</b><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[i]</font> + <font color="#0000ff">'1'</font><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;getcharat <font color="#000080">[ch]</font> = <font color="#000080">[klartext]</font>, <font color="#000080">[i]</font><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;getasc <font color="#000080">[ch]</font> = <font color="#000080">[ch]</font><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[byteliste]</font> ! <font color="#0000ff">''</font> <font color="#000080">[byteliste]</font> # <font color="#0000ff">'|'</font><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[byteliste]</font> # <font color="#000080">[ch]</font><br /><!-- br --><b>until</b> <font color="#000080">[i]</font> = <font color="#000080">[len]</font><br /><!-- br --><br /><!-- br -->echo <font color="#0000ff">'Klartext: '</font> # <font color="#000080">[klartext]</font><br /><!-- br -->echo <font color="#0000ff">'Liste an ASCII-Zeichencodes: '</font> # <font color="#000080">[byteliste]</font><br /><!-- br --><br /><!-- br --><font color="#808080">rem Schreiben der Datei</font><br /><!-- br -->putfile <font color="#0000ff">'bytefile.bin'</font>, <font color="#0000ff">'1'</font>, <font color="#000080">[byteliste]</font><br /><!-- br --><br /><!-- br --><b>if</b> <font color="#000080">[errorcode]</font> = <font color="#000080">[false]</font><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'PUTFILE ist fehlgeschlagen!'</font><br /><!-- br --><b>endif</b>§Die zu schreibende Datei muss existieren. Wenn die Datei nicht existiert, kann auch kein Wert in sie hineingeschrieben werden. Erstellen Sie dann einfach eine neue Datei mit Hilfe von <a href="rb5ref_ger_3_newfiledelfile.html">NEWFILE</a>.<br><!-- br -->[errorcode] erhält den Wert -1, wenn PUTFILE fehlschlug, andernfalls 0.
rb5ref_ger_3_lockworkstation.html§LOCKWORKSTATION§LOCKWORKSTATION§Sperrt eine Windows 2000 oder Windows XP Professional Workstation.<br><!-- br -->Diese Anweisung ist unter Windows 95/98/ME/NT sowie XP Home unwirksam.§<font color="#808080">rem Arbeitsstation sperren?</font><br /><!-- br -->confirm <font color="#000080">[sperren]</font> = <font color="#0000ff">'Computer sperren?'</font><br /><!-- br --><b>if</b> <font color="#000080">[sperren]</font> = <font color="#000080">[true]</font><br /><!-- br --><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem Computer sperren!</font><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;lockworkstation<br /><!-- br --><b>endif</b><br /><!-- br --><b>end</b><!-- br -->§[errorcode] erhält den Wert -1, wenn die Arbeitsstation nicht gesperrt werden konnte (z.B. wenn sie schon gesperrt ist oder das Betriebssystem diese Funktion nicht unterstützt). Wenn keine Fehler auftraten erhält [errorcode] den Wert 0.
rb5ref_ger_3_shutdown.html§SHUTDOWN§SHUTDOWN Modus§Beendet Windows und rebootet oder fährt den PC herunter.<br><!-- br --><br><!-- br -->Als Modus muss einer der folgenden numerischen Werte oder Build-in Konstanten angegeben werden:<br><!-- br --><br><!-- br -->0 (SHUTDOWN) - PC herunterfahren<br><!-- br -->1 (REBOOT) - PC rebooten<br><!-- br -->2 (POWEROFF) - PC herunterfahren und ausschalten (falls dies Hardware-bedingt möglich ist)<br><!-- br -->3 (LOGOFF) - Aktuellen Benutzer ausloggen und Anmeldebildschirm anzeigen§echo <font color="#0000ff">'Restarting computer...'</font><br /><!-- br -->shutdown <font color="#0000ff">'reboot'</font><br /><!-- br --><b>end</b><!-- br -->§[errorcode] erhält im Fehlerfall den Wert -1, ansonsten 0.
rb5ref_ger_3_mci.html§MCI§MCI Befehlsausdruck§Sendet ein Kommando an das Windows Media Control Interface, mit dem sich Mediadaten aller Art abspielen lassen, z.B. MIDI, AVI, WAV, MP3, MPEG, usw.§mci <font color="#0000ff">'open "music.mp3"'</font><br /><!-- br -->mci <font color="#0000ff">'play "music.mp3" wait'</font><br /><!-- br -->mci <font color="#0000ff">'close "music.mp3"'</font><br /><!-- br --><b>end</b><!-- br -->§Weitere Informationen zu MCI-Kommandos finden Sie in der englischsprachigen Hilfedatei MCI.HLP, die sich im \DOC-Verzeichnis Ihrer RapidBATCH-Installation befindet.<br><!-- br -->Die Variable [errorcode] erhält das Ergebnis der API-Funktion mciSendString(), und kann somit auf evtl. Fehler abgefragt werden.
rb5ref_ger_3_mouseevent.html§MOUSEEVENT§MOUSEEVENT Ereignis-Befehl, Positionsangabe§Simuliert Mausaktionen.<br><!-- br --><br><!-- br -->Die Windows-Maus wird dabei von RapidBATCH ferngesteuert, es kann also eine komplette Automatisierung von Mausbewegungen, Klicks und anderen Mausereignissen erfolgen.<br><!-- br --><br><!-- br -->Als Parameter werden ein Event-Kommando sowie die jeweilige X- und Y-Koordinate (in Pixel) als Stringausdruck im Format &quot;X-Position|Y-Position&quot; erwartet (wobei das Pipe-Zeichen das als Standard-Listenseparator definierte Zeichen repräsentiert). Dieses Event-Kommando wird durch eine Zahl oder die jeweilige build-in Konstante repräsentiert, und simuliert Maustastenereignisse.<!-- br --><ul><!-- br -->  <li>'0' oder MOVE (Maus nur bewegen, kein Tastendruck)</li><!-- br -->  <li>'1' oder CLICK_LEFT (einfachen Linksklick simulieren)</li><!-- br -->  <li>'2' oder DBLCLICK_LEFT (doppelten Linksklick simulieren)</li><!-- br -->  <li>'3' oder CLICK_RIGHT (einfachen Rechtsklick simulieren)</li><!-- br -->  <li>'4' oder DBLCLICK_RIGHT (doppelten Rechtsklick simulieren)</li><!-- br -->  <li>'5' oder DOWN_LEFT (Linke Maustaste gedrückt halten)</li><!-- br -->  <li>'6' oder UP_LEFT (Linke Maustaste loslassen)</li><!-- br -->  <li>'7' oder DOWN_RIGHT  (Rechte Maustaste gedrückt halten)</li><!-- br -->  <li>'8' oder UP_RIGHT (Rechte Maustaste loslassen)</li><!-- br --></ul>§infobox <font color="#0000ff">'MouseEvent-Demo'</font>, <font color="#0000ff">'show'</font><br /><!-- br -->wait <font color="#0000ff">'1000'</font><br /><!-- br --><br /><!-- br --><font color="#808080">rem Prozedur zur Anzeige der X/Y-Koordinaten</font><br /><!-- br --><b>proc</b> viewpos<br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;infobox <font color="#0000ff">'X: '</font> # <font color="#000080">[mouse_x]</font> # <font color="#0000ff">' Y: '</font> # <font color="#000080">[mouse_y]</font>, <font color="#0000ff">'show'</font><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;wait <font color="#0000ff">'1'</font><br /><!-- br --><b>endproc</b><br /><!-- br --><br /><!-- br --><font color="#808080">rem Bewege Mauszeiger horizontal</font><br /><!-- br --><font color="#000080">[i]</font> = <font color="#000080">[ScreenWidth]</font><br /><!-- br --><b>repeat</b><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;mouseevent <font color="#0000ff">'move'</font>, <font color="#000080">[i]</font> # <font color="#0000ff">'|1'</font><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;viewpos<br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[i]</font> - <font color="#0000ff">'1'</font><br /><!-- br --><b>until</b> <font color="#000080">[i]</font> = <font color="#0000ff">'0'</font><br /><!-- br --><br /><!-- br --><font color="#808080">rem Bewege Mauszeiger vertikal</font><br /><!-- br --><font color="#000080">[i]</font> = <font color="#0000ff">'0'</font><br /><!-- br --><b>repeat</b><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[i]</font> + <font color="#0000ff">'1'</font><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;mouseevent <font color="#0000ff">'move'</font>, <font color="#0000ff">'1|'</font> # <font color="#000080">[i]</font><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;viewpos<br /><!-- br --><b>until</b> <font color="#000080">[i]</font> = <font color="#000080">[ScreenHeight]</font><br /><!-- br --><br /><!-- br --><font color="#808080">rem Bewege Mauszeiger diagonal</font><br /><!-- br --><font color="#000080">[i]</font> = <font color="#0000ff">'0'</font><br /><!-- br --><b>repeat</b><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[i]</font> + <font color="#0000ff">'1'</font><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;mouseevent <font color="#0000ff">'move'</font>, <font color="#000080">[i]</font> # <font color="#0000ff">'|'</font> # <font color="#000080">[i]</font><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;viewpos<br /><!-- br --><b>until</b> <font color="#000080">[i]</font> = <font color="#000080">[ScreenWidth]</font><br /><!-- br --><b>end</b><!-- br -->§Verwenden Sie die <a href="rb5ref_ger_3_sendkeys.html">SENDKEYS</a>-Anweisung, um Tastenanschläge zu simulieren.<br><br><!-- br --><!-- br -->Alternativ können auch die vordefinierten Variablen [mouse_x] und [mouse_y] dazu verwendet werden, die Mausposition zu verändern.
rb5ref_ger_3_sendkeys.html§SENDKEYS§SENDKEYS Fenstertitel, Fernsteuerungsbefehle§Sendet Tastaturbefehle an das Fenster mit dem jeweiligen Fenstertitel. Diese Anweisung ermöglicht somit das Fernsteuern beliebiger Windows-Programme mit Hilfe einer einfach definierten Makrosprache.<br><!-- br --><br><!-- br -->Im Grunde ist diese Fernsteuerungs-Makrosprache (SENDKEYS-Script) sehr einfach aufgebaut: Man muss die Tastenkombinationen so angeben wie man sie selber drücken würde, da RapidBATCH hier die Eingabe eines Benutzers simuliert, d.h. so tut, als ob der Benutzer das fernzusteuernde Programm bedient.<!-- br --><!-- br --><ul><!-- br -->  <li>Einfache Buchstaben, Zahlen und Satzzeichen (also Wörter oder ganze Texte) werden direkt angegeben, wie z.B. &quot;abc&quot; oder &quot;Hallo Welt!&quot;.</li><!-- br -->  <li>Sondertasten wie STRG, ALT, SHIFT, ENTER, etc. werden geklammert und mit der englischen Bezeichnung angegeben. Wird z.B. das Kommando &quot;Zeile 1(enter)Zeile 2&quot; per SENDKEYS an eine Anwendung gesendet (z.B. einen Texteditor), so wird ein Zeilenumbruch zwischen &quot;Zeile 1&quot; und &quot;Zeile 2&quot; erzeugt.<!-- br -->  <li>Um eine Taste gedrückt zu halten, wird ihr ein Zirkumflexzeichen (^) vorangestellt. Das gedrückthalten von Tasten ist bei Sondertasten, z.B. STRG oder ALT in Verbindung mit anderen Tasten möglich. Um mehrere Tasten gleichzeitig zu drücken, muss das Zirkumflexzeichen vor jedes der gewünschten Zeichen geschrieben werden. Das drücken wird automatisch aufgehoben, wenn ein nicht-gedrücktes Zeichen folgt oder der Tastaturkommando-String endet. Beispiel: &quot;^(alt)f&quot; sendet ein ALT+F, &quot;^(alt)^(strg)^(del)&quot; drückt ALT+STRG+ENTF gleichzeitig, &quot;^(alt)(f1)&quot; sendet ein ALT+F1. &quot;^a&quot; würde ein gedrückthalten der Taste &quot;a&quot; hervorrufen. Beachten Sie bitte, daß alle gedrückten Tasten nach der Abarbeitung der Anweisung SENDKEYS wieder automatisch &quot;losgelassen&quot; werden.</li><!-- br --><li>Möchte man ein Zeichen der Makrosprache wie z.B. eine Klammer auf oder Klammer zu senden, stellt man ihr ein Tilde-Zeichen (~) voran. So z.B. ~( für ein &quot;(&quot;. Mit ~^ wird ein Zirkumflexzeichen selber gesendet. Um ein einzelnes Tilde-Zeichen zu senden muss ein ~~ angegeben werden.</li></ul><!-- br --><!-- br -->Als Sondertasten können folgende Tasten angegeben werden.<!-- br --><!-- br --><ul><!-- br -->	<li><b>(back)</b><br /><!-- br -->	Backspace-Taste</li><!-- br -->	<li><b>(tab)</b><br /><!-- br -->	Tabulator-Taste</li><!-- br -->	<li><b>(clear)</b><br /><!-- br -->	Entfernen-Taste</li><!-- br -->	<li><b>(enter)</b> oder <b>(return)</b><br /><!-- br -->	Enter-Taste</li><!-- br -->	<li><b>(shift)</b><br /><!-- br -->	Umschalt-Taste</li><!-- br -->	<li><b>(ctrl)</b> oder <b>(control)</b><br /><!-- br -->	Strg-Taste</li><!-- br -->	<li><b>(alt)</b><br /><!-- br -->	Alt-Taste</li><!-- br -->	<li><b>(pause)</b><br /><!-- br -->	Pause-Taste</li><!-- br -->	<li><b>(capslock)</b><br /><!-- br -->	Capslock-Taste</li><!-- br -->	<li><b>(esc)</b><br /><!-- br -->	Escape-Taste</li><!-- br -->	<li><b>(space)</b><br /><!-- br -->	Leertaste</li><!-- br -->	<li><b>(pageup)</b><br /><!-- br -->	Bild-hoch Taste</li><!-- br -->	<li><b>(pagedown)</b><br /><!-- br -->	Bild-runter Taste</li><!-- br -->	<li><b>(end)</b><br /><!-- br -->	Zeilenende</li><!-- br -->	<li><b>(home)</b><br /><!-- br -->	Zeilenanfang</li><!-- br -->	<li><b>(left)</b><br /><!-- br -->	Pfeiltaste Links</li><!-- br -->	<li><b>(up)</b><br /><!-- br -->	Pfeiltaste hoch</li><!-- br -->	<li><b>(right)</b><br /><!-- br -->	Pfeiltaste rechts</li><!-- br -->	<li><b>(down)</b><br /><!-- br -->	Pfeiltaste runter</li><!-- br -->	<li><b>(select)</b><br /><!-- br -->	Auswahl-Taste</li><!-- br -->	<li><b>(print)</b><br /><!-- br -->	Druck-Taste</li><!-- br -->	<li><b>(snapshot)</b><br /><!-- br -->	Bildschirm-Schnappschuss</li><!-- br -->	<li><b>(insert)</b><br /><!-- br -->	Einfügen-Taste</li><!-- br -->	<li><b>(delete)</b><br /><!-- br -->	Entfernen-Taste</li><!-- br -->	<li><b>(help)</b><br /><!-- br -->	Hilfe-taste</li><!-- br -->	<li><b>(lwin)</b><br /><!-- br -->	Linke Windows-Taste</li><!-- br -->	<li><b>(rwin)</b><br /><!-- br -->	Rechte Windows-Taste</li><!-- br -->	<li><b>(apps)</b><br /><!-- br -->	Anwendungs-Taste</li><!-- br -->	<li><b>(f1)</b><br /><!-- br -->	F1-Taste</li><!-- br -->	<li><b>(f2)</b><br /><!-- br -->	F2-Taste</li><!-- br -->	<li><b>(f3)</b><br /><!-- br -->	F3-Taste</li><!-- br -->	<li><b>(f4)</b><br /><!-- br -->	F4-Taste</li><!-- br -->	<li><b>(f5)</b><br /><!-- br -->	F5-Taste</li><!-- br -->	<li><b>(f6)</b><br /><!-- br -->	F6-Taste</li><!-- br -->	<li><b>(f7)</b><br /><!-- br -->	F7-Taste</li><!-- br -->	<li><b>(f8)</b><br /><!-- br -->	F8-Taste</li><!-- br -->	<li><b>(f9)</b><br /><!-- br -->	F9-Taste</li><!-- br -->	<li><b>(f10)</b><br /><!-- br -->	F10-Taste</li><!-- br -->	<li><b>(f11)</b><br /><!-- br -->	F11-Taste</li><!-- br -->	<li><b>(f12)</b><br /><!-- br -->	F12-Taste</li><!-- br -->	<li><b>(f13)</b><br /><!-- br -->	F13-Taste</li><!-- br -->	<li><b>(f14)</b><br /><!-- br -->	F14-Taste</li><!-- br -->	<li><b>(f15)</b><br /><!-- br -->	F15-Taste</li><!-- br -->	<li><b>(f16)</b><br /><!-- br -->	F16-Taste</li><!-- br -->	<li><b>(numlock)</b><br /><!-- br -->	NumLock-Taste</li><!-- br -->	<li><b>(scroll)</b><br /><!-- br -->	Scroll-Taste</li><!-- br -->	<li><b>(lshift)</b><br /><!-- br -->	Linke Umschalt-Taste</li><!-- br -->	<li><b>(rshift)</b><br /><!-- br -->	Rechte Umschalt-Taste</li><!-- br -->	<li><b>(lcontrol)</b><br /><!-- br -->	Linke Strg-Taste</li><!-- br -->	<li><b>(rcontrol)</b><br /><!-- br -->	Rechte Strg-Taste</li><!-- br -->	<li><b>(lalt)</b><br /><!-- br -->	Linke Alt-Taste</li><!-- br -->	<li><b>(ralt)</b><br /><!-- br -->	Rechte Alt-Taste</li><!-- br --></ul><!-- br --><!-- br --><br><!-- br -->Als Fenstertitel können auch die Prozess-ID einer Windows-Anwendung oder die build-in Konstanten &quot;DESKTOP&quot; (sendet Tastenanschläge an den Desktop), &quot;SHELL&quot; (sendet Tastenanschläge an die Shell) und &quot;FOREGROUND&quot; (sendet Tastenanschläge an das aktuelle Vordergrundfenster) übergeben werden.§<font color="#808080">rem Notepad starten</font><br /><!-- br -->shell <font color="#000080">[windir]</font> # <font color="#0000ff">'\notepad.exe'</font>, <font color="#0000ff">'show'</font><br /><!-- br --><br /><!-- br --><font color="#808080">rem Tastenkombinationen senden</font><br /><!-- br -->sendkeys <font color="#0000ff">'Unbenannt - Editor'</font>, <font color="#0000ff">'Hello World^(alt)fstest.txt(enter)'</font><br /><!-- br --><b>end</b><!-- br -->§[errorcode] erhält -1, wenn ein Fehler auftrat (z.B. wenn das Fenster nicht gefunden wurde), ansonsten 0.
rb5ref_ger_3_newregkeydelregkey.html§NEWREGKEY, DELREGKEY§NEWREGKEY Hauptschlüssel, Schlüsselpfad<br><!-- br -->DELREGKEY Hauptschlüssel, Schlüsselpfad§NEWREGKEY legt einen neuen Schlüssel in der Registry an.<br><!-- br -->DELREGKEY löscht einen Schlüssel aus der Registry, mitsamt Unterschlüsseln.<br><!-- br --><br><!-- br -->Beide Anweisungen erwarten als Parameter einen Hauptschlüssel, der als einer der folgenden Werte übergeben werden muss:<!-- br --><!-- br --><ul><!-- br -->  <li>'CLASSES_ROOT' für HKEY_CLASSES_ROOT</li><!-- br -->  <li>'CURRENT_CONFIG' für HKEY_CURRENT_CONFIG</li><!-- br -->  <li>'CURRENT_USER' für HKEY_CURRENT_USER</li><!-- br -->  <li>'LOCAL_MACHINE' für HKEY_LOCAL_MACHINE</li><!-- br -->  <li>'USERS' für HKEY_USERS</li><!-- br -->  <li>'DYN_DATA' für HKEY_DYN_DATA</li><!-- br --></ul>§newregkey <font color="#0000ff">'CURRENT_USER'</font>, <font color="#0000ff">'Software\Test'</font><br /><!-- br --><b>if</b> <font color="#000080">[errorcode]</font> = <font color="#0000ff">'0'</font><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Erstellen von HKEY_CURRENT_USER\Software\Test war erfolgreich.'</font><br /><!-- br --><b>endif</b><br /><!-- br --><br /><!-- br -->delregkey <font color="#0000ff">'CURRENT_USER'</font>, <font color="#0000ff">'Software\Test'</font><br /><!-- br --><b>if</b> <font color="#000080">[errorcode]</font> = <font color="#0000ff">'0'</font><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Löschen von HKEY_CURRENT_USER\Software\Test war erfolgreich.'</font><br /><!-- br --><b>endif</b><br /><!-- br --><b>end</b><!-- br -->§Verwenden Sie <a href="rb5ref_ger_3_getregval.html">GETREGVAL</a> und <a href="rb5ref_ger_3_letregval.html">LETREGVAL</a>, um Werte aus der Registry zu lesen oder Werte in die Registry zu schreiben.
rb5ref_ger_3_getfiletimeletfiletime.html§GETFILETIME, LETFILETIME§GETFILETIME Uhrzeit = Dateiname<br><!-- br -->LETFILETIME Dateiname, Uhrzeit§GETFILETIME liest die Änderungszeit einer Datei und gibt diese im Format "hhmmss" zurück.<br><!-- br --><br><!-- br -->LETFILETIME setzt die Änderungszeit einer Datei. Parameter sind der Dateiname und eine Zeit im Format "hhmmss".§newfile <font color="#0000ff">'test.txt'</font><br /><!-- br -->getfiletime <font color="#000080">[t]</font> = <font color="#0000ff">'test.txt'</font><br /><!-- br --><br /><!-- br -->echo <font color="#0000ff">'test.txt wurde geändert um '</font> # <font color="#000080">[t]</font><br /><!-- br --><br /><!-- br --><font color="#808080">rem Nun setzen wir die Uhrzeit auf 14:45:00</font><br /><!-- br -->letfiletime <font color="#0000ff">'test.txt'</font>, <font color="#0000ff">'144500'</font><br /><!-- br --><br /><!-- br -->getfiletime <font color="#000080">[t]</font> = <font color="#0000ff">'test.txt'</font><br /><!-- br -->echo <font color="#0000ff">'test.txt wurde "geändert" um '</font> # <font color="#000080">[t]</font><br /><!-- br -->delfile <font color="#0000ff">'test.txt'</font><br /><!-- br --><b>end</b><!-- br -->§Wurde die Datei nicht gefunden, erhält [errorcode] sowohl von LETFILETIME als auch von GETFILETIME den Wert -1, ansonsten 0. Der Rückgabewert von GETFILETIME ist in solch einem Fall ein Leerstring.<br><!-- br --><br><!-- br -->Verwenden Sie <a href="rb5ref_ger_3_getfiledateletfiledate.html">GETFILEDATE</a> und <a href="rb5ref_ger_3_getfiledateletfiledate.html">LETFILEDATE</a>, um ein Dateidatum zu lesen oder zu setzen.
rb5ref_ger_3_getfiledateletfiledate.html§GETFILEDATE, LETFILEDATE§GETFILEDATE Datum = Dateiname<br><!-- br -->LETFILEDATE Dateiname, Datum§GETFILEDATE liest das Änderungsdatum einer Datei und gibt dieses im Format &quot;mmddyyyy&quot; zurück.<br><!-- br --><br><!-- br -->LETFILEDATE setzt das Änderungsdatum einer Datei. Parameter sind der Dateiname und ein Datum im Format &quot;mmddyyyy&quot;.§newfile <font color="#0000ff">'test.txt'</font><br /><!-- br -->getfiledate <font color="#000080">[d]</font> = <font color="#0000ff">'test.txt'</font><br /><!-- br --><br /><!-- br -->echo <font color="#0000ff">'test.txt wurde geändert am '</font> # <font color="#000080">[d]</font><br /><!-- br --><br /><!-- br --><font color="#808080">rem Nun setzen wir das Datum auf den 01.02.2004</font><br /><!-- br -->letfiledate <font color="#0000ff">'test.txt'</font>, <font color="#0000ff">'02012004'</font><br /><!-- br --><br /><!-- br -->getfiledate <font color="#000080">[d]</font> = <font color="#0000ff">'test.txt'</font><br /><!-- br -->echo <font color="#0000ff">'test.txt wurde "geändert" am '</font> # <font color="#000080">[d]</font><br /><!-- br -->delfile <font color="#0000ff">'test.txt'</font><br /><!-- br --><b>end</b><!-- br -->§Wurde die Datei nicht gefunden, erhält [errorcode] sowohl von LETFILEDATE als auch von GETFILEDATE den Wert -1, ansonsten 0. Der Rückgabewert von GETFILEDATE ist in solch einem Fall ein Leerstring.<br><!-- br --><br><!-- br -->Verwenden Sie <a href="rb5ref_ger_3_getfiletimeletfiletime.html">GETFILETIME</a> und <a href="rb5ref_ger_3_getfiletimeletfiletime.html">LETFILETIME</a> um die Änderungsuhrzeit einer Datei zu lesen oder zu setzen.
rb5ref_ger_3_letregval.html§LETREGVAL§LETREGVAL Datentyp, Hauptschlüssel, Unterschlüssel, Wertbezeichner, Wert§LETREGVAL schreibt einen Wert in die Registry.<br><!-- br --><br><!-- br -->Parameterwerte sind der Datentyp, der Hauptschlüssel, der Unterschlüssel, der Bezeichner des Registry-Wertes und der zu schreibende Wert.<br><!-- br --><br><!-- br -->Existiert der Wert noch nicht in der Registry, so wird er neu erstellt, andernfalls geändert.<br><!-- br --><br><!-- br -->Als Datentyp können die build-in Konstanten &quot;STRING&quot; (Standard), &quot;DWORD&quot; und &quot;BINARY&quot; angeben werden (auch repräsentiert durch die numerischen Werte 0, 1 und 2). <!-- br --><!-- br -->Wird als Datentyp BINARY verwendet, so muss der Parameter <i>Wert</i> wie bei der Anweisung PUTFILE als eine ASCII-Zeichencodeliste übergeben wird, in der jeder zu schreibende Wert durch das Standard-Separationszeichen voneinander getrennt ist.<br><!-- br --><br><!-- br -->Als Hauptschlüssel sind folgende Werte als build-in Konstanten definiert:<br /><!-- br --><!-- br --><ul><!-- br -->  <li>'CLASSES_ROOT' für HKEY_CLASSES_ROOT</li><!-- br -->  <li>'CURRENT_CONFIG' für HKEY_CURRENT_CONFIG</li><!-- br -->  <li>'CURRENT_USER' für HKEY_CURRENT_USER</li><!-- br -->  <li>'LOCAL_MACHINE' für HKEY_LOCAL_MACHINE</li><!-- br -->  <li>'USERS' für HKEY_USERS</li><!-- br -->  <li>'DYN_DATA' für HKEY_DYN_DATA</li><!-- br --></ul><!-- br --><!-- br -->Der Unterschlüssel gibt den Pfad des Unterschlüssels, jeweils getrennt durch Backslash (\), an.<br><!-- br -->Als Wertbezeichner wird ein frei definierbarer Bezeichner für den Wert definiert, über den der Wert später wieder ausgelesen werden kann.<br><!-- br -->Der letzte Parameter beinhaltet dann den Wert, der unter der Bezeichnung des Wertbezeichners in die Registry geschrieben wird, im als Datentyp entsprechend angegebenem Format.§letregval <font color="#0000ff">'STRING'</font>, <font color="#0000ff">'CURRENT_USER'</font>, <font color="#0000ff">'Software\jmksf\RapidBATCH'</font>, <font color="#0000ff">'HelloWorld'</font>, <font color="#0000ff">'Hello World by RapidBATCH ;)'</font><br /><!-- br --><br /><!-- br --><b>if</b> <font color="#000080">[errorcode]</font> = <font color="#0000ff">'0'</font><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Wert wurde erfolgreich geschrieben!'</font><br /><!-- br --><b>else</b><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Fehler beim Schreiben.'</font><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;<b>halt</b><br /><!-- br --><b>endif</b><br /><!-- br --><br /><!-- br --><font color="#808080">rem Schreiben von Binär 85 / Hexadezimal 55</font><br /><!-- br -->getchr <font color="#000080">[bin]</font> = <font color="#0000ff">'85'</font><br /><!-- br -->letregval <font color="#0000ff">'BINARY'</font>, <font color="#0000ff">'CURRENT_USER'</font>, <font color="#0000ff">'Software\jmksf\RapidBATCH'</font>, <font color="#0000ff">'bin85'</font>, <font color="#000080">[bin]</font><br /><!-- br --><br /><!-- br --><b>if</b> <font color="#000080">[errorcode]</font> = <font color="#0000ff">'0'</font><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Wert wurde erfolgreich geschrieben!'</font><br /><!-- br --><b>else</b><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Fehler beim Schreiben.'</font><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;<b>halt</b><br /><!-- br --><b>endif</b><br /><!-- br --><br /><!-- br --><font color="#808080">rem Aufäumen...</font><br /><!-- br -->delregval <font color="#0000ff">'CURRENT_USER'</font>, <font color="#0000ff">'Software\jmksf\RapidBATCH'</font>, <font color="#0000ff">'HelloWorld'</font><br /><!-- br --><b>if</b> <font color="#000080">[errorcode]</font> = <font color="#0000ff">'-1'</font> echo <font color="#0000ff">'Fehler beim Löschen von Registry-Wert'</font><br /><!-- br -->delregval <font color="#0000ff">'CURRENT_USER'</font>, <font color="#0000ff">'Software\jmksf\RapidBATCH'</font>, <font color="#0000ff">'bin85'</font><br /><!-- br --><b>if</b> <font color="#000080">[errorcode]</font> = <font color="#0000ff">'-1'</font> echo <font color="#0000ff">'Fehler beim Löschen von Registry-Wert'</font><br /><!-- br --><br /><!-- br --><b>end</b><!-- br -->§Wenn LETREGVAL fehlschlug, wird an [errorcode] der Wert -1, ansonsten 0 übergeben.<br><!-- br -->Verwenden Sie <a href="rb5ref_ger_3_getregval.html">GETREGVAL</a> und <a href="rb5ref_ger_3_delregval.html">DELREGVAL</a>, um Registry-Werte zu lesen oder zu löschen.
rb5ref_ger_3_getregval.html§GETREGVAL§GETREGVAL Wert = Datentyp, Hauptschlüssel, Unterschlüssel, Wertbezeichner§GETREGVAL liest einen Wert aus der Registry. Parameterwerte sind der Datentyp des zu lesenden Registry-Wertes, welcher durch die Konstanten &quot;STRING&quot; (Standard), &quot;DWORD&quot; und &quot;BINARY&quot; definiert wird (auch repräsentiert durch die numerischen Werte 0, 1 und 2)),der Hauptschlüssel, ein Unterschlüssel und der Bezeichner des Registry-Wertes, dessen Wert ausgelesen werden soll.<br><!-- br --><br /><!-- br -->Als Hauptschlüssel sind folgende Werte als build-in Konstanten definiert:<br /><!-- br --><!-- br --><ul><!-- br -->  <li>'CLASSES_ROOT' für HKEY_CLASSES_ROOT</li><!-- br -->  <li>'CURRENT_CONFIG' für HKEY_CURRENT_CONFIG</li><!-- br -->  <li>'CURRENT_USER' für HKEY_CURRENT_USER</li><!-- br -->  <li>'LOCAL_MACHINE' für HKEY_LOCAL_MACHINE</li><!-- br -->  <li>'USERS' für HKEY_USERS</li><!-- br -->  <li>'DYN_DATA' für HKEY_DYN_DATA</li><!-- br --></ul><!-- br --><!-- br -->Der Unterschlüssel gibt den Pfad des Unterschlüssels, jeweils getrennt durch Backslash (\), an.<br><br><!-- br -->Als Wertbezeichner wird der in der Registry definierte Bezeichner angegeben.<br><!-- br -->Rückgabewert ist der gelesene Wert im entsprechenden Datentypsformat. Binary-Werte werden durch eine mit dem Standard-Separator separierten Liste an ASCII-Zeichencodes zurückgegeben, wie dies bei der Funktion GETFILE der Fall ist.§<font color="#808080">rem Wert in Registry schreiben</font><br /><!-- br -->letregval <font color="#0000ff">'STRING'</font>, <font color="#0000ff">'CURRENT_USER'</font>, <font color="#0000ff">'Software\jmksf\RapidBATCH'</font>, <font color="#0000ff">'HelloWorld'</font>, <font color="#0000ff">'Hello World by RapidBATCH ;)'</font><br /><!-- br --><br /><!-- br --><b>if</b> <font color="#000080">[errorcode]</font> = <font color="#0000ff">'0'</font><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Wert wurde erfolgreich geschrieben!'</font><br /><!-- br --><b>else</b><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Fehler beim Schreiben.'</font><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;<b>halt</b><br /><!-- br --><b>endif</b><br /><!-- br --><br /><!-- br --><font color="#808080">rem Wert wieder auslesen</font><br /><!-- br -->getregval <font color="#000080">[wert]</font> = <font color="#0000ff">'STRING'</font>, <font color="#0000ff">'CURRENT_USER'</font>, <font color="#0000ff">'Software\jmksf\RapidBATCH'</font>, <font color="#0000ff">'HelloWorld'</font><br /><!-- br --><b>if</b> <font color="#000080">[errorcode]</font> = <font color="#0000ff">'0'</font><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Gelesener Wert: '</font> # <font color="#000080">[wert]</font><br /><!-- br --><b>else</b><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Fehler beim Lesen des Wertes.'</font><br /><!-- br --><b>endif</b><br /><!-- br --><br /><!-- br --><font color="#808080">rem Aufäumen...</font><br /><!-- br -->delregval <font color="#0000ff">'CURRENT_USER'</font>, <font color="#0000ff">'Software\jmksf\RapidBATCH'</font>, <font color="#0000ff">'HelloWorld'</font><br /><!-- br --><b>if</b> <font color="#000080">[errorcode]</font> = <font color="#0000ff">'-1'</font> echo <font color="#0000ff">'Fehler beim Löschen von Registry-Wert'</font><br /><!-- br --><b>end</b><!-- br -->§Schlägt GETREGVAL fehl, weil z.B. der zu lesende Wert nicht existiert, so erhält [errorcode] den Wert '-1' und gibt einen Leerstring zurück. Ansonsten erhält [errorcode] den Wert '0'.<br><!-- br --><br><!-- br -->Verwenden Sie <a href="rb5ref_ger_3_letregval.html">LETREGVAL</a> und <a href="rb5ref_ger_3_delregval.html">DELREGVAL</a>, um Registry-Werte zu schreiben oder zu löschen.
rb5ref_ger_3_delregval.html§DELREGVAL§DELREGVAL Hauptschlüssel, Unterschlüssel, Bezeichner§Löscht einen Registry-Wert.<br><!-- br -->DELREGVAL erwartet als Parameter einen Hauptschlüssel, einen Unterschlüssel sowie den Bezeichner des Wertes in der Registry, der gelöscht werden soll.<br><!-- br --><br><!-- br -->Als Hauptschlüssel sind folgende Werte als build-in Konstanten definiert:<br /><!-- br --><!-- br --><ul><!-- br -->  <li>'CLASSES_ROOT' für HKEY_CLASSES_ROOT</li><!-- br -->  <li>'CURRENT_CONFIG' für HKEY_CURRENT_CONFIG</li><!-- br -->  <li>'CURRENT_USER' für HKEY_CURRENT_USER</li><!-- br -->  <li>'LOCAL_MACHINE' für HKEY_LOCAL_MACHINE</li><!-- br -->  <li>'USERS' für HKEY_USERS</li><!-- br -->  <li>'DYN_DATA' für HKEY_DYN_DATA</li><!-- br --></ul><!-- br --><!-- br -->Der Unterschlüssel gibt den Pfad des Unterschlüssels, jeweils getrennt durch Backslash (\), an.<br><!-- br -->Als Wertbezeichner wird der in der Registry definierte Bezeichner angegeben, der gelöscht werden soll.§<font color="#808080">rem Testwert schreiben</font><br /><!-- br -->letregval <font color="#0000ff">'STRING'</font>, <font color="#0000ff">'CURRENT_USER'</font>, <font color="#0000ff">'Software\jmksf\RapidBATCH'</font>, <font color="#0000ff">'HelloWorld'</font>, <font color="#0000ff">'Hello World by RapidBATCH ;)'</font><br /><!-- br --><br /><!-- br --><b>if</b> <font color="#000080">[errorcode]</font> = <font color="#0000ff">'0'</font><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Wert wurde erfolgreich geschrieben!'</font><br /><!-- br --><b>else</b><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Fehler beim Schreiben.'</font><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;<b>halt</b><br /><!-- br --><b>endif</b><br /><!-- br --><br /><!-- br --><font color="#808080">rem Testwert wieder entfernen</font><br /><!-- br -->delregval <font color="#0000ff">'CURRENT_USER'</font>, <font color="#0000ff">'Software\jmksf\RapidBATCH'</font>, <font color="#0000ff">'HelloWorld'</font><br /><!-- br --><b>if</b> <font color="#000080">[errorcode]</font> = <font color="#0000ff">'-1'</font> echo <font color="#0000ff">'Fehler beim Löschen von Registry-Wert'</font><br /><!-- br --><b>end</b><!-- br -->§Wenn das Löschen des Wertes fehlschlug, erhält [errorcode] den Wert -1, ansonsten 0.<br><!-- br --><br><!-- br -->Verwenden Sie LETREGVAL und GETREGVAL, um Registry-Werte zu lesen bzw. zu schreiben.
rb5ref_ger_3_shortcut.html§SHORTCUT§SHORTCUT Verknüpfungsdatei, Verknüpfungspfad, Parameter, Arbeitsverzeichnis, Icon, Anzeigemodus§Erstellt eine Verknüpung.<br><br><!-- br --><!-- br -->Die Verknüpung wird unter dem als <i>Verknüpungsdatei</i> angegebenen Pfad gespeichert, wobei die Dateiendung .LNK automatisch angehängt wird. <i>Programmpfad</i> gibt den Pfad zu einer Datei, auf die die Verknüpung zeigen soll, an. <i>Parameter</i> definiert optionale Kommandozeilenparameter, <i>Arbeitsverzeichnis</i> ein optionales Arbeitsverzeichnis, <i>Icon</i> einen optionalen Icon-Pfad. Der Anzeigemodus kann 'SHOW', 'MINIMIZED' oder 'MAXIMIZED' sein. 'HIDE' ist bei Verknüpfungen als Anzeigemodus-Wert nicht möglich.§<font color="#000080">[userdir]</font> = <font color="#0000ff">'C:\Dokumente und Einstellungen\'</font> # <font color="#000080">[curuser]</font> # <font color="#0000ff">'\Desktop'</font><br /><!-- br --><font color="#000080">[prog]</font> =  <font color="#0000ff">'C:\jmksf\rb5\rbb4.exe'</font><br /><!-- br --><br /><!-- br -->shortcut <font color="#000080">[userdir]</font> # <font color="#0000ff">'\RapidBATCH Schortcut'</font>, <font color="#000080">[prog]</font>, <font color="#0000ff">''</font>, <font color="#0000ff">''</font>, <font color="#0000ff">''</font>, <font color="#0000ff">'show'</font><br /><!-- br --><br /><!-- br --><b>if</b> <font color="#000080">[errorcode]</font> = <font color="#000080">[true]</font><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Verknüpfung wurde erfolgreich erstellt!'</font><br /><!-- br --><b>else</b><br /><!-- br -->&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Fehler beim Erstellen der Verknüpfung.'</font><br /><!-- br --><b>endif</b>§[errorcode] erhält den Wert 0, wenn kein Fehler auftrat, ansonsten -1.
