<html>
	<head>
		<title>Programme starten</title>
		<link rel="stylesheet" href="jmksf.css" type="text/css"></link>
	</head>

	<body>
		<div id="top">
			<img src="rb5.png" alt="RapidBATCH Logo" />
			Programme starten
		</div>
		
		<div class="line">&nbsp;</div>
		
		Oftmals ist es gerade in der Batch-Programmierung notwendig, externe Programme zu starten, um bestimmte Vorgehensweisen und Methoden, die zu einem Ergebnis f&uuml;hren, zu automatisieren.<br /><br />Um Programme zu starten, bietet Ihnen RapidBATCH gleich vier verschiedene M&ouml;glichkeiten an. Klassische Methode zum Starten einer Anwendung ist die SHELL-Anweisung. Sie f&uuml;hrt ein Programm parallel zum RapidBATCH-Script aus, d.h. das Script selbst l&auml;uft parallel zum gestarteten Programm weiter. SHELL erwartet als Parameter den Pfad des zu startenden Programms (der auch Kommandozeilen-Parameter beinhalten kann) sowie einen so genannten Anzeigemodus (Show-Mode), der angibt, wie das Programm gestartet werden soll.<br />Der Anzeigemodus ist nur f&uuml;r einige Windows-Programme interessant, nicht alle Programme unterst&uuml;tzen diese M&ouml;glichkeit. Als Anzeigemodi k&ouml;nnen hier die Were 'SHOW', 'HIDE', 'MINIMIZED' oder 'MAXIMIZED' angegeben werden; 'SHOW' startet ein Programm mit der normalen Fenstergr&ouml;ße, 'HIDE' startet es versteckt, d.h. nicht sichtbar, womit die 'HIDE'-Option f&uuml;r Konsolenprogramme und Batch-Jobs sehr interessant ist, da diese somit unsichtbar im Hintergrund und ohne ein DOS-Fenster ausgef&uuml;hrt werden k&ouml;nnen. Die Modi 'MINIMIZED' und 'MAXIMIZED' starten das Programm mit einem minimierten bzw. maximierten Programmfenster. Diese beiden Werte sind jedoch - wie bereits angesprochen - nur bei bestimmten Programmen anwendbar.<br /><br />Folgendes Script starten den Editor &quot;Notepad&quot; von Windows:<br /><br /><!-- code BEGIN --><div class="code">shell <font color="#0000ff">'notepad.exe'</font>, <font color="#0000ff">'show'</font><br />echo <font color="#0000ff">'Und jetzt starten wir Notepad maximiert...'</font><br />shell <font color="#0000ff">'notepad.exe'</font>, <font color="#0000ff">'maximized'</font><br />echo <font color="#0000ff">'Ende!'</font><br /><b>end</b></div><!-- code END-->Neben der SHELL-Anweisung bietet RapidBATCH auch die CALL-Anweisung. CALL ist von den Parametern her identisch zu SHELL, hat aber die Eigenschaft, dass das RapidBATCH-Script, welches die Anwendung mit CALL aufgerufen hat, solange mit der Programmausf&uuml;hrung wartet, bis das gestartete Programm abgearbeitet oder vom Benutzer beendet wurde.<br /><br />Hier einmal unser Beispiel von oben, welches aber mit CALL arbeitet:<br /><br /><!-- code BEGIN --><div class="code">call <font color="#0000ff">'notepad.exe'</font>, <font color="#0000ff">'show'</font><br />echo <font color="#0000ff">'Und jetzt starten wir Notepad maximiert...'</font><br />call <font color="#0000ff">'notepad.exe'</font>, <font color="#0000ff">'maximized'</font><br />echo <font color="#0000ff">'Ende!'</font><br /><b>end</b></div><!-- code END-->Oftmals ist auch die Verwendung von MS-DOS-Konsolenkommandos einfach unabdingbar. Zur schnellen Ausf&uuml;hrung eines Konsolenkommandos bietet RapidBATCH die SYSTEM-Anweisung. Als Parameter wird das entsprechene Kommando erwartet.<br /><br />Beispiel:<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem Ping an www.jmksf.de schicken</font><br />system <font color="#0000ff">'ping www.jmksf.de'</font><br /><b>end</b></div><!-- code END-->Mit CALL bzw. SHELL lassen sich DOS-Kommandos auch versteckt ausf&uuml;hren (dieses Beispiel verwendet die Funktion READFILE zum Auslesen der Datei, die wir sp&auml;ter detaillierter besprechen werden):<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem dir-Kommando senden und in Datei test.txt umleiten</font><br />call <font color="#0000ff">'cmd.exe /C dir *.exe &gt;test.txt'</font>, <font color="#0000ff">'hide'</font><br /><br /><font color="#808080">rem test.txt einlesen und ausgeben</font><br />readfile <font color="#000080">[dir_ausgabe]</font> = <font color="#0000ff">'test.txt'</font>, <font color="#0000ff">'0'</font><br />echo <font color="#000080">[dir_ausgabe]</font><br /><br /><font color="#808080">rem test.txt wieder l&ouml;schen</font><br />delfile <font color="#0000ff">'test.txt'</font><br /><b>end</b></div><!-- code END--><div class="image"><img src="img/sysop_call_dir.gif" alt="Ausgabe eines DIR-Befehls in einer Messagebox" title="Ausgabe des DIR-Befehls" /><br />Die Ausgabe des DIR-Befehls, umgeleitet und ausgelesen aus einer Datei</div><div class="remark">Anmerkung: Unter Windows 95, 98 und ME m&uuml;ssen Sie bei dem oben gezeigten Beispiel anstatt CMD.EXE das Programm COMMAND.COM aufrufen.</div><br />Zur letzten M&ouml;glichkeit, externe Programme zu starten, geh&ouml;rt die OPEN-Anweisung. OPEN kann vielseitig eingesetzt werden, beispielsweise kann hier auch anstatt eines Programmpfades der Name einer Datei (die dann mit dem entsprechend verkn&uuml;pften Programm ge&ouml;ffnet wird) oder eine Internet-URL, die dann im Standard-Browser geladen wird, angegeben werden.<br /><br />Beispiele:<br /><br /><!-- code BEGIN --><div class="code">open <font color="#0000ff">'calc.exe'</font><br />open <font color="#0000ff">'C:\jmksf\rb5\license.txt'</font><br />open <font color="#0000ff">'http://www.rapidbatch.com'</font><br /><b>end</b></div><!-- code END-->Wenn OPEN zum Starten von Programmen benutzt wird, entspricht dies einem Aufruf von SHELL mit dem Anzeigemodus 'SHOW'.<br /><br />

		<div class="line">&nbsp;</div>

		<div id="copyright">
			Copyright &copy; 2000-2006 by J.M.K S.F. Software Technologies, Jan Max Meyer<br />
			All rights reserved.
		</div>
	</body>
</html>
