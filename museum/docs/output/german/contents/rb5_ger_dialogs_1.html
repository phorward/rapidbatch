<html>
	<head>
		<title>Meldungen und Statusausgaben</title>
		<link rel="stylesheet" href="jmksf.css" type="text/css"></link>
	</head>

	<body>
		<div id="top">
			<img src="rb5.png" alt="RapidBATCH Logo" />
			Meldungen und Statusausgaben
		</div>
		
		<div class="line">&nbsp;</div>
		
		RapidBATCH ist mit einer Vielzahl von build-in Dialogen ausgestattet, die individuell angepasst und optimal in Ihren Scripts eingesetzt werden k&ouml;nnen. Bevor Sie anfangen, selber komplett eigene Dialoge in RapidBATCH zu kreieren (was auch m&ouml;glich ist) sollten Sie erst einmal schauen, ob bereits die RapidBATCH build-in Dialoge f&uuml;r Ihren Anwendungsfall ausreichen. Der Vorteil bei den build-in Dialogen von RapidBATCH besteht n&auml;mlich darin, dass Sie nur eine einzige Anweisung oder Funktion aufrufen m&uuml;ssen, um den kompletten Dialog zu starten. Bei selbst programmierten Dialogfenstern, wozu wir in einem sp&auml;teren Kapitel kommen werden, m&uuml;ssen Sie f&uuml;r jedes Ereignis mit oder auf dem Dialog eine entsprechende Routine programmieren, was dann wiederum mehr Aufwand erfordert. Dieses Kapitel stellt nun die von RapidBATCH bereitgestellten build-in Dialoge vor und zeigt auf, wie diese angewendet und angepasst werden k&ouml;nnen.<br /><br />Meldungsfenster, so genannte Messageboxes, bieten die einfachste Art, dem Benutzer Meldungen oder Daten zu pr&auml;sentieren oder auch um einfache Abfragen bereitzustellen. Bereits kennengelernt haben Sie die ECHO-Anweisung, mit der Sie ein Meldungsfenster mit dem &uuml;bergebenen Wert auf dem Bildschirm ausgeben lassen k&ouml;nnen. ECHO dient zur einfachsten Ausgabe einer Information, daher wird sie auch oft in unseren Beispielen benutzt.<div class="image"><img src="img/echo.gif" alt="Bild eines ECHO-Dialogs" title="ECHO-Dialog" /><br />Einfache Ausgabe von Informationen und Meldungen mit dem ECHO-Dialog</div>&Auml;hnlichen Zweck erf&uuml;llt auch die CONFIRM-Funktion, die einen Benutzerdialog mit Ja-Nein-Option anzeigt. CONFIRM erwartet als Parameter eine R&uuml;ckgabe-Variable (die Auskunft &uuml;ber den gedr&uuml;ckten Button gibt) und einen Aufforderungstext bzw. eine Frage, die mit &quot;Ja&quot; oder &quot;Nein&quot; beantwortet werden kann. Wenn der Button &quot;Ja&quot; geklickt wurde, wird der Wert '0' an die R&uuml;ckgabe-Variable zur&uuml;ckgegeben, bei &quot;Nein&quot; der Wert '-1'.<div class="image"><img src="img/confirm.gif" alt="Bild eines CONFIRM-Dialogs" title="CONFIRM-Dialog" /><br />Ja-Nein-Auswahl mit dem CONFIRM-Dialog</div>Ein Beispiel zur Verwendung von CONFIRM ist folgendes Script:<br /><br /><!-- code BEGIN --><div class="code">%start<br /><font color="#808080">rem Abfrage: Script beenden?</font><br />confirm <font color="#000080">[ende]</font> = <font color="#0000ff">'M&ouml;chten Sie das Script beenden?'</font><br /><br /><font color="#808080">rem Wenn "Nein" gedr&uuml;ckt wurde, springe zum Anfang</font><br /><b>if</b> <font color="#000080">[ende]</font> = <font color="#0000ff">'-1'</font> <b>goto</b> start<br />echo <font color="#0000ff">'Script beendet.'</font><br /><b>end</b></div><!-- code END-->ECHO und CONFIRM bieten somit eine einfache M&ouml;glichkeit, schnell einen Wert zu pr&auml;sentieren oder eine einfache Ja-Nein-Abfrage zu gestalten.<br /><br />Um aber eine Messagebox individueller zu gestalten, bietet Ihnen RapidBATCH die MSGBOX-Anweisung. MSGBOX ben&ouml;tigt als Parameter einen Titel, einen Meldungstext sowie einen Messagebox-Style, der als Zahl definiert wird.<br />Eine ganz einfache Messagebox w&auml;re hier:<br /><br /><!-- code BEGIN --><div class="code">msgbox <font color="#0000ff">'Meldung'</font>, <font color="#0000ff">'Hello World'</font>, <font color="#0000ff">'0'</font></div><!-- code END-->Welcher der angezeigten Buttons gedr&uuml;ckt wurde, wird in die vordeklarierte Variable [errorcode] gespeichert (im obigen Beispiel immer 0, weil ja nur ein Button zur Auswahl steht). [errorcode] ist eine Variable, die von vielen Anweisungen in RapidBATCH verschiedene Status- oder Fehlercodes erh&auml;lt. Eben hier, welcher Button gedr&uuml;ckt wurde.<div class="remark">Anmerkung: Die MSGBOX-Anweisung kann auch als Funktion aufgerufen werden! Der Wert, der dann an [errorcode] &uuml;bergeben wird, wird stattdessen bei dieser Methode in die entsprechende R&uuml;ckgabe-Variable gespeichert. MSGBOX sollte daher vermehrt als Funktion eingesetzt werden, kann aber nat&uuml;rlich auch weiterhin als Anweisung, wie hier beschrieben, aufgerufen werden.</div>Ein Messagebox-Style setzt sich aus einem so genannten Button-Wert und einem Icon-Wert zusammen. Zudem l&auml;sst sich auch die Position des Eingabefokus (welcher Button gedr&uuml;ckt wird, wenn der Benutzer nur die Entertaste bet&auml;tigt) mit diesem Wert bestimmen.<br /><br />M&ouml;gliche Button-Styles f&uuml;r Messageboxes sind:<br /><br /><!-- MESSAGEBOX-BUTTON-STYLES ------------------------------------------------------------------><table class="std" style="margin-left: 20px;" cellspacing="10"><tr>  <td style="padding-right: 10px;"><b>Style-ID:</b></td>  <td><b>Beispiel:</b></td>  <td><b>Button-Style (jew. R&uuml;ckgabewert an [errorcode] in Klammern):</b></td></tr><tr>  <td>0</td><td style="padding-right: 10px;"><img src="img/msgbox_style0.gif" alt="Screenshot MSGBOX-Style 0" /></td><td>OK (1)</td></tr><tr>  <td>1</td><td style="padding-right: 10px;"><img src="img/msgbox_style1.gif" alt="Screenshot MSGBOX-Style 0" /></td><td>OK (1) + CANCEL (2)</td></tr><tr>  <td>2</td><td style="padding-right: 10px;"><img src="img/msgbox_style2.gif" alt="Screenshot MSGBOX-Style 0" /></td><td>CANCEL (3) + RETRY (4) + IGNORE (5)</td></tr><tr>  <td>3</td><td style="padding-right: 10px;"><img src="img/msgbox_style3.gif" alt="Screenshot MSGBOX-Style 0" /></td><td>YES (6) + NO (7) + CANCEL (2)</td></tr><tr>  <td>4</td><td style="padding-right: 10px;"><img src="img/msgbox_style4.gif" alt="Screenshot MSGBOX-Style 0" /></td><td>YES (6) + NO (7)</td></tr><tr>  <td>5</td><td style="padding-right: 10px;"><img src="img/msgbox_style5.gif" alt="Screenshot MSGBOX-Style 0" /></td><td>RETRY (4) + CANCEL (2)</td></tr></table><!-- END MESSAGEBOX-BUTTON-STYLES --------------------------------------------------------------><br /><br />Rechnet man zum gew&uuml;nschten Button-Style noch einen der folgenden Werte hinzu, so kann man auch eines der vier Standard-Icons bestimmten.<br /><br /><!-- MESSAGEBOX-ICON-STYLES ------------------------------------------------------------------><table class="std" style="margin-left: 20px;" cellspacing="10"><tr>  <td style="padding-right: 10px;"><b>Icon-Style:</b></td>  <td><b>Beispiel:</b></td></tr><tr>  <td>0</td><td style="padding-right: 10px;"><img src="img/msgbox_icon0.gif" alt="Screenshot ohne Icon-Style" /></td></tr><tr>  <td>16</td><td style="padding-right: 10px;"><img src="img/msgbox_icon16.gif" alt="Screenshot MSGBOX-Icon-Style 16" /></td></tr><tr>  <td>32</td><td style="padding-right: 10px;"><img src="img/msgbox_icon32.gif" alt="Screenshot MSGBOX-Icon-Style 32" /></td></tr><tr>  <td>48</td><td style="padding-right: 10px;"><img src="img/msgbox_icon48.gif" alt="Screenshot MSGBOX-Icon-Style 48" /></td></tr><tr>  <td>64</td><td style="padding-right: 10px;"><img src="img/msgbox_icon64.gif" alt="Screenshot MSGBOX-Icon-Style 64" /></td></tr></table><!-- END MESSAGEBOX-BUTTON-STYLES --------------------------------------------------------------><br /><br />Ein Beispiel w&auml;re hier <br /><br /><!-- code BEGIN --><div class="code">%start<br />msgbox <font color="#0000ff">'Eine Frage!'</font>, <font color="#0000ff">'Klicken Sie einen der Buttons!'</font>, <font color="#0000ff">'48'</font> + <font color="#0000ff">'4'</font><br /><br /><b>if</b> <font color="#000080">[errorcode]</font> = <font color="#0000ff">'6'</font><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem Fall: Ja</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Sie haben "Ja" angeklickt'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>goto</b> start<br /><b>elseif</b> <font color="#000080">[errorcode]</font> = <font color="#0000ff">'7'</font><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem Fall: Nein</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Sie haben "Nein" angeklickt'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>goto</b> start<br /><b>else</b><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem Fall: Abbruch</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Und tsch&uuml;ss...'</font><br /><b>endif</b><br /><b>end</b></div><!-- code END-->Wenn man zum Style noch den Wert 0 (f&uuml;r den ersten), 256 (f&uuml;r den zweiten) oder 512 (f&uuml;r den dritten) hinzurechnet, kann man den Eingabefokus auch direkt auf einen der Buttons setzen. Welcher Button den Focus hat sieht man an dem kleinen, getrichelten Kasten um den Button herum. Hat ein Button den Focus, so wird dieser Button ausgel&ouml;st, wenn der Benutzer einfach die Eingabetaste bet&auml;tigt.<br /><br />Beispiel:<br /><br /><!-- code BEGIN --><div class="code">msgbox <font color="#0000ff">'Test1'</font>, <font color="#0000ff">'Fokus 1'</font>, <font color="#0000ff">'64'</font> + <font color="#0000ff">'3'</font> + <font color="#0000ff">'0'</font><br />msgbox <font color="#0000ff">'Test2'</font>, <font color="#0000ff">'Fokus 2'</font>, <font color="#0000ff">'64'</font> + <font color="#0000ff">'3'</font> + <font color="#0000ff">'256'</font><br />msgbox <font color="#0000ff">'Test3'</font>, <font color="#0000ff">'Fokus 3'</font>, <font color="#0000ff">'64'</font> + <font color="#0000ff">'3'</font> + <font color="#0000ff">'512'</font><br /><b>end</b></div><!-- code END-->Neben den bis jetzt besprochenen Messageboxes bietet RapidBATCH aber auch eine andere Form der Meldungs- und Status&uuml;bermittlung: Die INFOBOX!<br />Manchmal ist es n&ouml;tig, z.B. bei l&auml;nger andauernden Operationen, eine Meldung in der Form &quot;Bitte warten...&quot; einzublenden. Die INFOBOX kann vom Programmierer daher v&ouml;llig frei ein- oder ausgeblendet werden und besitzt weder einen &quot;Ok&quot;-Button noch kann sie verschoben oder in den Hintergrund gebracht werden.<div class="image"><img src="img/infobox.gif" alt="Bild eines INFOBOX-Dialogs" title="INFOBOX-Dialog" /><br />Einblendung des INFOBOX-Dialoges</div>Ein einfaches Beispiel f&uuml;r die Verwendung der INFOBOX ist folgendes Script, das eine INFOBOX mit dem Text &quot;Hello World&quot; f&uuml;r 5 Sekunden einblendet. Zum Abwarten der 5 Sekunden wird hier das Script mit Hilfe der WAIT-Anweisung f&uuml;r 5000 Millisekunden (= 5 Sekunden) angehalten.<br /><br /><!-- code BEGIN --><div class="code">infobox <font color="#0000ff">'Hello World'</font>, <font color="#0000ff">'show'</font><br />wait <font color="#0000ff">'5000'</font><br /><b>end</b></div><!-- code END-->In unserem Fall wird die INFOBOX automatisch wieder ausgeblendet, weil das Script beendet ist. Um die INFOBOX manuell auszublenden, benutzen Sie INFOBOX noch einmal in der Form<br /><br /><!-- code BEGIN --><div class="code">infobox <font color="#0000ff">''</font>, <font color="#0000ff">'hide'</font></div><!-- code END-->oder verwenden sie die professionellere Methode, indem Sie die vordeklarierte Variable [InfoBox_Enabled] auf den Wert 'hide' oder '-1' setzen (durch setzen auf 'show' oder '0' wird INFOBOX wieder angezeigt).<br /><br />Beispiel:<br /><br /><!-- code BEGIN --><div class="code">echo <font color="#0000ff">'INFOBOX wird jetzt eingeblendet...'</font><br />infobox <font color="#0000ff">'Hello World'</font>, <font color="#0000ff">'show'</font><br />wait <font color="#0000ff">'2000'</font><br />echo <font color="#0000ff">'INFOBOX wird jetzt ausgeblendet...'</font><br /><font color="#000080">[InfoBox_Enabled]</font> = <font color="#0000ff">'hide'</font><br />echo <font color="#0000ff">'INFOBOX ist jetzt ausgeblendet!'</font><br /><b>end</b></div><!-- code END-->Da INFOBOX ein komplett eigener Dialog von RapidBATCH ist (Messageboxes werden von Windows selber bereitgestellt), l&auml;sst er sich auch individualisieren, z.B. kann die H&ouml;he und Breite des Dialogs mit Hilfe der vordeklarierten Variablen [InfoBox_Height] und [InfoBox_Width] vom Programmierer beeinflusst werden. Die Angabe der Gr&ouml;ße erfolgt in Pixeln, die Zentrierung des Dialogs auf dem Bildschirm findet automatisch statt, kann aber auch durch das Setzen der Variablen [InfoBox_X] und [InfoBox_Y] auf eine beliebige Position des Bildschirms erfolgen. Wird [InfoBox_X] und/oder [InfoBox_Y] auf den Wert '0' gesetzt, erfolgt eine automatische Zentrierung des Dialogs auf der jeweiligen Achse (was der Standard-Einstellung entspricht).<br /><br />

		<div class="line">&nbsp;</div>

		<div id="copyright">
			Copyright &copy; 2000-2006 by J.M.K S.F. Software Technologies, Jan Max Meyer<br />
			All rights reserved.
		</div>
	</body>
</html>
