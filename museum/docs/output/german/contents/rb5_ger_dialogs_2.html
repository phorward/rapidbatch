<html>
	<head>
		<title>Abfragen von Werten</title>
		<link rel="stylesheet" href="jmksf.css" type="text/css"></link>
	</head>

	<body>
		<div id="top">
			<img src="rb5.png" alt="RapidBATCH Logo" />
			Abfragen von Werten
		</div>
		
		<div class="line">&nbsp;</div>
		
		Um Werte vom Benutzer abzufragen, stellt RapidBATCH gleich drei verschiedene, leistungsstarke Dialoge zur Verf&uuml;gung.<br /><br />H&auml;ufigste Verwendung findet dabei die bereits kennengelernte INPUTBOX. Dieser Dialog erm&ouml;glicht eine Eingabeaufforderung, in die der Benutzer einen Wert, z.B. einen Namen oder eine Zahl eingeben kann. INPUTBOX ist eine Funktion, deren R&uuml;ckgabewert der eingegebene String ist, und ben&ouml;tigt drei Parameter, n&auml;mlich den Dialog-Titel, einen Aufforderungstext sowie einen Vorgabewert, der direkt im Eingabefeld eingeblendet wird und vom Script-Benutzer ge&auml;ndert oder auch ganz ersetzt werden kann.<br /><br />Ein einfaches Beispiel ist das bereits im Grundlagenkapitel benutzte Script, bei dem der Benutzer einen Wert eingeben kann, der dann in einer ECHO-Messagebox wieder ausgegeben wird:<br /><br /><!-- code BEGIN --><div class="code">inputbox <font color="#000080">[wert]</font> = <font color="#0000ff">'Eingabe eines Wertes'</font>, <font color="#0000ff">'Bitte geben Sie einen Wert ein:'</font>, <font color="#0000ff">'Hallo!'</font><br />echo <font color="#0000ff">'Der eingegebene Wert lautet: '</font> # <font color="#000080">[wert]</font><br /><b>end</b></div><!-- code END--><div class="image"><img src="img/inputbox.gif" alt="Bild eines INPUTBOX-Dialogs" title="INFOBOX-Dialog" /><br />Der INPUTBOX-Dialog zur Abfrage von beliebigen Werten</div>Klickt der Benutzer auf den OK-Button im Dialog (oder auch einfach nur Return), wird der in das Textfeld eingegebene Text zur&uuml;ckgegeben. Klickt der Benutzer den Cancel-Button oder den Schlieﬂen-Button des Fensters rechts oben, liefert die Funktion einen Leerstring zur&uuml;ck.<br /><br />Die Beschriftung der Buttons l&auml;sst sich durch Setzen der vordeklarierten Variablen [InputBox_Ok] und [InputBox_Cancel] ver&auml;ndern, so daﬂ z.B. auch deutsche Bezeichnungen f&uuml;r die Buttons dort angegeben werden k&ouml;nnen. Defaultm&auml;ﬂig wird die INPUTBOX zentriert auf dem Bildschirm dargestellt; Eine beliebige, individuelle Anzeigeposition des Dialogs l&auml;sst sich allerdings mit Hilfe der vordeklarierten Variablen [InputBox_X] und [InputBox_Y] erzielen. Setzt man diese auf den Wert '0' (Standardwert), so bewirkt dies die Zentrierung des Dialogs auf der jeweiligen Achse.<br /><br /><!-- code BEGIN --><div class="code"><font color="#000080">[InputBox_Ok]</font> = <font color="#0000ff">'Alles klar!'</font><br /><font color="#000080">[InputBox_Cancel]</font> = <font color="#0000ff">'Stop!'</font><br />inputbox <font color="#000080">[test]</font> = <font color="#0000ff">'Ge&auml;nderte Buttons'</font>, <font color="#0000ff">'Bitte geben Sie etwas ein:'</font>, <font color="#0000ff">'hello world'</font><br />echo <font color="#000080">[test]</font><br /><b>end</b></div><!-- code END-->Neben dem INPUTBOX-Dialog bietet RapidBATCH auch den PWDBOX-Dialog. Eine PWDBOX ist nichts anderes als eine &quot;INPUTBOX f&uuml;r Passw&ouml;rter&quot;, die zur Eingabe des Wertes anstatt eines normalen Textfeldes ein maskiertes Eingabefeld zur Verf&uuml;gung stellt (in dem jedes eingegebene Zeichen durch ein &quot;*&quot; maskiert wird). Ein PWDBOX-Dialog kann (und sollte!) daher auch nur zur verdeckten Eingabe von Passw&ouml;rtern eingesetzt werden (daher auch der Name: &quot;PWD&quot; ist die englische Abk&uuml;rzung f&uuml;r &quot;Password&quot;). Die Parameter von PWDBOX sind dieselben wie bei der INPUTBOX (mit selber Funktion), zudem lassen sich, da PWDBOX das selbe Fenster verwendet wie INPUTBOX, die Beschriftung der Buttons ebenfalls &uuml;ber [InputBox_Ok] und [InputBox_Cancel] &auml;ndern (ebenso [InputBox_X] und [InputBox_Y] f&uuml;r die Positionierung des Dialogs auf dem Bildschirm).<br /><br /><!-- code BEGIN --><div class="code">pwdbox <font color="#000080">[passwort]</font> = <font color="#0000ff">'Passwort'</font>, <font color="#0000ff">'Bitte geben Sie Ihr Passwort ein:'</font>, <font color="#0000ff">''</font><br />echo <font color="#0000ff">'Ihr Passwort lautet: '</font> # <font color="#000080">[passwort]</font><br /><b>end</b></div><!-- code END-->Bisher haben wir nur einzeilige Eingaben t&auml;tigen k&ouml;nnen; Diese reichen nat&uuml;rlich f&uuml;r sehr viele Anwendungsbereiche bereits aus. Wenn wir aber nun gr&ouml;ﬂere Eingaben, z.B. eine Adresse oder sogar einen ganzen Text vom Script-User abfragen m&ouml;chten, gen&uuml;gen Dialoge wie INPUTBOX oder PWDBOX nicht mehr.<br />Hier m&uuml;ssen wir auf ein weiteres Dialogfenster von RapidBATCH zugreifen: Die EDITBOX! EDITBOX erm&ouml;glicht es, einen kompletten Text vom Benutzer editieren zu lassen. &Auml;hnlich wie in einem Text-Editor l&auml;sst sich in der EDITBOX das Textfenster scrollen und durch Ziehen mit der Maus vergr&ouml;ﬂern oder verkleinern. EDITBOX arbeitet im Grunde genauso wie INPUTBOX, da durch Klicken des am unteren Rand befindlichen OK-Buttons der im Textfeld eingegebene/editierte Text, oder durch anklicken des Cancel-Buttons bzw. des Schlieﬂen-Buttons rechts oben, ein Leerstring an die beim Funktionsaufruf angegebene R&uuml;ckgabe-Variable zur&uuml;ckgegeben wird. <br /><div class="image"><img src="img/editbox.gif" alt="Bild eines EDITBOX-Dialogs" title="EDITBOX-Dialog" /><br />Der EDITBOX-Dialog zur mehrzeiligen Eingabe bzw. Bearbeitung von Texten und Werten</div>Als Parameter erwartet die EDITBOX-Funktion einen Fenstertitel, den Text, der im Editierfeld stehen soll, und einen Style-Parameter, ob der Text im Editierfeld editierbar (Wert 'writeable' oder '0') oder nicht-editierbar (Wert 'readonly' oder '-1') ist. Dieser Parameter erm&ouml;glicht dann auch die Anzeige von Text ohne dass der Benutzer diesen editieren kann (beispielsweise um eine ReadMe-Datei oder einen Lizenztext bei einem Setup-Script anzuzeigen).<br /><br />Beispiel:<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem Texte editieren mit EDITBOX</font><br />editbox <font color="#000080">[text]</font> = <font color="#0000ff">'Bitte geben Sie einen Text ein:'</font>, <font color="#0000ff">''</font>, <font color="#0000ff">'writeable'</font><br />msgbox <font color="#0000ff">'Der Text lautet:'</font>, <font color="#000080">[text]</font>, <font color="#0000ff">'64'</font><br /><b>end</b></div><!-- code END-->Der EDITBOX-Dialog kann mit Hilfe der vordeklarierten Variablen [EditBox_Width] und [EditBox_Height] in der Gr&ouml;ﬂe angepasst werden, ebenso ist auch die Positionierung des Dialogs auf dem Bildschirm mit den Variablen [EditBox_X] und [EditBox_Y] ohne weiteres m&ouml;glich, wobei auch hier eine automatische (und bereits vordefinierte) Zentrierung des Dialogs mit dem Wert 0 erm&ouml;glicht wird.<br /><br />Die Beschriftung der Buttons ist &uuml;ber [EditBox_Ok] und [EditBox_Cancel] m&ouml;glich. Wenn man die Button-Beschriftung auf einen Leerstring setzt, wird der entsprechende Button einfach ausgeblendet, so dass man z.B. eine EDITBOX mit nur einem &quot;Weiter&quot;-Button programmieren kann, wie in folgendem Beispiel (die Funktionen OPENBOX und READFILE werden sp&auml;ter noch genauer besprochen!):<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem Datei-Anzeige Script mit der EDITBOX</font><br /><font color="#808080">rem Dateiname abfragen</font><br />openbox <font color="#000080">[file]</font> = <font color="#0000ff">'Bitte Datei w&auml;hlen:'</font>, <font color="#0000ff">'Textdateien|*.txt'</font><br /><b>if</b> <font color="#000080">[file]</font> = <font color="#0000ff">''</font> <b>halt</b><br /><br /><font color="#808080">rem Datei lesen</font><br />readfile <font color="#000080">[text]</font> = <font color="#000080">[file]</font>, <font color="#0000ff">'0'</font><br /><br /><font color="#808080">rem EDITBOX individualisieren und anzeigen</font><br /><font color="#000080">[EditBox_Ok]</font> = <font color="#0000ff">''</font><br /><font color="#000080">[EditBox_Cancel]</font> = <font color="#0000ff">'Weiter &gt;'</font><br /><font color="#000080">[EditBox_Width]</font> = <font color="#0000ff">'450'</font><br /><font color="#000080">[EditBox_Height]</font> = <font color="#0000ff">'480'</font><br />editbox <font color="#000080">[text]</font> = <font color="#0000ff">'Inhalt von: '</font> # <font color="#000080">[file]</font>, <font color="#000080">[text]</font>, <font color="#0000ff">'readonly'</font><br /><b>end</b></div><!-- code END--><br /><br />

		<div class="line">&nbsp;</div>

		<div id="copyright">
			Copyright &copy; 2000-2006 by J.M.K S.F. Software Technologies, Jan Max Meyer<br />
			All rights reserved.
		</div>
	</body>
</html>
