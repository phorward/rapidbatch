<html>
	<head>
		<title>Bearbeiten der Registry</title>
		<link rel="stylesheet" href="jmksf.css" type="text/css"></link>
	</head>

	<body>
		<div id="top">
			<img src="rb5.png" alt="RapidBATCH Logo" />
			Bearbeiten der Registry
		</div>
		
		<div class="line">&nbsp;</div>
		
		Mit der Version 5.0 erm&ouml;glicht RapidBATCH nun auch erstmals das direkte Bearbeiten der Windows-Registry. Die Registry ist eine mit Windows 95 eingef&uuml;hrte Datenbank, welche ein fester Bestandteil der Windows-Betriebssystemreihe geworden ist. Der haupts&auml;chliche Zweck der Registry besteht darin, Konfgurationswerte und individualisierende Schalter f&uuml;r Programme abzulegen bzw. sogar benutzerorientiert zu speichern. Auch Informationen &uuml;ber Dateiendungstypen sowie alle nur erdenklichen Systemeinstellungen sind in der Registry hinterlegt. Damit entf&auml;llt auch die Verm&uuml;llung der Festplatte durch Konfigurations- und INI-Dateien fast g&auml;nzlich.<br />Editiert und betrachtet werden kann die Registry mit dem Windows-eigenen Werkzeug &quot;regedit&quot;, welches bei jeder Windows-Version mitgeliefert wird.<br /><br />Die Registry ist &auml;hnlich dem Dateisystem von Windows aufgebaut, wobei es 5 so genannte Hauptschl&uuml;ssel gibt. Ein Registrierungsschl&uuml;ssel ist eine Art &quot;Ordner&quot; in der Registry, und kann theoretisch gesehen unendlich viele Unterschl&uuml;ssel haben. In jedem Schl&uuml;ssel k&ouml;nnen zus&auml;tzlich eine unbegrenzte Anzahl von Werten abgelegt werden, welche einen Namen und den ensprechend hinterlegten Wert haben.<br /><br />Folgend eine Auflistung der 5 Hauptschl&uuml;ssel und deren Bedeutung.<ul>	<li><b>HKEY_CLASSES_ROOT</b><br />	Hier werden Informationen &uuml;ber die verschiedenen Dateitypen gespeichert. Darunter fallen die Beschreibung, das Symbol und die verkn&uuml;pfte Anwendung.	</li>	<li><b>HKEY_CURRENT_USER</b><br />	Hier werden Einstellungen und Informationen zu Software gespeichert, die nur f&uuml;r den aktuellen Windows-Benutzer gelten.	</li>	<li><b>HKEY_LOCAL_MACHINE</b><br />	Hier werden von allen Benutzern geteilte Einstellungen und Informationen gespeichert.	</li>	<li><b>HKEY_USERS</b><br />	Enth&auml;lt den Stamm aller Benutzerprofile auf dem Computer.	</li>	<li><b>HKEY_CURRENT_CONFIG</b><br />	Grundlegende Einstellungen des Betriebssystemes.	</li></ul>Mit RapidBATCH l&auml;sst sich die Registry nun zunutze machen. Ob man nun via RapidBATCH bestehende Registry-Werte automatisiert ver&auml;ndert, um z.B. das Verhalten einer Software zu &auml;ndern oder zu bestimmen oder selbst einen eigenen Schl&uuml;ssel f&uuml;r sein Script anlegt, um dort beispielsweise benutzerdefinierte Einstellungen und Schalter zu speichern, ist jedem selbst &uuml;berlassen. Nat&uuml;rlich kommt es immer ganz auf den Zweck des jeweiligen Scripts an.<br /><br />Zum Erstellen und Entfernen von Schl&uuml;sseln stellt RapidBATCH die Anweisungen NEWREGKEY und DELREGKEY zur Verf&uuml;gung. NEWREGKEY erstellt einen Unterschl&uuml;ssel, DELREGKEY entfernt einen Schl&uuml;ssel samt Unterschl&uuml;ssel und Werten aus der Registry.Als Parameter erwarten beide Anweisungen zuerst den Bezeichner des Hauptschl&uuml;ssels, welcher durch die Werte 'CLASSES_ROOT', 'CURRENT_CONFIG', 'CURRENT_USER', 'LOCAL_MACHINE' und 'USERS' spezifiziert wird, sowie den Pfad des neu zu erstellenden Schl&uuml;ssels. Folgendes Script erzeugt einen Schl&uuml;ssel unter HKEY_CURRENT_USER mit dem Namen &quot;Test&quot;.<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem Einen neuen Schl&uuml;ssel erstellen</font><br />newregkey <font color="#0000ff">'CURRENT_USER'</font>, <font color="#0000ff">'Test'</font><br /><b>if</b> <font color="#000080">[errorcode]</font> = <font color="#0000ff">'0'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Erstellen von HKEY_CURRENT_USER\Test war erfolgreich.'</font><br /><b>else</b><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Fehler beim Erstellen von HKEY_CURRENT_USER\Test.'</font><br /><b>endif</b><br /><br /><font color="#808080">rem Einen existierenden Schl&uuml;ssel entfernen</font><br />delregkey <font color="#0000ff">'CURRENT_USER'</font>, <font color="#0000ff">'Test'</font><br /><b>if</b> <font color="#000080">[errorcode]</font> = <font color="#0000ff">'0'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'L&ouml;schen von HKEY_CURRENT_USER\Test war erfolgreich.'</font><br /><b>else</b><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Fehler beim Entfernen von HKEY_CURRENT_USER\Test.'</font><br /><b>endif</b></div><!-- code END-->Wichtig beim Erstellen eines Schl&uuml;ssels ist, dass die n&auml;chsth&ouml;here Ebene des zu erstellenden Schl&uuml;ssels bereits existiert, d.h. es besteht hier keine &Auml;quivalenz zu MKDIR.<br /><br />Um nun einen Wert in den Schl&uuml;ssel selbst zu schreiben oder dem Schl&uuml;ssel einen Wert hinzuzuf&uuml;gen bietet RapidBATCH die Anweisung LETREGKEY. LETREGKEY unsterst&uuml;tzt dabei drei unterschiedliche Datentypen (&quot;String&quot;, &quot;Binary&quot; und &quot;Long&quot; (DWORD)), die sich als Werte in der Registry ablegen lassen. Desweiteren erwartet die Anweisung den Hauptschl&uuml;sselnamen, den Schl&uuml;sselpfad, den Wertnamen sowie den zu setzenden Wert in der je nach Datentyp angegebenen Form. Folgendes Beispiel erzeugt einen neuen Wert &quot;HelloWorld&quot; im Schl&uuml;ssel &quot;Test&quot; unter &quot;HKEY_CURRENT_USER&quot; (der Schl&uuml;ssel wird hier vorher auch nochmal mit NEWREGKEY angelegt).<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem Testschl&uuml;ssel anlegen</font><br />newregkey <font color="#0000ff">'CURRENT_USER'</font>, <font color="#0000ff">'Test'</font><br /><b>if</b> <font color="#000080">[errorcode]</font> = <font color="#0000ff">'0'</font><br /><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem Wert in Registry schreiben</font><br />&nbsp;&nbsp;&nbsp;&nbsp;letregval <font color="#0000ff">'string'</font>, <font color="#0000ff">'CURRENT_USER'</font>, <font color="#0000ff">'Test'</font>, <font color="#0000ff">'HelloWorld'</font>, <font color="#0000ff">'Das ist der Wert!'</font><br /><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem War das Schreiben des Wertes erfolgreich?</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[errorcode]</font> = <font color="#0000ff">'0'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Schreiben der Registry war erfolgreich!'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>else</b><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Fehler beim Schreiben der Registry'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>endif</b><br /><b>endif</b></div><!-- code END--><div class="image"><img src="img/sysop_regvalue1.gif" alt="Der Registry-Editor mit dem erstellten Wert." title="Betrachtung des mit RapidBATCH geschriebenen Wertes im Registry-Editor" /><br />Erfolgreich geschriebener Wert in der Registry.</div>Es kann auch ein Wert direkt in den Schl&uuml;ssel geschrieben werden; Hier l&auml;sst man einfach den Parameter f&uuml;r den Registry-Wertnamen leer.<br /><br /><!-- code BEGIN --><div class="code">letregval <font color="#0000ff">'string'</font>, <font color="#0000ff">'CURRENT_USER'</font>, <font color="#0000ff">'Test'</font>, <font color="#0000ff">''</font>, <font color="#0000ff">'Das ist der Wert!'</font></div><!-- code END-->Um einen Bin&auml;rwert zu schreiben, wird bei der LETREGVAL genauso verfahren wie bei PUTFILE: Eine Liste an ASCII-Zeichencodes, bei der jeder Wert zwischen 0 und 255 liegen kann, also 8 Bit je Zeichen. Hier ein &quot;Hello World&quot; in bin&auml;r:<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem Wert in Registry schreiben</font><br /><font color="#000080">[hello]</font> = <font color="#0000ff">'72|101|108|108|111|32|87|111|114|108|100'</font><br />letregval <font color="#0000ff">'binary'</font>, <font color="#0000ff">'CURRENT_USER'</font>, <font color="#0000ff">'Test'</font>, <font color="#0000ff">'binary_HelloWorld'</font>, <font color="#000080">[hello]</font><br /><br /><font color="#808080">rem War das Schreiben des Wertes erfolgreich?</font><br /><b>if</b> <font color="#000080">[errorcode]</font> = <font color="#0000ff">'0'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Schreiben der Registry war erfolgreich!'</font><br /><b>else</b><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Fehler beim Schreiben der Registry'</font><br /><b>endif</b></div><!-- code END--><div class="image"><img src="img/sysop_regvalue2.gif" alt="Ansicht eines Bin&auml;rwertes im Registry-Editor" title="Der Bin&auml;rwert im Registry-Editor" /><br />Ein deutlich erkennbares &quot;Hello World&quot; wurde bin&auml;r in die Registry geschrieben!</div>Soll ein DWORD-Wert in die Registry geschrieben werden, k&ouml;nnen nur numerische 32-Bit Ganzzahlwerte in die Registry geschrieben werden.<br /><br />Das Auslesen von Registry-Werten erfolgt auch hier wieder &auml;quivalent &uuml;ber eine Funktion namens GETREGVAL. Parameter sind hier die selben wie bei LETREGVAL, nur dass hier nat&uuml;rlich kein Wert, daf&uuml;r aber eine R&uuml;ckgabevariable angegeben werden muss.<br /><br />Dieses Beispiel liest die oben geschriebenen Werte wieder aus der Registry aus:<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem Stringwert aus Registry lesen</font><br />getregval <font color="#000080">[text]</font> = <font color="#0000ff">'string'</font>, <font color="#0000ff">'CURRENT_USER'</font>, <font color="#0000ff">'Test'</font>, <font color="#0000ff">'HelloWorld'</font><br />echo <font color="#0000ff">'Stringwert in "HelloWorld": '</font> # <font color="#000080">[text]</font><br /><br /><font color="#808080">rem Bin&auml;rwert aus Registry lesen</font><br />getregval <font color="#000080">[data]</font> = <font color="#0000ff">'binary'</font>, <font color="#0000ff">'CURRENT_USER'</font>, <font color="#0000ff">'Test'</font>, <font color="#0000ff">'binary_HelloWorld'</font><br />echo <font color="#0000ff">'Gelesene ASCII-Liste aus "binary_HelloWorld": '</font> # <font color="#000080">[data]</font><br /><br /><font color="#808080">rem ASCII-Codes in ASCII-Zeichen umwandeln und an Ausgabestring h&auml;ngen</font><br /><font color="#000080">[i]</font> = <font color="#0000ff">'0'</font><br /><b>repeat</b><br />&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[i]</font> + <font color="#0000ff">'1'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;gettok <font color="#000080">[zeichen]</font> = <font color="#000080">[data]</font>, <font color="#000080">[std_sep]</font>, <font color="#000080">[i]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[zeichen]</font> ! <font color="#0000ff">''</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;getchr <font color="#000080">[zeichen]</font> = <font color="#000080">[zeichen]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[klartext]</font> # <font color="#000080">[zeichen]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>endif</b><br /><b>until</b> <font color="#000080">[zeichen]</font> = <font color="#0000ff">''</font><br /><br /><font color="#808080">rem Den Klartext ausgeben</font><br />echo <font color="#0000ff">'Klartext aus "binary_HelloWorld": '</font> # <font color="#000080">[klartext]</font></div><!-- code END-->Zu guter Letzt entfernen wir noch die geschriebenen Werte mit Hilfe der DELREGVAL-Anweisung aus der Registy.<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem "HelloWorld" entfernen</font><br />delregval <font color="#0000ff">'CURRENT_USER'</font>, <font color="#0000ff">'Test'</font>, <font color="#0000ff">'HelloWorld'</font><br /><b>if</b> <font color="#000080">[errorcode]</font> ! <font color="#0000ff">'0'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Fehler beim L&ouml;schen von "HelloWorld"'</font><br /><b>endif</b><br /><br /><font color="#808080">rem "binary_HelloWorld" entfernen</font><br />delregval <font color="#0000ff">'CURRENT_USER'</font>, <font color="#0000ff">'Test'</font>, <font color="#0000ff">'binary_HelloWorld'</font><br /><b>if</b> <font color="#000080">[errorcode]</font> ! <font color="#0000ff">'0'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Fehler beim L&ouml;schen von "binary_HelloWorld"'</font><br /><b>endif</b></div><!-- code END--><br /><br />

		<div class="line">&nbsp;</div>

		<div id="copyright">
			Copyright &copy; 2000-2006 by J.M.K S.F. Software Technologies, Jan Max Meyer<br />
			All rights reserved.
		</div>
	</body>
</html>
