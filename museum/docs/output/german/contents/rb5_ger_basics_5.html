<html>
	<head>
		<title>Spr&uuml;nge und Subs</title>
		<link rel="stylesheet" href="jmksf.css" type="text/css"></link>
	</head>

	<body>
		<div id="top">
			<img src="rb5.png" alt="RapidBATCH Logo" />
			Spr&uuml;nge und Subs
		</div>
		
		<div class="line">&nbsp;</div>
		
		Ein bew&auml;hrtes Mittel, den Programmablauf strukturiert zu gestalten, ist der Sprung zu Codelabels und Unterprogrammen, den so genannten Subs. Da allerdings die meisten Probleme mit eigenen Prozeduren und Funktionen und den Schleifen-Anweisungen REPEAT und UNTIL gel&ouml;st werden k&ouml;nnen, wird dieses Thema nur einmal kurz angesprochen.<br /><br />Um mit Codelabels bzw. Unterprogrammen zu arbeiten stehen Ihnen die Anweisungen GOTO, GOSUB und RESUME zur Verf&uuml;gung. Mit GOTO k&ouml;nnen Sie vorw&auml;rts oder r&uuml;ckw&auml;rts durch das Script &quot;springen&quot;, d.h. Sie k&ouml;nnen mit der Programmausf&uuml;hrung einfach an einer anderen Position im Script fortfahren. Diese GOTO-Spr&uuml;nge werden von vielen Programmierern oft verhasst, weil sie den Code unsch&ouml;n und un&uuml;bersichtlich machen, doch manchmal sind solche Spr&uuml;nge einfach unerl&auml;sslich und bringen auch viele Vorteile mit sich (z.B. h&ouml;here Performance).<br />Einfachstes Fallbeispiel ist z.B. folgendes Script. Wir haben drei Meldungsfenster, von denen jedoch nur das erste und das dritte angezeigt werden. Nach dem ersten ECHO springen wir hier einfach via GOTO zu dem Label %ende. Labels, auch Sprungmarken genannt, sind direkt im Code durch ein vorangestelltes Prozent-Zeichen (%) gekennzeichnet und k&ouml;nnen jeden beliebigen Namen haben, auch mit Leer- und Sonderzeichen.<br /><br /><!-- code BEGIN --><div class="code">echo <font color="#0000ff">'Meldung 1'</font><br /><b>goto</b> <font color="#0000ff">'ende'</font><br />echo <font color="#0000ff">'Meldung 2'</font><br />%ende<br />echo <font color="#0000ff">'Meldung 3'</font><br /><b>end</b></div><!-- code END-->Ausserdem gibt es seit RapidBATCH 4.0 auch die M&ouml;glichkeit, sehr einfache Unterprogramme, so genannte Subs, zu entwickeln. Dies sind keine wirklichen Prozeduren wie solche, auf die ich sp&auml;ter noch genauer eingehen werde, sondern Code-Bl&ouml;cke, die mit einem Label beginnen und mit einer RESUME-Anweisung enden. Bei Ausf&uuml;hrung von RESUME wird das Script hinter dem letzten GOSUB-Aufruf fortgef&uuml;hrt, d.h. das Unterprogramm kann von verschiedenen Positionen aus aufgerufen werden und wird nach dem RESUME wieder an der jeweiligen Stelle fortgef&uuml;hrt, von der es aufgerufen wurde. Folgendes Beispiel nimmt die Zahlen 1 bis 10 zum Quadrat.<br /><br /><!-- code BEGIN --><div class="code"><font color="#000080">[i]</font> = <font color="#0000ff">'1'</font><br /><b>repeat</b><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>gosub</b> <font color="#0000ff">'quadrat'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[i]</font> + <font color="#0000ff">'1'</font><br /><b>until</b> <font color="#000080">[i]</font> &gt; <font color="#0000ff">'10'</font><br /><b>halt</b><br /><br /><font color="#808080">rem Sub: quadrat</font><br />%quadrat<br /><font color="#000080">[x]</font> = <font color="#000080">[i]</font> * <font color="#000080">[i]</font><br />echo <font color="#000080">[i]</font> # <font color="#0000ff">' * '</font> # <font color="#000080">[i]</font> # <font color="#0000ff">' = '</font> # <font color="#000080">[x]</font><br /><b>resume</b><br /><b>end</b></div><!-- code END-->Die GOSUB-Anweisung springt hier, genau wie GOTO, zu einem Label (hier: quadrat).<br />Beachten Sie bitte, dass man diese Prozeduraufrufe auch beliebig ineinander verschachteln kann, d.h. Subs k&ouml;nnen wiederum andere Subs oder sich selbst rekursiv aufrufen. Bestes Beispiel w&auml;re hier das folgende Script:<br /><br /><!-- code BEGIN --><div class="code">echo <font color="#0000ff">'Meldung 1'</font><br /><b>gosub</b> <font color="#0000ff">'test1'</font><br />echo <font color="#0000ff">'Meldung 2'</font><br /><b>halt</b><br /><br />%test1<br />echo <font color="#0000ff">'Meldung 3'</font><br /><b>gosub</b> <font color="#0000ff">'test2'</font><br /><b>resume</b><br /><br />%test2<br />echo <font color="#0000ff">'Meldung 4'</font><br /><b>gosub</b> <font color="#0000ff">'test3'</font><br /><b>resume</b><br /><br />%test3<br />echo <font color="#0000ff">'Meldung 5'</font><br /><b>gosub</b> <font color="#0000ff">'test4'</font><br /><b>resume</b><br /><br />%test4<br />echo <font color="#0000ff">'Meldung 6'</font><br /><b>resume</b><br /><br /><b>end</b></div><!-- code END-->Die Meldungsfenster erscheinen in folgender Reihenfolge: 1, 3, 4, 5, 6, 2!<br /><br />Seit RapidBATCH 5.0 sind auch dynamische Spr&uuml;nge via GOTO und GOSUB m&ouml;glich. Das bedeutet, dass bei GOTO bzw. GOSUB als Label auch eine Variable oder ein zusammengesetzter Wert angegeben werden kann, zu dem gesprungen wird.<br /><br />Beispiel:<br /><br /><!-- code BEGIN --><div class="code">confirm <font color="#000080">[answer]</font> = <font color="#0000ff">'Ja oder Nein?'</font><br /><b>goto</b> <font color="#000080">[answer]</font><br /><br />%0<br />echo <font color="#0000ff">'Sie haben JA angeklick!'</font><br /><b>halt</b><br /><br />%-1<br />echo <font color="#0000ff">'Sie haben NEIN angeklickt!'</font><br /><b>end</b></div><!-- code END-->Interessant werden diese dynamischen Spr&uuml;nge u.a. noch etwas sp&auml;ter, wenn es um benutzerdefinierte Dialoge geht. Sie sind jedoch mit Vorsicht zu genieﬂen, da ein falsch zusammengesetzer Labelname zum sofortigen Verlassen des Scripts f&uuml;hrt, wenn das Label nicht im Script definiert ist.<br /><br />Labels sollten aber nur dann verwendet werden, wenn dies zwingend notwendig ist. Vermehrt soll in RapidBATCH 5 mit Prozeduren und Funktionen gearbeitet werden, welche Sie, wie bereits er&ouml;rtert, sp&auml;ter genauer kennenlernen werden.<br /><br />

		<div class="line">&nbsp;</div>

		<div id="copyright">
			Copyright &copy; 2000-2006 by J.M.K S.F. Software Technologies, Jan Max Meyer<br />
			All rights reserved.
		</div>
	</body>
</html>
