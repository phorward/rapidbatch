<html>
	<head>
		<title>Variablen</title>
		<link rel="stylesheet" href="jmksf.css" type="text/css"></link>
	</head>

	<body>
		<div id="top">
			<img src="rb5.png" alt="RapidBATCH Logo" />
			Variablen
		</div>
		
		<div class="line">&nbsp;</div>
		
		Nachdem Sie nun die erste H&uuml;rde, das erste eigene Script, &uuml;berwunden haben, geht's erstmal richtig los!<br /><br />Wir werden nun ein Script entwickeln, das mit variablen, also nicht konstanten Werten arbeitet. Diese so genannten <i>Variablen</i> spielen n&auml;mlich in der Programmierung von Computern eine sehr wichtige Rolle, da sie den Programmablauf beeinflussen und steuern. Der Ablauf des Programms kann also von diesen variablen Werten gesteuert und ver&auml;ndert werden.<br /><br />Variablen sind also Speicherbereiche, denen ein Wert zugewiesen werden kann. Das nun folgende Script soll einmal den Einsatz von Variablen demonstrieren. Dazu erstellen Sie im RapidBATCH Builder eine neue, leere Script-Datei und geben folgenden Quellcode ein:<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem Eingabe des Benutzernamens</font><br />inputbox <font color="#000080">[benutzer]</font> = <font color="#0000ff">'Eingabe'</font>, <font color="#0000ff">'Hallo, wie ist Ihr Name?'</font>, <font color="#0000ff">''</font><br /><br /><font color="#808080">rem Ausgabe des Benutzernamens</font><br />echo <font color="#000080">[benutzer]</font><br /><b>end</b></div><!-- code END-->Dieses Programm fragt mit Hilfe des INPUTBOX-Dialogs zuerst den Namen des Anwenders ab. Dieser wird in die Variable mit dem Namen [benutzer] gespeichert, weil diese vor dem Gleichheitszeichen (=) der INPUTBOX steht. Die INPUTBOX ist eine so genannte Funktion, genaueres dazu erl&auml;utere ich jedoch sp&auml;ter.<br /><br />Variablen werden in RapidBATCH immer von eckigen Klammern umschlossen, und k&ouml;nnen &uuml;berall eingesetzt werden, wo auch konstante Werte m&ouml;glich sind.<br />In der darauf folgenden ECHO-Anweisung geben wir die Variable wieder aus. Dies geschieht durch einfaches Angeben des Variablennamens anstatt eines konstanten Wertes, wie wir es im ersten Beispiel getan haben. Wir geben hier also anstatt eines festen Wertes den v&ouml;llig frei vom Anwender des Scripts definierten Wert der Variablen [benutzer] aus, d.h. die Ausgabe, die im Meldungsfenster erscheint, ist abh&auml;ngig von dem, was der Benutzer im Eingabefenster eingegeben hat.<br /><br />Variablen in RapidBATCH k&ouml;nnen sowohl Texte, so genannte Strings (zu deutsch: &quot;Zeichenketten&quot;), als auch Zahlen speichern, berechnen und manipulieren. Die Konvertierung zwischen den verschiedenen Datentypen findet dabei intern statt, so dass sich der Programmierer darum nicht explizit k&uuml;mmern muss.<br /><br />Seit RapidBATCH 4.0 m&uuml;ssen Variablen auch nicht mehr explizit mit der DEC-Anweisung (was soviel bedeutet wie &quot;Declare&quot;, zu deutsch &quot;Deklariere&quot;) vor ihrer Verwendung deklariert werden. DEC spielt aber trotzdem noch eine sehr wichtige Rolle, auf die wir aber sp&auml;ter erst eingehen m&ouml;chten. Wenn Sie einer Variablen, die nicht existiert, einen Wert zuweisen, wird diese also automatisch im Speicher erzeugt. Die Variable ist dann solange im Speicher, bis das Script beendet wird.<br /><br />Um einer Variable einen Wert zuzuweisen, gen&uuml;gt eine einfache Zuweisung in der Form<br /><br /><!-- code BEGIN --><div class="code"><font color="#000080">[variable]</font> = <font color="#0000ff">'Wert'</font></div><!-- code END-->z.B. <br /><br /><!-- code BEGIN --><div class="code"><font color="#000080">[benutzer]</font> = <font color="#0000ff">'Anna'</font></div><!-- code END-->oder, um einer Variablen den Wert einer bereits existierenden Variablen zuzuweisen:<br /><br /><!-- code BEGIN --><div class="code"><font color="#000080">[benutzer]</font> = <font color="#000080">[name]</font></div><!-- code END-->Bei Variablenzuweisungen lassen sich Werte auch verketten und berechnen. Zu diesem Zweck stellt RapidBATCH sechs verschiedene Operatoren zur Verf&uuml;gung, die zur Verkettung und Berechnung von Werten verwendet werden k&ouml;nnen. Folgendes Script verbindet beispielsweise mit Hilfe des Join-Operators (#) eine Variable mit einem konstanten String und weist das Ergebnis dieser Zuweisung der Variablen [ausgabe] zu:<br /><br /><!-- code BEGIN --><div class="code"><font color="#000080">[ausgabe]</font> = <font color="#0000ff">'Aha, Ihr Name ist also '</font> # <font color="#000080">[benutzer]</font></div><!-- code END-->Diese Verkettung zweier Werte kann auch direkt als Parameter einer Anweisung angegeben werden, Beispiel w&auml;re hier<br /><br /><!-- code BEGIN --><div class="code">echo <font color="#0000ff">'Aha, Ihr Name ist also '</font> # <font color="#000080">[benutzer]</font></div><!-- code END-->Mit den Operatoren +, -, *, / und ~ f&uuml;r Addition, Subtraktion, Multiplikation, Division und Modulo (Restwert) k&ouml;nnen Variablen und Werte auch berechnet werden. Wichtig ist hierbei, dass die Variablen einen numerischen Wert enthalten. Enth&auml;lt der Wert einer Variablen z.B. den Text &quot;Hallo&quot; anstatt einer Zahl, so wird er bei einer Berechnung als &quot;0&quot; interpretiert.<br /><br />Folgendes Script zeigt, wie man mit Hilfe des Additions-Operators (+) eine Addition in RapidBATCH durchf&uuml;hrt:<br /><br /><!-- code BEGIN --><div class="code"><font color="#000080">[a]</font> = <font color="#0000ff">'2'</font><br /><font color="#000080">[b]</font> = <font color="#0000ff">'5'</font><br /><font color="#000080">[ergebnis]</font> = <font color="#000080">[a]</font> + <font color="#000080">[b]</font><br />echo <font color="#000080">[a]</font> # <font color="#0000ff">' + '</font> # <font color="#000080">[b]</font> # <font color="#0000ff">' ergibt '</font> # <font color="#000080">[ergebnis]</font><br /><b>end</b></div><!-- code END-->Da man Werte auch direkt berechnen kann, hat folgendes Script genau dieselbe Ausgabe:<br /><br /><!-- code BEGIN --><div class="code"><font color="#000080">[a]</font> = <font color="#0000ff">'2'</font><br /><font color="#000080">[b]</font> = <font color="#0000ff">'5'</font><br />echo <font color="#000080">[a]</font> # <font color="#0000ff">' + '</font> # <font color="#000080">[b]</font> # <font color="#0000ff">' ergibt '</font> # (<font color="#000080">[a]</font> + <font color="#000080">[b]</font>)<br /><b>end</b></div><!-- code END-->Hier weisen wir den Wert nicht vorher einer Variablen zu, sondern lassen ihn direkt bei der Ausgabe berechnen, also da, wo das Ergebnis ben&ouml;tigt wird.<br />RapidBATCH 5 ist hierbei sehr flexibel; Es k&ouml;nnen somit beispielsweise auch ganze Formeln durch Klammernsetzung in einem Rutsch berechnet werden:<br /><br /><!-- code BEGIN --><div class="code"><font color="#000080">[a]</font> = <font color="#0000ff">'5'</font><br /><font color="#000080">[b]</font> = <font color="#0000ff">'12'</font><br />echo <font color="#000080">[a]</font> * (<font color="#000080">[b]</font> + <font color="#0000ff">'4'</font> * (<font color="#000080">[a]</font> - <font color="#0000ff">'2'</font>)) / <font color="#000080">[b]</font><br /><b>end</b></div><!-- code END-->Obiges Script w&uuml;rde zur Ausgabe des Wertes &quot;10&quot; f&uuml;hren!<br /><br />Zudem bietet RapidBATCH bei Zuweisungen eine verk&uuml;rzte Schreibweise an, um z.B. einen Wert auf sich selber aufzuaddieren.<br /><br /><!-- code BEGIN --><div class="code"><font color="#000080">[a]</font> + <font color="#0000ff">'5'</font></div><!-- code END-->ist &auml;quivalent zur bisher bekannten Zuweisung <br /><br /><!-- code BEGIN --><div class="code"><font color="#000080">[a]</font> = <font color="#000080">[a]</font> + <font color="#0000ff">'5'</font></div><!-- code END-->oder auch eine Quadrierung<br /><br /><!-- code BEGIN --><div class="code"><font color="#000080">[a]</font> * <font color="#000080">[a]</font></div><!-- code END-->Diese Kurzform f&uuml;r Zuweisungen ist mit allen RapidBATCH-Operatoren m&ouml;glich, und spart viel Tipparbeit.<br /><br />

		<div class="line">&nbsp;</div>

		<div id="copyright">
			Copyright &copy; 2000-2006 by J.M.K S.F. Software Technologies, Jan Max Meyer<br />
			All rights reserved.
		</div>
	</body>
</html>
