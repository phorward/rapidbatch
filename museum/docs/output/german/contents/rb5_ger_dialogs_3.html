<html>
	<head>
		<title>Men&uuml;s und Auswahlm&ouml;glichkeiten</title>
		<link rel="stylesheet" href="jmksf.css" type="text/css"></link>
	</head>

	<body>
		<div id="top">
			<img src="rb5.png" alt="RapidBATCH Logo" />
			Men&uuml;s und Auswahlm&ouml;glichkeiten
		</div>
		
		<div class="line">&nbsp;</div>
		
		Bisher haben Sie bereits einige M&ouml;glichkeiten kennengelernt, um Daten vom Benutzer einzulesen. Diese Daten sind jedoch v&ouml;llig frei vom Benutzer definierbar. Um aber dem Benutzer die Auswahl eines Wertes aus einer bestimmten Anzahl von Werten zu erm&ouml;glichen, stellt RapidBATCH auch zwei leistungsstarke Dialoge zur Verf&uuml;gung.<br /><br />Die LISTBOX findet hierbei am h&auml;ufigsten Verwendung. LISTBOX ist ein Dialog mit einer Listenauswahlm&ouml;glichkeit, die sehr vielseitig eingesetzt werden kann: Ob als Programm-Men&uuml;, Dateiauswahl oder f&uuml;r andere Zwecke - Das Anwendungsspektrum f&uuml;r den LISTBOX-Dialog ist &auml;usserst breit und vielseitig gehalten.<div class="image"><img src="img/listbox.gif" alt="Bild eines LISTBOX-Dialogs" title="LISTBOX-Dialog" /><br />Der LISTBOX-Dialog bietet eine vielseitige und schnell realisierte Auswahlm&ouml;glichkeit</div>LISTBOX ben&ouml;tigt zur Anwendung zwei Parameter. Einmal einen Dialog-Titel und eine so genannte Liste. Solch eine Liste ist ein String, dessen einzelne &quot;Elemente&quot;, die sp&auml;ter in der LISTBOX angezeigt werden, standardm&auml;ﬂig durch Pipe-Zeichen (|) getrennt sind (dieses Listentrennzeichen l&auml;sst sich global &uuml;ber die Variable [std_sep] auch &auml;ndern). Ein Array l&auml;sst sich als Liste nicht direkt &uuml;bergeben, kann aber mit Hilfe der Funktion &quot;arrayToList&quot; aus der ARRAY.RB-Funktionsbibliothek schnell und einfach in eine Item-Liste f&uuml;r den LISTBOX-Dialog umgewandelt werden.<br />R&uuml;ckgabewert der LISTBOX-Funktion ist der ausgew&auml;hlte Wert aus der Liste. Ist dieser Wert leer, so wurde entweder kein Men&uuml;eintrag ausgew&auml;hlt oder der Schlieﬂen-Button der LISTBOX bet&auml;tigt.<br /><br />Ein einfaches Beispiel f&uuml;r eine LISTBOX ist folgendes Script mit einer kleinen Auswahl:<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem Einfache Auswahl mit einer LISTBOX:</font><br />listbox <font color="#000080">[auswahl]</font> = <font color="#0000ff">'Men&uuml;'</font>, <font color="#0000ff">'Men&uuml;eintrag 1|Men&uuml;eintrag 2|Men&uuml;eintrag 3'</font><br /><br /><b>if</b> <font color="#000080">[auswahl]</font> = <font color="#0000ff">''</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Kein Element ausgew&auml;hlt!'</font><br /><b>else</b><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Gew&auml;hltes Element ist '</font> # <font color="#000080">[auswahl]</font><br /><b>endif</b><br /><b>end</b></div><!-- code END-->Die LISTBOX ist ebenfalls sehr anpassungsf&auml;hig. &Auml;quivalent zu den bisher vorgestellten Dialogen l&auml;sst sich auch die LISTBOX mit Hilfe der Variablen [ListBox_Width] und [ListBox_Height] in der Gr&ouml;ﬂe ver&auml;ndern; [ListBox_X] und [ListBox_Y] erm&ouml;glichen die individuelle Positionierung des Dialoges (Defaultwert ist auch hier '0' zur automatischen Zentrierung). Mit [ListBox_Ok] l&auml;sst sich auch der Text auf dem OK-Button der LISTBOX ver&auml;ndern.<br />Um die Auswahl von mehr als einem Eintrag aus einer LISTBOX zu erm&ouml;glichen, bietet RapidBATCH ausserdem die Variable [ListBox_MultiSel]. Diese ist standardm&auml;ﬂig auf den Wert '-1' gesetzt, was soviel bedeutet wie &quot;Keine Mehrfachauswahl&quot;. Setzt man den Wert auf '0', lassen sich in der LISTBOX mehr als ein Eintrag ausw&auml;hlen, wenn n&ouml;tig auch alle. In diesem Fall wird ebenfalls (im Fall von mehreren selektierten Eintr&auml;gen) eine Liste von durch Pipe-Zeichen (bzw. das durch die Variable [std_sep] definierte Zeichen) von einander getrennten Werten zur&uuml;ckgeliefert.<br /><br />Folgendes Beispiel demonstriert die Verwendung der o.g. Variablen. Beobachten Sie bitte auch den R&uuml;ckgabewert von LISTBOX bei einer Mehrfach-Auswahl.<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem Dateiliste generieren (Dateinamen werden von FINDFILES als Liste zur&uuml;ckgegeben</font><br />findfiles <font color="#000080">[dateiliste]</font> = <font color="#0000ff">'C:\WINDOWS\*.*'</font>, <font color="#0000ff">'1'</font><br /><br /><font color="#808080">rem Dateiauswahl erm&ouml;glichen mit LISTBOX</font><br /><font color="#000080">[ListBox_Width]</font> = <font color="#0000ff">'300'</font><br /><font color="#000080">[ListBox_Height]</font> = <font color="#0000ff">'500'</font><br /><font color="#000080">[ListBox_MultiSel]</font> = <font color="#0000ff">'0'</font><br /><font color="#000080">[ListBox_Ok]</font> = <font color="#0000ff">'Ausw&auml;hlen!'</font><br />listbox <font color="#000080">[auswahl]</font> = <font color="#0000ff">'Bitte Datei w&auml;hlen:'</font>, <font color="#000080">[dateiliste]</font><br /><br /><b>if</b> <font color="#000080">[auswahl]</font> = <font color="#0000ff">''</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Kein Element ausgew&auml;hlt!'</font><br /><b>else</b><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Gew&auml;hlte Datei(en): '</font> # <font color="#000080">[auswahl]</font><br /><b>endif</b><br /><b>end</b></div><!-- code END-->Neben der LISTBOX bietet RapidBATCH seit der Version 5.0 nun auch eine neue, professionelle Men&uuml;-Auswahlm&ouml;glichkeit: Den TRAYMENU-Dialog! TRAYMENU erm&ouml;glicht das Anzeigen eines so genannten Traybar-Men&uuml;s in der Windows-Taskleiste. Der &quot;Dialog&quot; selbst wird durch ein kleines Icon repr&auml;sentiert, wobei man das Men&uuml; mit einem Rechtsklick auf das Icon anzeigen kann. Mit dieser M&ouml;glichkeit kann man beispielsweise ein Script entwickeln, welches permanent im Hintergrund l&auml;uft, aber mittels Auswahl von Programmfunktionen oder durch Klicken des Icons eine Aktion ausl&ouml;sen kann.<br /><div class="image">	<img src="img/traymenu_tooltip.gif" alt="Bild eines TRAYMENU-Icons mit Tooltip" alt="TRAYMENU-Dialog mit Tooltip" />	&nbsp;	<img src="img/traymenu_open.gif" alt="Bild eines TRAYMENU-Icons mit ge&ouml;ffnetem Men&uuml;" alt="TRAYMENU-Dialog mit ge&ouml;ffnetem Men&uuml;" /><br />	Einfache aber effektive Auswahl- und Men&uuml;programmierung mit dem TRAYMENU-Men&uuml;dialog</div>Im Grunde genommen wird TRAYMENU genauso verwendet wie die LISTBOX. Man &uuml;bergibt einen Titel (der als Tooltip angezeigt wird, wenn der Benutzer mit der Maus &uuml;ber das Icon f&auml;hrt) und eine Liste an Men&uuml;-Eintr&auml;gen, getrennt durch Pipe-Zeichen (diese kann auch leer sein, dann wird gar kein Men&uuml; erzeugt). Klickt der Benutzer nun auf das Icon des Tray-Men&uuml;s, so liefert die Funktion einen Leerstring zur&uuml;ck; Andernfalls, wenn der Benutzer einen Eintrag aus dem Men&uuml; ausw&auml;hlt, wird der entsprechende Men&uuml;-String zur&uuml;ckgeliefert.<br /><br /><!-- code BEGIN --><div class="code">traymenu <font color="#000080">[eintrag]</font> = <font color="#0000ff">'Bitte w&auml;hlen Sie einen Eintrag aus...'</font>, <font color="#0000ff">'Eintrag 1|Eintrag 2|Eintrag 3'</font><br /><br /><b>if</b> <font color="#000080">[eintrag]</font> ! <font color="#0000ff">''</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Der gew&auml;hlte Men&uuml;punkt lautet: '</font> # <font color="#000080">[eintrag]</font><br /><b>else</b><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Das Icon wurde angeklickt.'</font><br /><b>endif</b><br /><b>end</b></div><!-- code END-->Um ein Men&uuml; professionell mit Shortcuts auszustatten, kann man auch einen Buchstaben jedes Eintrags mit einem &amp;-Zeichen versehen. Dies weist RapidBATCH an, den nachfolgenden Buchstaben zu unterstreichen, so dass dieser als Shortcut fungiert (wenn das Men&uuml; nun offen ist l&auml;sst sich mit diesem Shortcut ein Eintrag durch Tastatureingabe ausw&auml;hlen). Beispiel:<br /><br /><!-- code BEGIN --><div class="code">traymenu <font color="#000080">[eintrag]</font> = <font color="#0000ff">'Bitte w&auml;hlen Sie einen Eintrag aus...'</font>, <font color="#0000ff">'Eintrag &1|Eintrag &2|Eintrag &3'</font></div><!-- code END-->Jetzt kann man die einzelnen Eintr&auml;ge mit 1, 2 oder 3 auch &uuml;ber die Tastatur ausw&auml;hlen. Um ein &-Zeichen im Men&uuml; auszugeben schreibt man einfach stattdessen "&&", z.B.<br /><br /><!-- code BEGIN --><div class="code">traymenu <font color="#000080">[test]</font> = <font color="#0000ff">'Ein Test'</font>, <font color="#0000ff">'Hello && World'</font></div><!-- code END-->&Uuml;brigens: das &amp-Zeichen wird, wenn ein Eintrag ausgew&auml;hlt wurde, wieder mit &uuml;bergeben, daher bitte auch in Bedingungen auf den Returnwert von TRAYMENU abpr&uuml;fen!<br />Um eine Trennlinie in das Men&uuml; einzubauen (z.B. um viele Men&uuml;eintr&auml;ge in kleine Gruppen zu trennen), schreibt man einfach einen einzelnen Bindestrich als Men&uuml;eintrag. Beispiel:<br /><br /><!-- code BEGIN --><div class="code">traymenu <font color="#000080">[eintrag]</font> = <font color="#0000ff">'Bitte w&auml;hlen Sie einen Eintrag aus...'</font>, <font color="#0000ff">'Eintrag &1|Eintrag &2|Eintrag &3|-|B&eenden'</font></div><!-- code END-->TRAYMENU verwendet als Icon immer das Standard-Icon der Applikation. Bei interpretierten Scripts ist dies immer das Icon des RapidBATCH-Interpreters, bei compilierten Scripts das entsprechend hinzugelinkte Programmicon.<br />Mit Hilfe der vordeklarierten Variablen [app_icon] l&auml;sst sich allerdings auch eine externe ICO-Datei als Icon benutzen. [app_icon] setzt dabei ein Icon, das f&uuml;r alle Fenster der Anwendung gilt, d.h. es l&auml;sst sich hier&uuml;ber auch das Icon, welches bei LISTBOX, INFOBOX, EDITBOX und INPUTBOX links oben erscheint, mit &auml;ndern. Wird [app_icon] auf einen Leerstring gesetzt, wird automatisch das Standard-Icon der Anwendung wieder benutzt.<br /><br />Beispiel:<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem TRAYMENU unter Verwendung eines individuellen Programm-Icons</font><br /><font color="#000080">[app_icon]</font> = <font color="#0000ff">'..\icons\orca1.ico'</font><br />traymenu <font color="#000080">[eintrag]</font> = <font color="#0000ff">'Bitte w&auml;hlen Sie einen Eintrag aus...'</font>, <font color="#0000ff">'Eintrag &1|Eintrag &2|Eintrag &3|-|B&eenden'</font><br /><br /><b>if</b> <font color="#000080">[eintrag]</font> ! <font color="#0000ff">''</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Der gew&auml;hlte Men&uuml;punkt lautet: '</font> # <font color="#000080">[eintrag]</font><br /><b>else</b><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Das Icon wurde angeklickt.'</font><br /><b>endif</b><br /><b>end</b></div><!-- code END--><br /><br />

		<div class="line">&nbsp;</div>

		<div id="copyright">
			Copyright &copy; 2000-2006 by J.M.K S.F. Software Technologies, Jan Max Meyer<br />
			All rights reserved.
		</div>
	</body>
</html>
