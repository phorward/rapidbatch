<html>
	<head>
		<title>Datei- und Verzeichnisauswahl</title>
		<link rel="stylesheet" href="jmksf.css" type="text/css"></link>
	</head>

	<body>
		<div id="top">
			<img src="rb5.png" alt="RapidBATCH Logo" />
			Datei- und Verzeichnisauswahl
		</div>
		
		<div class="line">&nbsp;</div>
		
		Nicht selten kommt es vor, dass man Datei- oder Verzeichnispfade vom Benutzer abfragen muss. Der Einsatz einer INPUTBOX w&auml;re hier zwar auch m&ouml;glich, aber unangebracht. Zur L&ouml;sung dieses Problems stellt RapidBATCH drei Dialoge zur Verf&uuml;gung: OPENBOX, SAVEBOX und FOLDERBOX!<br /><br />Die Dialoge OPENBOX und SAVEBOX erm&ouml;glichen die Eingabe eines Dateinamens sowie das Browsen durch Verzeichnisse. Des weiteren kann ein Dateifilter gesetzt werden, der nur bestimmte Dateitypen zur Anzeige bringt.Der einzige Unterschied zwischen OPENBOX und SAVEBOX besteht darin, dass eine OPENBOX einen &quot;Datei &ouml;ffnen&quot;-Dialog bereitstellt, w&auml;rend eine SAVEBOX einen &quot;Datei speichern&quot;-Dialog anzeigt.<br /><br />Folgendes Beispiel zeigt die Verwendung der OPENBOX zur Auswahl einer Datei.<br /><br /><!-- code BEGIN --><div class="code">openbox <font color="#000080">[datei]</font> = <font color="#0000ff">'Bitte w&auml;hlen Sie eine Datei aus:'</font>, <font color="#0000ff">'Alle Dateien|*.*'</font><br />echo <font color="#0000ff">'Der Pfad zur gew&auml;hlten Datei lautet: '</font> # <font color="#000080">[datei]</font><br /><b>end</b></div><!-- code END--><div class="image"><img src="img/openbox.gif" alt="Bild eines OPENBOX-Dialogs" title="OPENBOX-Dialog" /><br />Die OPENBOX-Funktion stellt einen &quot;Datei &ouml;ffnen&quot;-Dialog zur Verf&uuml;gung</div>Die OPENBOX-Funktion (alle Parameter sind hierbei identisch f&uuml;r die SAVEBOX) ben&ouml;tigt neben der R&uuml;ckgabevariable einen Dialog-Titel (oder einen Aufforderungstext) und den bereits angesprochenen Dateifilter.<br />Dieser Dateifilter kann sehr individuell gestaltet werden und erm&ouml;glicht den Einsatz der Wildcard-Platzhalter * und ?.<br />&Uuml;bergeben wird der Dateifilter als Liste &auml;hnlich wie bei LISTBOX oder TRAYMENU, nur dass hier nach folgendem Muster vorgegangen werden muss:<br /><br /><b>Filterbezeichnung | Filter</b><br /><br />Obiges Beispiel legt als einen Filter *.* (alle Dateinamen, die eine Dateiendung haben) an und benennt ihn mit &quot;Alle Dateien&quot;.Wenn wir nun alle Textdateien (Dateienung: TXT) filtern m&ouml;chten, verwenden wir folgenden Filter:<br /><br /><b>Textdateien|*.txt</b><br /><br />Die OPENBOX erm&ouml;glich dem Benutzer auch die Auswahl eines Filters, falls mehrere gegeben sind. Man kann also einfach einen weiteren Filter an einen bereits vorhandenen dranh&auml;ngen, indem man das obige Muster einfach durch ein weiteres Pipe-Listentrennzeichen vom vorhergehenden Filter trennt. Folgendes beispiel legt drei Filter an.<br /><br /><b>EXE-Dateien|*.exe|COM-Dateien|*.com|Batch-Dateien|*.bat</b><br /><br />Es lassen sich auch mehrere Filtermasken unter einem einzelnen Filternamen speichern. Hierbei trennt man jeden Filter durch ein Semikolon. Folgender Filter erm&ouml;glich die Anzeiger aller Dateien oder nur die Anzeige von ausf&uuml;hrbaren Programmdateien (EXE, COM, BAT):<br /><br /><b>Ausf&uuml;hrbare Programme|*.exe;*.com;*.bat|Alle Dateien|*.*</b><br /><br />Standardm&auml;ssig l&auml;sst sich in einem OPENBOX- bzw. SAVEBOX-Dialog nur eine einzelne Datei anw&auml;hlen. Eine Mehrfach-Auswahl ist jedoch auch ohne Probleme m&ouml;glich, indem man f&uuml;r die OPENBOX die Variable [OpenBox_MultiSel] auf den Wert '0' setzt (&auml;quivalent [SaveBox_MultiSel] f&uuml;r die SAVEBOX). Ist diese Variable auf dem Wert '0', so lassen sich mehrere Dateinamen aus der Dateiliste ausw&auml;hlen. Best&auml;tigt der Benutzer nun seine Eingabe mit OK, gibt der Dialog eine Liste der Dateinamen- und Pfade, jeweils getrennt durch Pipe-Zeichen, zur&uuml;ck, wobei als erstes Listenelement der absolute Pfad zu den Dateien angegeben wird und in den darauf folgenden Elementen die einzelnen Dateiamen (ohne den Pfad).<br /><br />Folgendes Beispiel zeigt, wie man eine Mehrfach-Dateiauswahl verarbeitet.<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem Mehrfachauswahl erm&ouml;glichen</font><br /><font color="#000080">[OpenBox_MultiSel]</font> = <font color="#0000ff">'0'</font><br /><br /><font color="#808080">rem Dateien ausw&auml;hlen</font><br />openbox <font color="#000080">[dateiliste]</font> = <font color="#0000ff">'Dateinamen ausw&auml;hlen'</font>, <font color="#0000ff">'Alle Dateien|*.*'</font><br /><br /><b>if</b> <font color="#000080">[dateiliste]</font> ! <font color="#0000ff">''</font><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem Pfad auslesen</font><br />&nbsp;&nbsp;&nbsp;&nbsp;gettok <font color="#000080">[pfad]</font> = <font color="#000080">[dateiliste]</font>, <font color="#0000ff">'|'</font>, <font color="#0000ff">'1'</font><br /><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem Dateiliste auslesen</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[i]</font> = <font color="#0000ff">'1'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>repeat</b><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[i]</font> + <font color="#0000ff">'1'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gettok <font color="#000080">[datei]</font> = <font color="#000080">[dateiliste]</font>, <font color="#0000ff">'|'</font>, <font color="#000080">[i]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[datei]</font> ! <font color="#0000ff">''</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Datei Nr. '</font> # (<font color="#000080">[i]</font> - <font color="#0000ff">'1'</font>) # <font color="#0000ff">': '</font> # <font color="#000080">[pfad]</font> # <font color="#0000ff">'\'</font> # <font color="#000080">[datei]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>elseif</b> <font color="#000080">[datei]</font> = <font color="#0000ff">''</font> & <font color="#000080">[i]</font> = <font color="#0000ff">'2'</font><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rem Wenn nur eine Datei ausgew&auml;hlt wurde, steht ihr Name</font><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rem und Pfad in [pfad]...</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Einzige gew&auml;hlte Datei: '</font> # <font color="#000080">[pfad]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>endif</b><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>until</b> <font color="#000080">[datei]</font> = <font color="#0000ff">''</font><br /><b>endif</b><br /><b>end</b></div><!-- code END--><div class="image"><img src="img/openbox_multisel.gif" alt="Auswahl von mehreren Dateien im OPENBOX-Dialog" title="OPENBOX-Dialog mit Mehrfach-Dateiauswahl" /><br />Mehrfach-Auswahl in einem &quot;Datei &ouml;ffnen&quot;-Dialog</div>Wird [OpenBox_MultiSel] bzw. [SaveBox_MultiSel] wieder auf den Wert '-1' gesetzt, ist wieder nur eine Einfach-Auswahl mit dem jeweiligen Dialogfenster m&ouml;glich.<br /><br />Bei vielen Anwendungen will man auch auf den Komfort nicht verzichten, einfach einen Dateinamen ohne Dateinamenserweiterung in &quot;Datei &ouml;ffnen&quot;- und &quot;Datei speichern&quot;-Dialog einzugeben. Die Dateinamenserweiterung soll dabei automatisch an den eingegebenen Dateinamen angeh&auml;ngt werden. Um dies zu erm&ouml;glichen, kann man eine Standard-Erweiterung f&uuml;r Dateinamen in der Variablen [OpenBox_DefFileExt] bzw. [SaveBox_DefFileExt] auf eine beliebige Dateinamenserweiterung (OHNE den Punkt!) setzen:<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem Standarderweiterung: TXT-Datei</font><br /><font color="#000080">[SaveBox_DefFileExt]</font> = <font color="#0000ff">'txt'</font><br /><br /><font color="#808080">rem Dateinamen abfragen</font><br />savebox <font color="#000080">[dateiname]</font> = <font color="#0000ff">'Datei speichern als...'</font>, <font color="#0000ff">'Textdateien|*.txt'</font><br /><br />echo <font color="#0000ff">'Eingegebener Dateiname mit Erweiterung: '</font> # <font color="#000080">[dateiname]</font><br /><b>end</b></div><!-- code END--><div class="image"><img src="img/folderbox.gif" alt="Bequemes Ausw&auml;hlen eines Verzeichnisses mit der FOLDERBOX." title="FOLDERBOX-Dialog zur Verzeichnisauswahl" /><br />Bequeme Verzeichnisauswahl mit dem &quot;Ordner suchen&quot;-Dialog der FOLDERBOX-Funktion</div>Neben OPENBOX und SAVEBOX bietet RapidBATCH auch einen Dialog zur Auswahl von Verzeichnissen an: Die FOLDERBOX! Parameter sind hierbei ein Aufforderungstext sowie ein optionaler Basis-Pfad, der automatisch im Dialog angew&auml;hlt wird.<br />Folgendes Script zeigt das Windows-Verzeichnis in einem Verzeichnis-Auswahldialog an:<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem Verzeichnisauswahl</font><br />folderbox <font color="#000080">[verzeichnis]</font> = <font color="#0000ff">'Bitte w&auml;hlen Sie ein Verzeichnis:'</font>, <font color="#000080">[windir]</font><br /><br /><font color="#808080">rem Ausgabe des Verzeichnispfades, falls dieses gew&auml;hlt wurde</font><br /><b>if</b> <font color="#000080">[verzeichnis]</font> ! <font color="#0000ff">''</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Pfad zum gew&auml;hlten Verzeichnis: '</font> # <font color="#000080">[verzeichnis]</font><br /><b>else</b><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Sie haben kein Verzeichnis ausgew&auml;hlt!'</font><br /><b>endif</b><br /><b>end</b></div><!-- code END-->Wird hier der Abbrechen- oder Schlieﬂen-Button des Dialogs gew&auml;hlt, gibt die Funktion einen Leerstring zur&uuml;ck.<br /><br />

		<div class="line">&nbsp;</div>

		<div id="copyright">
			Copyright &copy; 2000-2006 by J.M.K S.F. Software Technologies, Jan Max Meyer<br />
			All rights reserved.
		</div>
	</body>
</html>
