<html>
	<head>
		<title>Entwicklung einer Beispielanwendung</title>
		<link rel="stylesheet" href="jmksf.css" type="text/css"></link>
	</head>

	<body>
		<div id="top">
			<img src="rb5.png" alt="RapidBATCH Logo" />
			Entwicklung einer Beispielanwendung
		</div>
		
		<div class="line">&nbsp;</div>
		
		Um einmal die Implementierung einer kleinen, kompletten Anwendung, welche mit einem benutzerdefinierten Dialogfenster arbeitet, zu demonstieren, werden wir in diesem Kapitel einen Zahlensysteme-Rechner programmieren. Dieser &quot;Bin/Okt/Hex Umrechner&quot;, wie ich ihn nenne, soll Dezimalzahlen in Bin&auml;rzahlen, Oktalzahlen und Hexadezimalzahlen und umgekehrt umrechnen k&ouml;nnen.<br /><br />Zur Berechnung der Zahlensysteme verwenden wir die Funktionen &quot;base_to_decimal&quot; und &quot;decimal_to_base&quot; aus der Bibliothek MATH.RB, da der Hauptschwerpunkt dieses Beispiels nicht beim Umrechnen der Zahlen, sondern beim Umgang mit den Dialogwidgets liegt.<br /><br />Vorab aber trotzdem ein wenig Theorie am Beispiel der Umrechnung vom Dezimalzahlensystem in das Bin&auml;rzahlensystem. Das Dezimalzahlensystem verwenden wir in unserem t&auml;glichen Gebrauch von Zahlen. Dezimalzahlen bestehen daher aus Ziffernfolgen von 0-9, sind also zur Basis 10 gehalten. Das Bin&auml;rzahlensystem kennt nur zwei Ziffern, 0 und 1, und ist zur Basis 2 gehalten (daher auch manchmal der Begriff &quot;Dualzahlensystem&quot;). Auf niederigster Ebene besteht jedes Programm, jedes Zeichen und jeder Wert, der mit oder von einem Computer verarbeitet wird, aus Millionen solcher Folgen wie z.B. &quot;10011010010&quot;, was in dezimaler Schreibweise dem Wert &quot;1234&quot; entspricht. Errechnen l&auml;sst sich dieser bin&auml;re Wert recht simpel, indem man den Ausgangswert 1234 jeweils durch die Basis des Zahlensystems teilt, bei Dualzahlen jeweils durch 2. Erh&auml;lt man einen Restwert mit Nachkommastelle, so wird eine 1 als Ziffer gesetzt, andernfalls eine 0. Kommt letztendlich als Restwert 0 heraus, ist die Zahl vollst&auml;ndig ins andere Zahlensystem &uuml;bertragen (nachdem man sie noch einmal umgedreht hat (da die berechnete Zahl von rechts nach links aufgebaut wird)).<br /><br />Unser Konvertierungsprogramm soll nun wie folgt aufgebaut werden: Ein Dialogfenster mit zwei Eingabefeldern, wobei das obere f&uuml;r die Aus- und Eingabe von Dezimalzahlen und das untere f&uuml;r die Aus- und Eingabe von Zahlen im jeweiligem Zahlensystem verwendet wird. In welches Zahlensystem umgerechnet wird, wird &uuml;ber ein Men&uuml; im Dialogfenster festgelegt, bei dem der jeweils aktuelle Umrechnungsmodus mit einem H&auml;ckchen markiert wird. Hier kann der Benutzer den Umrechnungsmodus wechseln. Das Programm soll jeweils vom Dezimal- ins eingestellte Zahlensystem als auch vom eingestellten Zahlensystem ins Dezimalsystem konvertieren k&ouml;nnen. Die Konvertierung soll &quot;live&quot; bereits w&auml;hrend der Eingabe automatisch im jeweils umgekehrten Eingabefeld durchgef&uuml;hrt werden.<br /><br />Diese ganzen Anforderungen an unser Programm stellen aber mit RapidBATCH gar kein Problem dar. In nicht mehr als 10 Minuten und einer Scriptl&auml;nge von etwa 120 Zeilen (inklusive entsprechender Kommentare und Leerzeilen) ist das komplette Programm fertig und lauff&auml;hig, wenn man bereits die entsprechende Erfahrung hat.<br /><br />Im ersten Schritt bei der Entwicklung dieses Scripts entwerfen wir einen Prototypen. Ein Prototyp ist eine programmierte und lauff&auml;hige Version der Eingabemaske, jedoch ohne jegliche Funktionalit&auml;t. Solch ein Prototyp ist auch eine bew&auml;hrte Methode, die Widgets auf dem Fenster so anzuordnen, dass die Oberfl&auml;che auch ergonomisch und einheitlich aussieht.<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem **************************************</font><br /><font color="#808080">rem ** Prototyp &quot;Bin/Okt/Hex Umrechner&quot; **</font><br /><font color="#808080">rem **************************************</font><br /><br /><font color="#808080">rem --- Erzeugen und Aufsetzen des Hauptfensters ---</font><br />newdialog <font color="#0000ff">'umrechner'</font>, <font color="#0000ff">'dialog'</font>, <font color="#0000ff">'1|1|270|100'</font><br /><br /><font color="#808080">rem Fenstertitel und Style setzen</font><br />letdialog <font color="#0000ff">'umrechner'</font>, <font color="#0000ff">'caption'</font>, <font color="#0000ff">'Bin/Okt/Hex Umrechner'</font><br />letdialog <font color="#0000ff">'umrechner'</font>, <font color="#0000ff">'style'</font>, <font color="#0000ff">'single'</font><br /><br /><font color="#808080">rem Men&uuml;baum erzeugen</font><br /><font color="#000080">[men&uuml;]</font> # <font color="#0000ff">'&Modus:Dezimal -&gt; &Bin&auml;r|Dezimal -&gt; &Oktal|Dezimal -&gt; &Hexadezimal;;'</font><br />letdialog <font color="#0000ff">'umrechner'</font>, <font color="#0000ff">'menu'</font>, <font color="#000080">[men&uuml;]</font><br /><br /><font color="#808080">rem --- Erzeugung von Eingabefeldern und Labels ---</font><br /><br /><font color="#808080">rem Label und Eingabefeld f&uuml;r Dezimalzahl</font><br />newdialog <font color="#0000ff">'umrechner:l_dezimal'</font>, <font color="#0000ff">'label'</font>, <font color="#0000ff">'5|8|100|22'</font><br />letdialog <font color="#0000ff">'umrechner:l_dezimal'</font>, <font color="#0000ff">'caption'</font>, <font color="#0000ff">'Dezimalwert:'</font><br />newdialog <font color="#0000ff">'umrechner:dezimal'</font>, <font color="#0000ff">'input'</font>, <font color="#0000ff">'110|4|150|25'</font><br />letdialog <font color="#0000ff">'umrechner:dezimal'</font>, <font color="#0000ff">'font'</font>, <font color="#0000ff">'Sans Serif|10|2'</font><br /><br /><font color="#808080">rem Label und Eingabefeld f&uuml;r Zahl des jew. Zahlensystems</font><br />newdialog <font color="#0000ff">'umrechner:l_konvert'</font>, <font color="#0000ff">'label'</font>, <font color="#0000ff">'5|34|100|22'</font><br />letdialog <font color="#0000ff">'umrechner:l_konvert'</font>, <font color="#0000ff">'caption'</font>, <font color="#0000ff">'Bin&auml;rwert:'</font><br />newdialog <font color="#0000ff">'umrechner:konvert'</font>, <font color="#0000ff">'input'</font>, <font color="#0000ff">'110|30|150|25'</font><br />letdialog <font color="#0000ff">'umrechner:konvert'</font>, <font color="#0000ff">'font'</font>, <font color="#0000ff">'Sans Serif|10|2'</font><br /><br /><font color="#808080">rem Fenster sichtbar machen</font><br />letdialog <font color="#0000ff">'umrechner'</font>, <font color="#0000ff">'visible'</font>, <font color="#000080">[true]</font><br /><br /><font color="#808080">rem Warten auf Ereignis (ohne Ereignisbehandlung)</font><br />rundialog <font color="#000080">[null]</font> = <font color="#0000ff">'0'</font><br /><b>end</b></div><!-- code END--><div class="image"><img src="img/conv_proto.gif" alt="Prototyp des Zahlensystemekonverters" title="Screenshot" /><br />Der bereits lauff&auml;hige Prototyp unseres Bin/Okt/Hex Umrechners</div>Wir werden nun Schritt-f&uuml;r-Schritt die einzelnen Abschnitte, in die der Prototyp eingeteilt ist, durchgehen.<br /><br />Zuerst wird das Dialog-Basisfenster erzeugt mit eine Gr&ouml;ﬂe von 270x100 Pixel. In den darauf folgenden LETDIALOG-Anweisungen wird zuerst der Fenstertitel und anschlieﬂend ein so genannter Style, in unserem Fall der Style &quot;SINGLE&quot; f&uuml;r das Fenster gesetzt. Dieser Style &auml;ndert das Aussehen des Fensters, so dass kein Maximieren-Button mehr in der rechten oberen Ecke gegeben ist (da eine Maximierung des Fensters bei diesem kleinen Programm keinen Sinn ergibt). Andere Stylewerte k&ouml;nnen Sie der RapidBATCH-Sprachreferenz entnehmen.<br /><br />Nachdem das Fensterstyle gesetzt wurde, weisen wir dem Fenster noch ein Men&uuml; zu. Dieses Men&uuml; wird als so genannter &quot;Menu-Descriptor&quot; &uuml;bergeben. Dieser Descriptor definiert das Men&uuml; in einer einfachen Definitionssprache. In unserem Fall wird ein Hauptmen&uuml; &quot;Modus&quot; mit drei Untermen&uuml;punkten (&quot;Dezimal -> Bin&auml;r&quot;, &quot;Dezimal -> Oktal&quot; und &quot;Dezimal -> Hexadezimal&quot;) erzeugt. Mehr Informationen zum MENU-Attribut von LETDIALOG k&ouml;nnen Sie ebenfalls der Sprachreferenz entnehmen.<br /><br />Im zweiten Abschnitt des Scripts erzeugen wir vier weitere Widgets, jeweils zwei Eingabefelder und zwei statische Texte, welche als Bezeichnungsfelder vor den Eingabefeldern angezeigt werden. F&uuml;r die Eingabefelder setzen wir durch Verwendung des FONT-Attributes &uuml;ber LETDIALOG eine alternative Schriftart, hier &quot;Sans Serif&quot;, 10 Punkt, Fett.<br /><br /><br />Auf Basis dieses Prototypen implementieren wir nun die Funktionalit&auml;ten zu unserem Programm.<br /><br />Als erstes importieren wir die RapidBATCH Bibliotheken MATH.RB, welche die Konvertierungsfunktionen &quot;decimal_to_base&quot; und &quot;base_to_decimal&quot; bereitstellt, sowie die DIALOG.RB, welche ein paar n&uuml;tzliche Prozeduren beinhaltet, wie z.B. die Prozedur &quot;centerdialog&quot;, die ein Dialogfenster auf dem Bildschirm zentriert. Das Importieren der Bibliotheken erfolgt als aller erstes im Programm mit Hilfe der INCLUDE-Anweisung.<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem --- Importieren von Bibliotheks-Hilfsfunktionen ---</font><br /><font color="#008000">include 'math.rb'</font><br /><font color="#008000">include 'dialog.rb'</font></div><!-- code END-->Da die Funktionen decimal_to_base und base_to_decimal jeweils als zweiten Parameter einen String mit allen Ziffern des jeweiligen Zahlensystems erwarten (wobei die Anzahl der Ziffern gleichzeitig die Basis des Zahlensystems, in welches umgerechnet werden soll, definiert), deklarieren und f&uuml;llen wir ebenfalls am Anfang unseres Prototypen-Programms entsprechende Variablen, die jeweils die Ziffern aller drei Zahlensysteme (Bin&auml;r &quot;01&quot;, Oktal &quot;01234567&quot; und Hexadezimal &quot;0123456789ABCDEF&quot;) beinhalten. Eine Variable [aktuelle_basis] verwenden wir sp&auml;ter, um die jeweils aktuell umzurechnende Basis f&uuml;r das Umrechnungsprogramm zu setzen.<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem --- Globale Variablen (Basen und Ziffern der Zahlensysteme) ---</font><br /><b>dec</b> <font color="#000080">[bin]</font>, <font color="#000080">[okt]</font>, <font color="#000080">[hex]</font>, <font color="#000080">[aktuelle_basis]</font><br /><br /><font color="#808080">rem Basis: 2 (Bin&auml;rsystem)</font><br /><font color="#000080">[bin]</font> = <font color="#0000ff">'01'</font><br /><font color="#808080">rem Basis: 8 (Oktalsystem)</font><br /><font color="#000080">[okt]</font> = <font color="#0000ff">'01234567'</font><br /><font color="#808080">rem Basis: 16 (Hexadezimalsystem)</font><br /><font color="#000080">[hex]</font> = <font color="#0000ff">'0123456789ABCDEF'</font></div><!-- code END-->Bevor wir nun eine entsprechende Ereignisbehandlung f&uuml;r das Men&uuml; sowie die Eingabe und Umrechnung der Werte implementieren, programmieren wir zuerst zwei Prozeduren, um die Werte jeweils von Dezimal in das entsprechende Konvertierungssystem oder vom Konvertierungssystem in Dezimal umzurechnen. Der Einfachheit halber heiﬂen diese Prozeduren berechne_Zielwert und berechne_Dezimalwert. Im Falle eines Fehlers (z.B. wenn eine ung&uuml;ltige Ziffer gefunden wurde) geben beide Umrechnungsfunktionen (base_to_decimal, decimal_to_base) den Wert '-1' zur&uuml;ck. Hier schreiben wir in das jeweilige Feld den Wert &quot;Fehleingabe&quot;, um den Benutzer zu informieren, dass er einen ung&uuml;ltigen Wert umzurechnen versucht.<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem --- Implementation der Prozedur "berechne_Zielwert" ---</font><br /><b>proc</b> berechne_Zielwert<br />&nbsp;&nbsp;&nbsp;&nbsp;<b>dec</b> <font color="#000080">[dezimal]</font>, <font color="#000080">[konvert]</font><br /><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem Zahlensystemwert aus Dezimalwert errechnen</font><br />&nbsp;&nbsp;&nbsp;&nbsp;getdialog <font color="#000080">[dezimal]</font> = <font color="#0000ff">'umrechner:dezimal'</font>, <font color="#0000ff">'text'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[dezimal]</font> ! <font color="#0000ff">''</font><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rem Wert berechnen (mit der decimal_to_base-Bibliotheksfunktion)</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decimal_to_base <font color="#000080">[konvert]</font> = <font color="#000080">[dezimal]</font>, <font color="#000080">[aktuelle_basis]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[konvert]</font> = <font color="#0000ff">'-1'</font> <font color="#000080">[konvert]</font> = <font color="#0000ff">'Fehleingabe'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>endif</b><br />&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'umrechner:konvert'</font>, <font color="#0000ff">'text'</font>, <font color="#000080">[konvert]</font><br /><b>endproc</b><br /><br /><font color="#808080">rem --- Implementation der Prozedur "berechne_Dezimalwert" ---</font><br /><b>proc</b> berechne_Dezimalwert<br />&nbsp;&nbsp;&nbsp;&nbsp;<b>dec</b> <font color="#000080">[dezimal]</font>, <font color="#000080">[konvert]</font><br /><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem Dezimalwert aus Zahlensystemwert errechnen</font><br />&nbsp;&nbsp;&nbsp;&nbsp;getdialog <font color="#000080">[konvert]</font> = <font color="#0000ff">'umrechner:konvert'</font>, <font color="#0000ff">'text'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[konvert]</font> ! <font color="#0000ff">''</font><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rem Wert berechnen (mit der base_to_decimal-Bibliotheksfunktion)</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base_to_decimal <font color="#000080">[dezimal]</font> = <font color="#000080">[konvert]</font>, <font color="#000080">[aktuelle_basis]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[dezimal]</font> = <font color="#0000ff">'-1'</font> <font color="#000080">[dezimal]</font> = <font color="#0000ff">'Fehleingabe'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>endif</b><br />&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'umrechner:dezimal'</font>, <font color="#0000ff">'text'</font>, <font color="#000080">[dezimal]</font><br /><b>endproc</b></div><!-- code END-->Bevor wir uns auch noch die M&uuml;he machen und sp&auml;ter in der Ereignisbehandlung drei mal dasselbe (f&uuml;r jeden Umrechnungsfall, den man im Men&uuml; setzen kann) programmieren, entwickeln wir noch eine weitere Prozedur setze_Zahlensystem, der wir als Parameter eine der drei Zahlensystemdefinitionen, die wir zuvor in einer der Variablen gespeichert haben, zuweisen. Diese Prozedur entfernt zugleich alle H&auml;ckchen aus dem Men&uuml; und setzt anschlieﬂend f&uuml;r den jeweils korrekten Men&uuml;punkt das H&auml;ckchen erneut. Das Setzen eines H&auml;ckchens f&uuml;r einen Men&uuml;punkt erfolgt &uuml;ber das bei der Men&uuml;zuweisung automatisch generierte Men&uuml;label, welches im Format &quot;<i>Dialogname</i>:Menu_<i>Men&uuml;punkttext</i>&quot; generiert wird, und dem CHECKED-Attribut, welches auf [true] ('0') oder [false] ('-1') gesetzt werden kann.<br />Am Ende der Prozedur rufen wir direkt nochmal die oben implementierte Prozedur berechne_Zielwert auf, um direkt beim Ausw&auml;hlen eines Men&uuml;punktes die Zahl, die im Dezimalfeld steht, in das ausgew&auml;hlte Zahlensystem umzurechnen.<br />Ausserdem setzen wir vorher noch die vorhin definierte Variable [aktuelle_basis], die wiederum von berechne_Zielwert und berechne_Dezimalwert verwendet wird, auf das entsprechend &uuml;bergebene Zahlensystem.<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem --- Implementation der Prozedur "setze_Zahlensystem" ---</font><br /><b>proc</b> setze_Zahlensystem: <font color="#000080">[zahlensystem]</font><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem H&auml;ckchen aus Men&uuml;punkten entfernen</font><br />&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'umrechner:Menu_Dezimal -&gt; &Oktal'</font>, <font color="#0000ff">'checked'</font>, <font color="#000080">[false]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'umrechner:Menu_Dezimal -&gt; &Hexadezimal'</font>, <font color="#0000ff">'checked'</font>, <font color="#000080">[false]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'umrechner:Menu_Dezimal -&gt; &Bin&auml;r'</font>, <font color="#0000ff">'checked'</font>, <font color="#000080">[false]</font><br /><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem Zahlensystembezeichnung vor dem Eingabefeld sowie H&auml;ckchen im Men&uuml; setzen</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[zahlensystem]</font> = <font color="#000080">[bin]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'umrechner:l_konvert'</font>, <font color="#0000ff">'caption'</font>, <font color="#0000ff">'Bin&auml;rwert:'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'umrechner:Menu_Dezimal -&gt; &Bin&auml;r'</font>, <font color="#0000ff">'checked'</font>, <font color="#000080">[true]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>elseif</b> <font color="#000080">[zahlensystem]</font> = <font color="#000080">[okt]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'umrechner:l_konvert'</font>, <font color="#0000ff">'caption'</font>, <font color="#0000ff">'Oktalwert:'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'umrechner:Menu_Dezimal -&gt; &Oktal'</font>, <font color="#0000ff">'checked'</font>, <font color="#000080">[true]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>elseif</b> <font color="#000080">[zahlensystem]</font> = <font color="#000080">[hex]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'umrechner:l_konvert'</font>, <font color="#0000ff">'caption'</font>, <font color="#0000ff">'Hexadezimalwert:'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'umrechner:Menu_Dezimal -&gt; &Hexadezimal'</font>, <font color="#0000ff">'checked'</font>, <font color="#000080">[true]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>endif</b><br /><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem Aktuelle Basis auf &uuml;bergebenes Zahlensystem setzen</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[aktuelle_basis]</font> = <font color="#000080">[zahlensystem]</font><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;berechne_Zielwert<br /><b>endproc</b></div><!-- code END-->Jetzt ist die Anwendung schon fast fertig. Was jetzt noch fehlt, ist eine Ereignisbehandlungsroutine.<br /><br />Dazu erweitern bzw. modifizieren wir den Bereich, in dem wir die Eingabefelder erzeugen, insoweit, dass wir das CHANGE-Ereignis, welches Auftritt, wenn sich irgendetwas an dem Inhalt des Eingabefeldes ver&auml;ndert hat, einschalten. Bei der Erstellung eines Widgets vom Typ INPUT ist dieses Ereignis standardm&auml;ﬂig ausgeschaltet. Einschalten k&ouml;nnen wir es, indem wir bei LETDIALOG als Attributbezeichner den Wert EVENT_CHANGE auf [true] ('0') setzen. Ein weiteres Setzen dieses Attributes auf [false] (oder '-1') bewirkt die erneute Ausschaltung des Ereignisses f&uuml;r das jeweilige Widget.<br />Nach der Erzeugung der Widgets sowie Einschaltung der CHANGE-Ereignisse rufen wir hier auch bereits einmal unsere Prozedur setze_Zahlensystem mit der Variablen [bin] als Parameter auf, um direkt als Default-Umrechnungssystem das Bin&auml;rzahlensystem zu bestimmen.<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem --- Erzeugung von Eingabefeldern und Labels ---</font><br /><br /><font color="#808080">rem Label und Eingabefeld f&uuml;r Dezimalzahl</font><br />newdialog <font color="#0000ff">'umrechner:l_dezimal'</font>, <font color="#0000ff">'label'</font>, <font color="#0000ff">'5|8|100|22'</font><br />letdialog <font color="#0000ff">'umrechner:l_dezimal'</font>, <font color="#0000ff">'caption'</font>, <font color="#0000ff">'Dezimalwert:'</font><br />newdialog <font color="#0000ff">'umrechner:dezimal'</font>, <font color="#0000ff">'input'</font>, <font color="#0000ff">'110|4|150|25'</font><br />letdialog <font color="#0000ff">'umrechner:dezimal'</font>, <font color="#0000ff">'font'</font>, <font color="#0000ff">'Sans Serif|10|2'</font><br />letdialog <font color="#0000ff">'umrechner:dezimal'</font>, <font color="#0000ff">'event_change'</font>, <font color="#000080">[true]</font><br /><br /><font color="#808080">rem Label und Eingabefeld f&uuml;r Zahl des jew. Zahlensystems</font><br />newdialog <font color="#0000ff">'umrechner:l_konvert'</font>, <font color="#0000ff">'label'</font>, <font color="#0000ff">'5|34|100|22'</font><br />newdialog <font color="#0000ff">'umrechner:konvert'</font>, <font color="#0000ff">'input'</font>, <font color="#0000ff">'110|30|150|25'</font><br />letdialog <font color="#0000ff">'umrechner:konvert'</font>, <font color="#0000ff">'font'</font>, <font color="#0000ff">'Sans Serif|10|2'</font><br />letdialog <font color="#0000ff">'umrechner:konvert'</font>, <font color="#0000ff">'event_change'</font>, <font color="#000080">[true]</font><br /><br />setze_Zahlensystem <font color="#000080">[bin]</font></div><!-- code END-->Zu guter Letzt zentrieren wir das Fenster auf dem Bildschirm (mit Hilfe der Prozedur centerdialog aus der Bibliothek DIALOG.RB), setzen den Eingabefokus beim Programmstart auf das Dezimalzahlen-Eingabefeld und bringen den Dialog zur Anzeige.<br /><br />In der Ereignisbehandlungsroutine, die wir, wie in unserem ersten Script mit selbst-definiertem Dialogfenster, als eine REPEAT...UNTIL-Schleife definieren, pr&uuml;fen wir nun die 6 Ereignisse, die mit oder auf dem Dialog ausgel&ouml;st werden k&ouml;nnen ab und rufen die entsprechenden Prozeduren auf. Bei der &Auml;nderung eines Wertes in den Eingabefeldern wird jeweils die Prozedur berechne_Zielwert oder berechne_Dezimalwert (je nachdem in welchem Feld man sich befindet) eingegeben, bei Auswahl eines Men&uuml;punktes wird die Prozedur setze_Zahlensystem mit dem entsprechenden Zahlensystem aufgerufen. Fertig ist unser selbstgeschriebener &quot;Bin/Okt/Hex Umrechner&quot;!<div class="image"><img src="img/converter.gif" alt="Der Zahlensystemekonverter in Aktion" title="Screenshot" /><br />Der Bin/Okt/Hex Umrechner ist fertig!</div>Der gesamte Quellcode:<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem *******************************************</font><br /><font color="#808080">rem ** Bin/Okt/Hex Umrechner&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**</font><br /><font color="#808080">rem ** Umrechnungsprogramm f&uuml;r Zahlensysteme **</font><br /><font color="#808080">rem *******************************************</font><br /><font color="#808080">rem ** Copyright (C) 2005 by J.M. Meyer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**</font><br /><font color="#808080">rem *******************************************</font><br /><br /><font color="#808080">rem --- Importieren von Bibliotheks-Hilfsfunktionen ---</font><br /><font color="#008000">include 'math.rb'</font><br /><font color="#008000">include 'dialog.rb'</font><br /><br /><font color="#808080">rem --- Globale Variablen (Basen und Ziffern der Zahlensysteme) ---</font><br /><b>dec</b> <font color="#000080">[bin]</font>, <font color="#000080">[okt]</font>, <font color="#000080">[hex]</font>, <font color="#000080">[aktuelle_basis]</font><br /><br /><font color="#808080">rem Basis: 2 (Bin&auml;rsystem)</font><br /><font color="#000080">[bin]</font> = <font color="#0000ff">'01'</font><br /><font color="#808080">rem Basis: 8 (Oktalsystem)</font><br /><font color="#000080">[okt]</font> = <font color="#0000ff">'01234567'</font><br /><font color="#808080">rem Basis: 16 (Hexadezimalsystem)</font><br /><font color="#000080">[hex]</font> = <font color="#0000ff">'0123456789ABCDEF'</font><br /><br /><font color="#808080">rem --- Implementation der Prozedur "berechne_Zielwert" ---</font><br /><b>proc</b> berechne_Zielwert<br />&nbsp;&nbsp;&nbsp;&nbsp;<b>dec</b> <font color="#000080">[dezimal]</font>, <font color="#000080">[konvert]</font><br /><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem Zahlensystemwert aus Dezimalwert errechnen</font><br />&nbsp;&nbsp;&nbsp;&nbsp;getdialog <font color="#000080">[dezimal]</font> = <font color="#0000ff">'umrechner:dezimal'</font>, <font color="#0000ff">'text'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[dezimal]</font> ! <font color="#0000ff">''</font><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rem Wert berechnen (mit der decimal_to_base-Bibliotheksfunktion)</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decimal_to_base <font color="#000080">[konvert]</font> = <font color="#000080">[dezimal]</font>, <font color="#000080">[aktuelle_basis]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[konvert]</font> = <font color="#0000ff">'-1'</font> <font color="#000080">[konvert]</font> = <font color="#0000ff">'Fehleingabe'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>endif</b><br />&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'umrechner:konvert'</font>, <font color="#0000ff">'text'</font>, <font color="#000080">[konvert]</font><br /><b>endproc</b><br /><br /><font color="#808080">rem --- Implementation der Prozedur "berechne_Dezimalwert" ---</font><br /><b>proc</b> berechne_Dezimalwert<br />&nbsp;&nbsp;&nbsp;&nbsp;<b>dec</b> <font color="#000080">[dezimal]</font>, <font color="#000080">[konvert]</font><br /><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem Dezimalwert aus Zahlensystemwert errechnen</font><br />&nbsp;&nbsp;&nbsp;&nbsp;getdialog <font color="#000080">[konvert]</font> = <font color="#0000ff">'umrechner:konvert'</font>, <font color="#0000ff">'text'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[konvert]</font> ! <font color="#0000ff">''</font><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rem Wert berechnen (mit der base_to_decimal-Bibliotheksfunktion)</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base_to_decimal <font color="#000080">[dezimal]</font> = <font color="#000080">[konvert]</font>, <font color="#000080">[aktuelle_basis]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[dezimal]</font> = <font color="#0000ff">'-1'</font> <font color="#000080">[dezimal]</font> = <font color="#0000ff">'Fehleingabe'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>endif</b><br />&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'umrechner:dezimal'</font>, <font color="#0000ff">'text'</font>, <font color="#000080">[dezimal]</font><br /><b>endproc</b><br /><br /><font color="#808080">rem --- Implementation der Prozedur "setze_Zahlensystem" ---</font><br /><b>proc</b> setze_Zahlensystem: <font color="#000080">[zahlensystem]</font><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem H&auml;ckchen aus Men&uuml;punkten entfernen</font><br />&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'umrechner:Menu_Dezimal -&gt; &Oktal'</font>, <font color="#0000ff">'checked'</font>, <font color="#000080">[false]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'umrechner:Menu_Dezimal -&gt; &Hexadezimal'</font>, <font color="#0000ff">'checked'</font>, <font color="#000080">[false]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'umrechner:Menu_Dezimal -&gt; &Bin&auml;r'</font>, <font color="#0000ff">'checked'</font>, <font color="#000080">[false]</font><br /><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem Zahlensystembezeichnung vor dem Eingabefeld sowie H&auml;ckchen im Men&uuml; setzen</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[zahlensystem]</font> = <font color="#000080">[bin]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'umrechner:l_konvert'</font>, <font color="#0000ff">'caption'</font>, <font color="#0000ff">'Bin&auml;rwert:'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'umrechner:Menu_Dezimal -&gt; &Bin&auml;r'</font>, <font color="#0000ff">'checked'</font>, <font color="#000080">[true]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>elseif</b> <font color="#000080">[zahlensystem]</font> = <font color="#000080">[okt]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'umrechner:l_konvert'</font>, <font color="#0000ff">'caption'</font>, <font color="#0000ff">'Oktalwert:'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'umrechner:Menu_Dezimal -&gt; &Oktal'</font>, <font color="#0000ff">'checked'</font>, <font color="#000080">[true]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>elseif</b> <font color="#000080">[zahlensystem]</font> = <font color="#000080">[hex]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'umrechner:l_konvert'</font>, <font color="#0000ff">'caption'</font>, <font color="#0000ff">'Hexadezimalwert:'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'umrechner:Menu_Dezimal -&gt; &Hexadezimal'</font>, <font color="#0000ff">'checked'</font>, <font color="#000080">[true]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>endif</b><br /><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem Aktuelle Basis auf &uuml;bergebenes Zahlensystem setzen</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[aktuelle_basis]</font> = <font color="#000080">[zahlensystem]</font><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;berechne_Zielwert<br /><b>endproc</b><br /><br /><font color="#808080">rem --- Erzeugen und Aufsetzen des Hauptfensters ---</font><br />newdialog <font color="#0000ff">'umrechner'</font>, <font color="#0000ff">'dialog'</font>, <font color="#0000ff">'1|1|270|100'</font><br /><br /><font color="#808080">rem Fenstertitel und Style setzen</font><br />letdialog <font color="#0000ff">'umrechner'</font>, <font color="#0000ff">'caption'</font>, <font color="#0000ff">'Bin/Okt/Hex Umrechner'</font><br />letdialog <font color="#0000ff">'umrechner'</font>, <font color="#0000ff">'style'</font>, <font color="#0000ff">'single'</font><br /><br /><font color="#808080">rem Men&uuml;baum erzeugen</font><br /><font color="#000080">[men&uuml;]</font> # <font color="#0000ff">'&Modus:Dezimal -&gt; &Bin&auml;r|Dezimal -&gt; &Oktal|Dezimal -&gt; &Hexadezimal;;'</font><br />letdialog <font color="#0000ff">'umrechner'</font>, <font color="#0000ff">'menu'</font>, <font color="#000080">[men&uuml;]</font><br /><br /><font color="#808080">rem --- Erzeugung von Eingabefeldern und Labels ---</font><br /><br /><font color="#808080">rem Label und Eingabefeld f&uuml;r Dezimalzahl</font><br />newdialog <font color="#0000ff">'umrechner:l_dezimal'</font>, <font color="#0000ff">'label'</font>, <font color="#0000ff">'5|8|100|22'</font><br />letdialog <font color="#0000ff">'umrechner:l_dezimal'</font>, <font color="#0000ff">'caption'</font>, <font color="#0000ff">'Dezimalwert:'</font><br />newdialog <font color="#0000ff">'umrechner:dezimal'</font>, <font color="#0000ff">'input'</font>, <font color="#0000ff">'110|4|150|25'</font><br />letdialog <font color="#0000ff">'umrechner:dezimal'</font>, <font color="#0000ff">'font'</font>, <font color="#0000ff">'Sans Serif|10|2'</font><br />letdialog <font color="#0000ff">'umrechner:dezimal'</font>, <font color="#0000ff">'event_change'</font>, <font color="#000080">[true]</font><br /><br /><font color="#808080">rem Label und Eingabefeld f&uuml;r Zahl des jew. Zahlensystems</font><br />newdialog <font color="#0000ff">'umrechner:l_konvert'</font>, <font color="#0000ff">'label'</font>, <font color="#0000ff">'5|34|100|22'</font><br />newdialog <font color="#0000ff">'umrechner:konvert'</font>, <font color="#0000ff">'input'</font>, <font color="#0000ff">'110|30|150|25'</font><br />letdialog <font color="#0000ff">'umrechner:konvert'</font>, <font color="#0000ff">'font'</font>, <font color="#0000ff">'Sans Serif|10|2'</font><br />letdialog <font color="#0000ff">'umrechner:konvert'</font>, <font color="#0000ff">'event_change'</font>, <font color="#000080">[true]</font><br /><br />setze_Zahlensystem <font color="#000080">[bin]</font><br /><br /><font color="#808080">rem --- Dialogfenster auf dem Bildschirm zentrieren & anzeigen ---</font><br />centerdialog <font color="#0000ff">'umrechner'</font><br />letdialog <font color="#0000ff">'umrechner'</font>, <font color="#0000ff">'visible'</font>, <font color="#000080">[true]</font><br />letdialog <font color="#0000ff">'umrechner:dezimal'</font>, <font color="#0000ff">'focus'</font>, <font color="#000080">[true]</font><br /><br /><font color="#808080">rem --- Ereignisbehandlungsroutine starten ---</font><br /><b>repeat</b><br />&nbsp;&nbsp;&nbsp;&nbsp;rundialog <font color="#000080">[ereignis]</font> = <font color="#0000ff">'0'</font><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[ereignis]</font> = <font color="#0000ff">'change_umrechner:dezimal'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;berechne_Zielwert<br />&nbsp;&nbsp;&nbsp;&nbsp;<b>elseif</b> <font color="#000080">[ereignis]</font> = <font color="#0000ff">'change_umrechner:konvert'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;berechne_Dezimalwert<br />&nbsp;&nbsp;&nbsp;&nbsp;<b>elseif</b> <font color="#000080">[ereignis]</font> = <font color="#0000ff">'click_umrechner:Menu_Dezimal -&gt; &Bin&auml;r'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setze_Zahlensystem <font color="#000080">[bin]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>elseif</b> <font color="#000080">[ereignis]</font> = <font color="#0000ff">'click_umrechner:Menu_Dezimal -&gt; &Oktal'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setze_Zahlensystem <font color="#000080">[okt]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>elseif</b> <font color="#000080">[ereignis]</font> = <font color="#0000ff">'click_umrechner:Menu_Dezimal -&gt; &Hexadezimal'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setze_Zahlensystem <font color="#000080">[hex]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>endif</b><br /><br /><b>until</b> <font color="#000080">[ereignis]</font> = <font color="#0000ff">'close_umrechner'</font><br /><b>end</b></div><!-- code END--><br /><br />

		<div class="line">&nbsp;</div>

		<div id="copyright">
			Copyright &copy; 2000-2006 by J.M.K S.F. Software Technologies, Jan Max Meyer<br />
			All rights reserved.
		</div>
	</body>
</html>
