<html>
	<head>
		<title>Systemspezifische, vordeklarierte Variablen</title>
		<link rel="stylesheet" href="jmksf.css" type="text/css"></link>
	</head>

	<body>
		<div id="top">
			<img src="rb5.png" alt="RapidBATCH Logo" />
			Systemspezifische, vordeklarierte Variablen
		</div>
		
		<div class="line">&nbsp;</div>
		
		Es mag vielleicht sein, dass der Abschnitt &quot;Systemoperationen&quot; nicht ganz passend ist, um alle vordeklarierten Variablen, die RapidBATCH bietet, zu behandeln, aber es haben auch sehr viele der vordeklarierten Variablen ihre Bestimmung bei der Programmierung von Scripts, die system-basierende Operationen ver- und bearbeiten. Bis jetzt haben Sie bereits viele der so genannten &quot;vordeklarierten Variablen&quot; kennen gelernt. Vordeklarierte Variablen werden vor der Ausf&uuml;hrung eines jeden Scripts automatisch vom Interpreter deklariert. Bei einigen vordeklarierten Variablen ist der darin enthaltene Wert &auml;nderbar, bei anderen wird er bei jedem Aufruf der Variable direkt neu ermittelt.<br />Ich werde in diesem Kapitel zwar nicht alle vordeklarierten Variablen behandeln, aber die wichtigsten, besonders solche, die f&uuml;r Systemoperationen von Bedeutung und Nutzen sind.<br /><br />Oftmals ist es von groﬂem Nutzen, ein Programm bzw. Optionen und Informationen an ein Programm &uuml;ber die Kommandozeile zu &uuml;bergeben. Dies darf nat&uuml;rlich auch bei RapidBATCH nicht fehlen! Die Variable [command] enth&auml;lt alle Kommandozeilenparameter, die hinter dem Dateinamen des Script-Files (wenn das Script mit dem Interpreter ausgef&uuml;hrt wird) bzw. bei compilierten Scripts alle an die EXE-Datei &uuml;bergebenen Kommandozeilenparameter, &uuml;bergeben wurden.<br />Bestes Beispiel stellt folgendes Script dar. Es gibt einfach den Inhalt der Variablen [command] in einem Meldungsfenster aus. Im RapidBATCH Builder k&ouml;nnen Sie zum direkten Testen Ihrer Scripts die Funktion &quot;Setze [command]...&quot; im Men&uuml; &quot;Script&quot; benutzen.<br /><br /><!-- code BEGIN --><div class="code">echo <font color="#0000ff">'Das hier wurde diesem Script mitgeschickt: '</font> # <font color="#000080">[command]</font><br /><b>end</b></div><!-- code END--><div class="image"><img src="img/sysop_pdvar1.gif" alt="Eingabe eines Kommandozeilenwertes an das Script im RapidBATCH Builder" title="Eingabe eines Wertes, welcher an [command] beim Starten des Scripts &uuml;bergeben wird." /><br />Die Funktion &quot;Setze [command]...&quot;, ideal zum Testen von Kommandozeilen-Parametern...</div><div class="image"><img src="img/sysop_pdvar2.gif" alt="Ausgabe des &uuml;ber die Kommandozeile &uuml;bergebenen Wertes." title="Ausgabe von [command]" /><br />...mit Erfolg!</div><div class="remark">Anmerkung: Die &uuml;ber [command] &uuml;bergebenen Werte k&ouml;nnen direkt in ein Array transferiert werden, indem Sie die Prozedur getcmdlineparms aus der SYSTEM.RB Bibliothek verwenden.</div><!-- Geilo: E Nomine - Hexenjagd  (Anthony Hopkins) h&ouml;r *fieps* -->Sie m&ouml;chten einen beliebigen Wert f&uuml;r jedes andere Windows-Programm zug&auml;nglich machen? Mit RapidBATCH ist auch dies kein Problem. Durch Zuweisung eines beliebigen Wertes an die Variable [clipboard] wird dieser sofort in die Windows-Zwischenablage kopiert. Ein Auslesen von [clipboard] erm&ouml;glicht das sofortige Auslesen des Zwischenablagen-Inhaltes.<br /><br />Ein einfaches Beispiel, welches sogar den Inhalt der Zwischenablage in einem anderen Programm einf&uuml;gt:<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem Zeige mir den Inhalt der Zwischenablage!</font><br />echo <font color="#0000ff">'Aktueller Inhalt der Zwischenablage: '</font> # <font color="#000080">[clipboard]</font><br /><br /><font color="#808080">rem So und jetzt schreiben wir mal ein "Hello World" rein!</font><br /><font color="#000080">[clipboard]</font> = <font color="#0000ff">'Hello World by RapidBATCH'</font><br />echo <font color="#0000ff">'Neuer Inhalt der Zwischenablage: '</font> # <font color="#000080">[clipboard]</font><br /><br /><font color="#808080">rem Und jetzt via Fernsteuerung den Text mal im Notepad "einf&uuml;gen"</font><br />shell <font color="#000080">[windir]</font> # <font color="#0000ff">'\notepad.exe'</font>, <font color="#0000ff">'show'</font><br />wait <font color="#0000ff">'500'</font><br />sendkeys <font color="#000080">[active_window]</font>: <font color="#0000ff">'Und das ist der Inhalt Ihrer Zwischenablage in einem anderem Programm: #271v#017'</font><br /><b>end</b></div><!-- code END-->Und da findet man auch direkt schon die n&auml;chste, vordeklarierte Variable: [active_window]! [active_window] enth&auml;lt den Titel des aktuellen Vordergrundfensters und kann idealerweise von SENDKEYS exzellent genutzt werden, wenn man den genauen Titel eines Fensters nicht kennt oder dieser variabel ist, wie es z.B. bei Word - oder anderen Office-Programmen - der Fall ist, wenn man ein Dokument geladen hat.<br />Auch die bereits kennen gelernte Variable [windir] wird im obigen Script benutzt; Sie enth&auml;lt den absoluten Pfad des Windows-Systemverzeichnisses.<br /><br />Auch das Auslesen von Systemdatum und Systemzeit ist in RapidBATCH kein Problem. Folgendes Script zeigt f&uuml;r 10 Sekunden die aktuelle Uhrzeit und das aktuelle Datum in einer INFOBOX sekundengenau an.<br /><br /><!-- code BEGIN --><div class="code"><font color="#000080">[i]</font> = <font color="#0000ff">'0'</font><br /><b>repeat</b><br />&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[i]</font> + <font color="#0000ff">'1'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;infobox <font color="#0000ff">'Es ist '</font> # <font color="#000080">[time]</font> # <font color="#0000ff">' am '</font>  # <font color="#000080">[day]</font> # <font color="#0000ff">'.'</font> # <font color="#000080">[month]</font> # <font color="#0000ff">'.'</font> # <font color="#000080">[year]</font>, <font color="#0000ff">'show'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;wait <font color="#0000ff">'1000'</font><br /><b>until</b> <font color="#000080">[i]</font> = <font color="#0000ff">'10'</font><br /><b>end</b></div><!-- code END-->Die Variable [time] enth&auml;lt die Uhrzeit, wird also bei jedem Auslesen aktuell und neu gef&uuml;llt. Das Format der [time]-Variablen ist HH:MM:SS, also Stunden, Minuten und Sekunden. Anders ist es bei dem Datum. Da RapidBATCH ein international eingesetztes Softwareprodukt ist, wurde hier Wert auf einfache Datumsformatierung gelegt, und die drei Informationen &quot;Tag&quot;, &quot;Monat&quot; und &quot;Jahr&quot; in drei Variablen, [day], [month] und [year] aufgeteilt. Man kann also durch einfaches &quot;Zusammenbauen&quot; des Datums mit dem Join-Operator (#) das Format v&ouml;llig frei bestimmen.<br /><br /><div class="image"><img src="img/sysop_pdvar3.gif" alt="Ausgabe von Uhrzeit und Datum in einem INFOBOX-Dialogfenster." title="Die aktuelle Zeit und das aktuelle Datum in der INFOBOX." /><br />Ausgabe der aktuellen Zeit und des aktuellen Tagesdatums im INFOBOX-Dialog.</div>Oftmals ist es auch n&ouml;tig, ob nun bei der Ausgabe von Informationen oder direkt beim Schreiben von Dateien, beispielsweise Tabulatoren oder Zeilenumbr&uuml;che einzuf&uuml;gen. Da ein Tabulator oder Zeilenumbruch intern nichts anderes als ein weiteres ASCII-Zeichen ist, k&ouml;nnte man sich dieses auch mit der Funktion GETCHR holen, aber RapidBATCH hat auch bereits vordeklarierte Variablen, welche einem an dieser Stelle die Arbeit abnehmen: [new_line], [tab], [crlf], [pipe] und [quot]. [new_line] und [crlf] stellen jeweils Zeilenumbr&uuml;che dar, allerdings mit einem wichtigem Unterschied. Unter Windows-Systemen ist es besonders bei Texten &uuml;blich, Zeilenumbr&uuml;che mit zwei anstatt mit einem Zeichen einzuleiten. Diese heissen &quot;carriage return&quot; und &quot;line feed&quot; (ASCII-Zeichencodes 13 und 10, daher auch [crlf], Carriage Return + Line Feed). Diese beiden Begriffe kommen noch aus der Urzeit der Computer, wo die Ausgabe aller Programme noch vornehmlich auf Nadeldruckern erfolgte, daher &quot;carriage return&quot;, was &uuml;bersetzt soviel heisst wie &quot;Schreibkopfr&uuml;cklauf&quot; und &quot;line feed&quot;, was nicht mehr als &quot;Zeilenvorschub&quot; heisst. I.d.R. reicht meist aber ein einfaches [new_line], welches nur ein &quot;line feed&quot; bewirkt, um einen Zeilenumbruch darzustellen. [tab] enth&auml;lt ein Tabulatorzeichen, [pipe] das Zeichen &quot;|&quot;, welches auch als RapidBATCH Standard Separator bei Listen verwendet wird. Die Variable [quot] enth&auml;lt ein einfaches Anf&uuml;hrungszeichen, welches in RapidBATCH selber zur Ein- und Ausleitung von Strings im Script-Code verwendet wird, und daher nicht direkt ausgegeben werden kann. Um dieses Zeichen selber in einem String zu verketten, verwenden Sie [quot], welche dieses Zeichen (') enth&auml;lt.<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem Zeilenumbr&uuml;che</font><br />echo <font color="#0000ff">'Dies ist'</font> # <font color="#000080">[new_line]</font> # <font color="#0000ff">'ein Zeilenumbruch in '</font> # <font color="#000080">[crlf]</font> # <font color="#0000ff">'zwei Versionen'</font><br /><br /><font color="#808080">rem Tabulatoren</font><br />echo <font color="#0000ff">'Ein'</font> # <font color="#000080">[tab]</font> # <font color="#0000ff">'Tabulator!'</font><br /><br /><font color="#808080">rem Pipe-Zeichen</font><br />echo <font color="#0000ff">'Das als '</font> # <font color="#000080">[std_sep]</font> # <font color="#0000ff">' definierte Zeichen ist Standardm&auml;ﬂig ein '</font> # <font color="#000080">[pipe]</font> # <font color="#0000ff">' ;)'</font><br /><br /><font color="#808080">rem Einfaches Anf&uuml;hrungszeichen</font><br />echo <font color="#0000ff">'echo '</font> # <font color="#000080">[quot]</font> # <font color="#0000ff">'Dies ist der Code f&uuml;r eine einfache Ausgabe'</font> # <font color="#000080">[quot]</font> # <font color="#000080">[crlf]</font> # <font color="#0000ff">'end'</font></div><!-- code END-->Bereits in vorherigen Abschnitten haben Sie die Variable [errorcode] kennen gelernt. Diese werden Sie auch am h&auml;ufigsten zur Abfrage von Fehlern verwenden. [errorcode] gibt in fast allen F&auml;llen (bis auf Ausnahmen bei SHELL und CALL) die Werte '0' f&uuml;r &quot;kein Fehler&quot; bzw. &quot;wahr&quot; und '-1' f&uuml;r &quot;Fehler&quot; bzw. &quot;falsch&quot; zur&uuml;ck. Um eine IF- oder UNTIL-Bedinung etwas professioneller zu realisieren, wurden w&auml;hrend der Entwicklung von RapidBATCH 5 noch die Variablen [true] und [false] hinzugenommen. [true] enth&auml;lt standardm&auml;ﬂig den Wert '0',  [false] standardm&auml;ﬂig den Wert '-1'. Eine IF-Abgrage kann also zum besseren Verst&auml;ndnis sowie zur erh&ouml;hten Dynamik so programmiert werden:<br /><br /><!-- code BEGIN --><div class="code">chdir <font color="#0000ff">'C:\test'</font><br /><br /><b>if</b> <font color="#000080">[errorcode]</font> = <font color="#000080">[false]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Fehler, das Verzeichnis wurde nicht gefunden!'</font><br /><b>else</b><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Das Verzeichnis wurde erolgreich gewechselt.'</font><br /><b>endif</b></div><!-- code END-->Zu guter Letzt noch eine Variable, die im wahrsten Sinne des Wortes gar nichts tut: [null]!<br />Diese Variable hat u.a. den Zweck, Funktions-R&uuml;ckgabewerte abzufangen, die nicht ben&ouml;tigt werden, denn nicht immer wird der R&uuml;ckgabewert einer Funktion wirklich gebraucht. Bei Zuweisung an die Variable [null] wird der Wert im Speicher direkt verworfen, muss also nicht erst in eine Pseudo-Returnvariable kopiert werden, was wiederum unn&uuml;tzen Speicherverbrauch zur Folge hat. Des weiteren kann [null] auch als Parameter bei Anweisungen oder Funktionen &uuml;bergeben werden, wenn man einen Leerstring &uuml;bergeben will. [null] ist also die aussagekr&auml;ftigere Alternative zur Angabe eines Leerstrings.<br /><br />

		<div class="line">&nbsp;</div>

		<div id="copyright">
			Copyright &copy; 2000-2006 by J.M.K S.F. Software Technologies, Jan Max Meyer<br />
			All rights reserved.
		</div>
	</body>
</html>
