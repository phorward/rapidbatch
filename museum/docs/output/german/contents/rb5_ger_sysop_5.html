<html>
	<head>
		<title>Programme fernsteuern</title>
		<link rel="stylesheet" href="jmksf.css" type="text/css"></link>
	</head>

	<body>
		<div id="top">
			<img src="rb5.png" alt="RapidBATCH Logo" />
			Programme fernsteuern
		</div>
		
		<div class="line">&nbsp;</div>
		
		Eine effektive M&ouml;glichkeit der Automatisierung ist auch das Fernsteuern von fremden Anwendungen. RapidBATCH ist dabei in der Lage, anderen Windows-Programmen vorzugaukeln, der PC-Benutzer w&uuml;rde das Programm selbst bedienen, indem es Tastaturbefehle und Tastenkombinationen an das entsprechende Fenster sendet.<br />Zu diesem Zweck stellt RapidBATCH die SENDKEYS-Anweisung zur Verf&uuml;gung. Mit einer sehr einfach zu erlernenden und primitiv aufgebauten Makrosprache kann der RapidBATCH-Programmierer &uuml;ber diese Anweisung Tastenkombinationen und Tastatureingaben an theoretisch jedes beliebige Windows-Programm senden.<br />Folgendes Script demonstriert, wie sich der Windows Editor &quot;Notepad&quot; fernsteuern l&auml;sst: Es startet Notepad und gibt den Text &quot;Hello World&quot; ein. Danach wird die Datei gespeichert und das Programm anschliessend beendet, wozu das Script die entsprechenden Tastenkombinationen schickt, um das Men&uuml; zu &ouml;ffnen und den Men&uuml;punkt &quot;Datei -> Speichern&quot; auszuw&auml;hlen.<br /><br /><!-- code BEGIN --><div class="code">shell <font color="#000080">[windir]</font> # <font color="#0000ff">'\notepad.exe'</font>, <font color="#0000ff">'show'</font><br />sendkeys <font color="#0000ff">'Unbenannt - Editor'</font>: <font color="#0000ff">'Hello World^(alt)dstest.txt(enter)^(alt)(f4)'</font><br /><b>end</b></div><!-- code END-->Als ersten Parameter erwartet SENDKEYS den Titel des Fensters, an dem das Programm identifiziert wird. Dieser Titel kann zum Beispiel auch &uuml;ber die Variable [active_window] geholt werden, die den Titel des aktiven Vordergrundfensters enth&auml;lt.<br />Anschliessend folgt ein in der bereits angesprochenen Makrosprache definierter Satz an Tastenkombinationen, die an das fernzusteuernde Programm geschickt werden sollen.<br /><br />Nehmen wir nun einmal diese Tastaturkommandos und Tastenkombinationen, welches wir bei SENDKEYS an den Notepad-Editor senden, genauer unter die Lupe:<br /><br /><center>	<table class="std">	<tr>		<td>			<b>Abschnitt:</b>		</td>		<td align="center">			A		</td>		<td align="center">			B		</td>		<td align="center">			C		</td>		<td align="center">			D		</td>	</tr>	<tr>		<td>			<b>Kommandos:</b>		</td>		<td align="center">			Hello World		</td>		<td align="center">			^(alt)ds		</td>		<td align="center">			test.txt(enter)		</td>		<td align="center">			^(alt)(f4)		</td>	</tr>	</table></center><br /><ul>	<li>		<b>Abschnitt A:</b><br />		Hier schreiben wir einfach den Text &quot;Hello World&quot; in das Eingabefeld des Editors. Es muss darauf geachtet werden, dass der Cursor im richtigem Feld steht, wo der Text rein soll (das Eingabefeld hat beim Notepad nach dem starten IMMER den Eingabefokus!).<br />	</li>	<li>		<b>Abschnitt B:</b><br />		Jetzt wollen wir den Dialog zum Speichern der Datei &ouml;ffnen. Dazu m&uuml;ssen wir ALT und D gleichzeitig dr&uuml;cken. Um eine Taste gedr&uuml;ckt zu halten, wird ihr ein Zirkumflex-Zeichen (^) vorangestellt. Da die ALT-Taste eine Sondertaste ist, wird diese in Klammern angegeben, damit der interne Interpreter f&uuml;r die SENDKEYS-Makrosprache weiﬂ, das man eine Sondertaste ausgeben m&ouml;chte.<br />Hier sei zu erw&auml;hen, daﬂ man, wenn man wirklich ein Klammerzeichen ausgeben m&ouml;chte, diesem ein Tilde-Zeichen (~) voranstellen muﬂ. Das Tilde-Zeichen erzwingt die Ausgabe des ihm nachfolgendem Zeichens, womit ~^ ein Zirkumflex an das Programm schickt und ~( eine offene Klammer. Um ein Tilde-Zeichen selbst an das fernzusteuernde Programm zu senden, schreibt man ~~.<br /><br />Da wir nun die ALT-Taste gedr&uuml;ckt halten, senden wir direkt ein &quot;d&quot; hinterher. Mit ALT+D w&auml;hlen wir also - via Tastenkombination - das Datei-Men&uuml; des Editors. Es sei hier auch zu erw&auml;hnen, das man, bevor man eine Anwendung mit RapidBATCH fernsteuert, sich vorher in der Anwendung das genaue Vorgehen selber anschaut, indem man seine Tastenkombinationen dr&uuml;ckt. Beachten Sie bitte, daﬂ direkt, nachdem das &quot;d&quot; an die Anwendung geschickt wurde, beide Tasten, also &quot;d&quot; und die ALT-Taste wieder automatisch &quot;losgelassen&quot; werden. M&ouml;chte man z.B. Mehrere Tasten gleichzeitig dr&uuml;cken, z.B. STRG, ALT und ENTF, so schreibt man als SENDKEYS-Makro &quot;^(control)^(alt)^(del)&quot;.<br />Um nun dem Speichern-Dialog zu laden, dr&uuml;cken wir noch direkt ein &quot;s&quot; hinterher.<br />Wie Sie an dieser Stelle schon gemerkt haben, k&ouml;nnen &quot;normale&quote; Zeichen wie Buchstaben und Zahlen direkt angegeben werden, nur reine Sondertasten, f&uuml;r die es kein lesbares Zeichen gibt, werden geklammert geschrieben.<br />	</li>	<li>		<b>Abschnitt C:</b><br />		Hier &quot;tippen&quot; wir wieder einfach einen Text, in diesem Fall den Dateinamen &quot;test.txt&quot; ein, und best&auml;tigen den Dialog mit der Taste Enter &uuml;ber den Sondertastenbefehl <i>(enter)</i>.<br />	</li>	<li>		<b>Abschnitt D:</b><br />		Zum Schluss &quot;dr&uuml;cken&quot; wir noch einmal ALT+F4, um die Anwendung zu beenden. Auch F1 ist hier ein Sonderzeichen, und wird als <i>(f1)</i> kodiert. Es ist &uuml;brigens v&ouml;llig Frei, ob Sie Groﬂ- oder Kleinschreibung bei den Sondertastennamen angeben, <i>(ALT)</i> oder <i>(Alt)</i> w&auml;re genauso richtig wie <i>(alt)</i>.<br />	</li></ul><br />Um eine &Uuml;bersicht &uuml;ber die m&ouml;glichen Sondertasten und ihrer Benennung zu erhalten, lohnt sich ein Blick in die Befehlsreferenz, in der auch nochmal die Syntax der SENDKEYS-Makrosprache Stichpunktartig erkl&auml;rt wird.<br /><br /><br />Neben SENDKEYS bietet RapidBATCH noch eine weitere M&ouml;glichkeit, Programme fernzusteuern: Mit der MOUSEEVENT-Anweisung lassen sich alle nur erdenklichen Mausereignisse simulieren und damit fernsteuern, d.h. ein RapidBATCH-Script kann die volle Kontrolle &uuml;ber die Maus des Computers &uuml;bernehmen und Klicks, Doppelklicks oder einfach nur Bewegungen simulieren.<br /><br />Dieses Thema m&ouml;chte ich jedoch nur kurz anreissen, da man aufgrund verschiedener Ausfl&ouml;sungen und Programme kein allgemeines Demo-Script, welches Mausereignisse vollzieht, durchf&uuml;hren kann. Scripts, die Mausereignisse simulieren, sollten Sie daher nur f&uuml;r den Eigengebrauch programmieren oder wenn Sie sich wirklich sicher sind, dass Ihre Mausroutine tadellos auch auf jedem System, wo Sie Ihr Script einsetzen, funktioniert.<br /><br />Folgender Aufruf von MOUSEEVENT setzt den Mauszeiger exakt auf die Mitte des Bildschirmes:<br /><br /><!-- code BEGIN --><div class="code">mouseevent <font color="#0000ff">'move'</font>, (<font color="#000080">[ScreenWidth]</font>/<font color="#0000ff">'2'</font>) # <font color="#0000ff">'|'</font> # (<font color="#000080">[ScreenHeight]</font>/<font color="#0000ff">'2'</font>)</div><!-- code END-->Wie aus dem obigen Beispiel ersichtlich, erwartet MOUSEEVENT zwei Parameter.  Zuerst einen Aktionsbezeichner, der MOUSEVENT anweist, eine bestimmte Aktion durchzuf&uuml;hren, als zweites zwei Koordinatenwerte, die in der Form &quot;X|Y&quot; &uuml;bergeben werden, wobei als Trennzeichen jedes beliebige, in der vordeklarierten Systemvariablen [std_sep] definierte Trennzeichen sein kann (wie auch bei Listen, die man an die LISTBOX-Funktion &uuml;bergibt). Diese Koordinaten setzen den Mauszeiger pixelgenau auf die entsprechende Stelle auf dem Bildschirm, bzw. f&uuml;hren dort die entsprechend definierte Mausoperation durch.<br /><br />Als Mausoperationen k&ouml;nnen folgende Werte an MOUSEEVENT &uuml;bergeben werden:<ul>  <li>'0' oder 'MOVE' (Maus nur bewegen, kein Tastendruck)</li>  <li>'1' oder 'CLICK_LEFT' (einfachen Linksklick simulieren)</li>  <li>'2' oder 'DBLCLICK_LEFT' (doppelten Linksklick simulieren)</li>  <li>'3' oder 'CLICK_RIGHT' (einfachen Rechtsklick simulieren)</li>  <li>'4' oder 'DBLCLICK_RIGHT' (doppelten Rechtsklick simulieren)</li>  <li>'5' oder 'DOWN_LEFT' (Linke Maustaste gedr&uuml;ckt halten)</li>  <li>'6' oder 'UP_LEFT' (Linke Maustaste loslassen)</li>  <li>'7' oder 'DOWN_RIGHT'  (Rechte Maustaste gedr&uuml;ckt halten)</li>  <li>'8' oder 'UP_RIGHT' (Rechte Maustaste loslassen)</li></ul><br /><br />

		<div class="line">&nbsp;</div>

		<div id="copyright">
			Copyright &copy; 2000-2006 by J.M.K S.F. Software Technologies, Jan Max Meyer<br />
			All rights reserved.
		</div>
	</body>
</html>
