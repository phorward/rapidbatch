<html>
	<head>
		<title>Arrays</title>
		<link rel="stylesheet" href="jmksf.css" type="text/css"></link>
	</head>

	<body>
		<div id="top">
			<img src="rb5.png" alt="RapidBATCH Logo" />
			Arrays
		</div>
		
		<div class="line">&nbsp;</div>
		
		Kommen wir nun zu einer revolution&auml;ren Neuerung in RapidBATCH 5, den Arrays!<br /><br />Bei einem Array (engl. f&uuml;r Anordnung, Aufstellung, Datenfeld) handelt es sich um eine Gruppe von Variablen, die unter einem gemeinsamen Variablen-Namen gespeichert werden. Arrays werden ben&ouml;tigt, um einerseits eine groﬂe Anzahl von Variablen mit geringem Aufwand zu definieren und um andererseits die Voraussetzung zu schaffen, direkt auf ein bestimmtes Variablenelement durch Angabe eines Index-Wertes zuzugreifen.<br /><br />Arrays bieten also die M&ouml;glichkeit, unter dem Namen einer einzigen Variablen schier unendlich viele, verschiedene Werte in sogar mehrfach verschachtelten Dimensionen zu speichern. Ein Array kann man sich wie eine Tabelle im Speicher vorstellen, in der jede Zeile einen Wert enth&auml;lt, welcher &uuml;ber den soeben beschriebenen Index-Z&auml;hler adressiert werden kann.<br />Viele Programmiersprachen bieten sowohl statische Arrays (Arrays, die in ihrer Gr&ouml;ﬂe nicht variabel sind) als auch dynamische Arrays (Arrays, die zur Laufzeit definiert werden und dynamische Gr&ouml;ﬂen und Dimensionen annehmen k&ouml;nnen). RapidBATCH erm&ouml;glicht nur den Einsatz von dynamischen Arrays, was eine unglaublich hohe Flexbilit&auml;t zul&auml;sst; Der Programmierer braucht sich n&auml;mlich in keiner Weise mit der internen Speicherverwaltung des Arrays auseinanderzusetzen - RapidBATCH erledigt die Dimensionierung und Erweiterung von Arrays intern v&ouml;llig automatisch.<br />Ein einfaches Beispiel f&uuml;r die Verwendung eines Arrays demonstriert folgendes Script. Es speichert 10 unterschiedliche Namen in einem Array, welches unter als [namen] deklariert wird. In der REPEAT...UNTIL-Schleife weiter unten werden die Namen von 1 bis 10 durchlaufen und angezeigt, wobei wir eine Z&auml;hlervariable, [i], zum Hochz&auml;hlen des Indexes verwenden.<br /><br /><!-- code BEGIN --><div class="code"><b>dec</b> <font color="#000080">[namen:'10']</font><br /><font color="#000080">[namen:'1']</font> = <font color="#0000ff">'Jan'</font><br /><font color="#000080">[namen:'2']</font> = <font color="#0000ff">'Anna'</font><br /><font color="#000080">[namen:'3']</font> = <font color="#0000ff">'Stefan'</font><br /><font color="#000080">[namen:'4']</font> = <font color="#0000ff">'Matthias'</font><br /><font color="#000080">[namen:'5']</font> = <font color="#0000ff">'Sebastian'</font><br /><font color="#000080">[namen:'6']</font> = <font color="#0000ff">'Daniel'</font><br /><font color="#000080">[namen:'7']</font> = <font color="#0000ff">'Uli'</font><br /><font color="#000080">[namen:'8']</font> = <font color="#0000ff">'Andreas'</font><br /><font color="#000080">[namen:'9']</font> = <font color="#0000ff">'Volker'</font><br /><font color="#000080">[namen:'10']</font> = <font color="#0000ff">'Marco'</font><br /><br /><font color="#000080">[index]</font> = <font color="#0000ff">'0'</font><br /><b>repeat</b><br />&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[index]</font> + <font color="#0000ff">'1'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Name an Position '</font> # <font color="#000080">[index]</font> # <font color="#0000ff">' ist: '</font> # <font color="#000080">[namen:[index]]</font><br /><b>until</b> <font color="#000080">[index]</font> = <font color="#0000ff">'10'</font><br /><b>end</b></div><!-- code END-->Die folgende Tabelle veranschaulicht die Speicheransicht des Arrays [namen] im obigen Beispiel:<br /><br /><table class="std" width="200" style="margin-left: 20px;">	<tr>		<td><b>Index:</b></td>		<td><b>Wert:</b></td>	</tr>	<tr>		<td>1</td>		<td>Jan</td>	</tr>	<tr>		<td>2</td>		<td>Anna</td>	</tr>	<tr>		<td>3</td>		<td>Stefan</td>	</tr>	<tr>		<td>4</td>		<td>Matthias</td>	</tr>	<tr>		<td>5</td>		<td>Sebastian</td>	</tr>	<tr>		<td>6</td>		<td>Daniel</td>	</tr>	<tr>		<td>7</td>		<td>Uli</td>	</tr>	<tr>		<td>8</td>		<td>Andreas</td>	</tr>	<tr>		<td>9</td>		<td>Volker</td>	</tr>	<tr>		<td>10</td>		<td>Marco</td>	</tr></table><br />Arrays k&ouml;nnen in RapidBATCH auf verschiedene Arten definiert, dimensioniert und re-dimensioniert werden. Ein einfaches Array mit vorerst 10 Elementen, wie das, welches wir in unserem letzten Beispiel verwendet haben, kann man z.B. mit der DEC-Anweisung fest vordeklarieren:<br /><br /><!-- code BEGIN --><div class="code"><b>dec</b> <font color="#000080">[meinArray:'10']</font></div><!-- code END-->In RapidBATCH ist es v&ouml;llig frei, wie der Index (in diesem Fall der feste Wert '10') eines Arrays angegeben wird, er kann neben der oben gezeigten Variante auch in den folgenden Formen angegeben werden:<br /><br /><!-- code BEGIN --><div class="code"><b>dec</b> <font color="#000080">[meinArray'10']</font><br /><b>dec</b> <font color="#000080">[meinArray '10']</font><br /><b>dec</b> <font color="#000080">['10'meinArray]</font><br /><b>dec</b> <font color="#000080">[mein'10'Array]</font></div><!-- code END-->Auch wenn letztere Schreibweise sehr merkw&uuml;rdig aussieht, sie ist eine g&uuml;ltige Index-Angabe, und das Array wird unter dem Namen &quot;meinArray&quot; deklariert!<br /><br />Der Index kann selbstverst&auml;ndlich auch v&ouml;llig dynamisch &uuml;ber eine Variable angegeben werden:<br /><br /><!-- code BEGIN --><div class="code"><font color="#000080">[index]</font> = <font color="#0000ff">'10'</font><br /><b>dec</b> <font color="#000080">[meinArray:[index]]</font><br /><b>dec</b> <font color="#000080">[meinArray[index]]</font><br /><b>dec</b> <font color="#000080">[mein[index]Array]</font></div><!-- code END-->Arrays k&ouml;nnen auch durch direkte Zuweisung eines Wertes zu irgend einem Index deklariert bzw. erzeugt werden; Das bedeutet auch, dass Sie jede beliebige, in Ihrem RapidBATCH-Script verwendete Variable durch eine einfache Zuweisung eines Wertes zu einem Index in ein Array umwandeln k&ouml;nnen. Folgendes Beispiel erzeugt ein Array mit drei Werten durch die direkte Zuweisung der Werte, ohne vorherige, explizite Deklaration. Die Elemente des Arrays werden dabei r&uuml;ckw&auml;rts ausgegeben, d.h. der letzte Eintrag zuerst, wie aus der Schleife ersichtlich ist.<br /><br /><!-- code BEGIN --><div class="code"><font color="#000080">[meinArray:'1']</font> = <font color="#0000ff">'Ich bin der erste Eintrag in dem Array'</font><br /><font color="#000080">[meinArray:'2']</font> = <font color="#0000ff">'Ich bin der zweite Eintrag in dem Array'</font><br /><font color="#000080">[meinArray:'3']</font> = <font color="#0000ff">'Ich bin der letzte Eintrag in dem Array'</font><br /><br /><font color="#000080">[i]</font> = <font color="#0000ff">'3'</font><br /><b>repeat</b><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#000080">[meinArray:[i]]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[i]</font> - <font color="#0000ff">'1'</font><br /><b>until</b> <font color="#000080">[i]</font> = <font color="#0000ff">'0'</font><br /><b>end</b></div><!-- code END-->Doppelpunkte und Kommata werden dabei im Variablennamen einfach ignoriert, d.h. sie sind nicht zwingend notwendig.<br /><br />Um die Anzahl der Elemente, die je Dimension in einem Array existiert, zu ermitteln, verwendet man die Dimensionangabe 0:<br /><br /><!-- code BEGIN --><div class="code"><font color="#000080">[meinArray:'1']</font> = <font color="#0000ff">'Ich bin der erste Eintrag in dem Array'</font><br /><font color="#000080">[meinArray:'2']</font> = <font color="#0000ff">'Ich bin der zweite Eintrag in dem Array'</font><br /><font color="#000080">[meinArray:'3']</font> = <font color="#0000ff">'Ich bin der letzte Eintrag in dem Array'</font><br />echo <font color="#0000ff">'Das Array beinhaltet momentan '</font> # <font color="#000080">[meinArray:'0']</font> # <font color="#0000ff">' Elemente'</font><br /><br /><font color="#000080">[i]</font> = <font color="#0000ff">'0'</font><br /><b>repeat</b><br />&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[i]</font> + <font color="#0000ff">'1'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Eintrag Nr. '</font> # <font color="#000080">[i]</font> # <font color="#0000ff">': '</font> # <font color="#000080">[meinArray:[i]]</font><br /><b>until</b> <font color="#000080">[i]</font> = <font color="#000080">[meinArray:'0']</font><br /><b>end</b></div><!-- code END-->Wie bereits oben kurz angesprochen, k&ouml;nnen Arrays auch in verschiedenen, verschachtelten Dimensionen angelegt werden. Eine Dimension ist sozusagen ein untergeordnetes Array eines Array-Elementes. D.h. wir k&ouml;nnen f&uuml;r jedes Array-Element ein untergeordnetes Array anlegen. Jedes Element dieses untergeordneten Arrays kann wiederum ein untergeordnetes Array beinhalten - das ganze ist in RapidBATCH bis zu 9 Dimensionen m&ouml;glich, eine immens groﬂe Kapazit&auml;t.<br /><br />Um mehrdimensionale Arrays anzulegen geht man genauso vor wie wenn man ein einfaches Array deklariert bzw. auff&uuml;llt: Man weist einfach einem nicht existierenden Element in irgendeiner Dimension einen Wert zu - RapidBATCH redimensioniert bzw. reserviert sich den n&ouml;tigen Speicher, der zum Erreichen der angegebenen Dimension n&ouml;tig ist, automatisch.<br /><br />Ein Beispiel (wobei die DEC-Anweisung auch hier wieder optional ist!):<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem Deklarieren eines Arrays mit 10x10x10 Dimensionen</font><br /><b>dec</b> <font color="#000080">[meinArray:'10','10','10']</font><br /><font color="#000080">[meinArray:'1','1','1']</font> = <font color="#0000ff">'Hello World'</font><br /><font color="#000080">[meinArray:'1','1','2']</font> = <font color="#0000ff">'Wert an Index 2'</font><br /><font color="#000080">[meinArray:'1','1','3']</font> = <font color="#0000ff">'Wert an Index 3'</font><br /><font color="#000080">[meinArray:'1','2','1']</font> = <font color="#0000ff">'Anderer Wert an Index 1'</font><br /><font color="#000080">[meinArray:'1','2','2']</font> = <font color="#0000ff">'Anderer Wert an Index 2'</font><br /><font color="#000080">[meinArray:'1','2','3']</font> = <font color="#0000ff">'Anderer Wert an Index 3'</font></div><!-- code END-->RapidBATCH bietet an dieser Stelle auch noch eine Besonderheit, die bisher keine andere Programmiersprache weltweit aufweist: Werte k&ouml;nnen in JEDE Dimension eines Arrays gespeichert werden!<br /><br />Ein konkretes Beispiel:<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem Auff&uuml;llen des Arrays in verschiedenen Dimensionen</font><br /><font color="#000080">[meinArray]</font> = <font color="#0000ff">'Basis'</font><br /><font color="#000080">[meinArray:'1']</font> = <font color="#0000ff">'Erste Dimension, Wert 1'</font><br /><font color="#000080">[meinArray:'1','1']</font> = <font color="#0000ff">'Zweite Dimension, Wert 1'</font><br /><font color="#000080">[meinArray:'1','1','1']</font> = <font color="#0000ff">'Dritte Dimension, Wert 1'</font><br /><font color="#000080">[meinArray:'1','1','2']</font> = <font color="#0000ff">'Dritte Dimension, Wert 2'</font><br /><font color="#000080">[meinArray:'1','2']</font> = <font color="#0000ff">'Zweite Dimension, Wert 2'</font><br /><font color="#000080">[meinArray:'2']</font> = <font color="#0000ff">'Erste Dimension, Wert 2'</font><br /><br /><font color="#808080">rem Ausgabe des Arrays</font><br />echo <font color="#000080">[meinArray]</font><br />echo <font color="#000080">[meinArray:'1']</font><br />echo <font color="#000080">[meinArray:'1','1']</font><br />echo <font color="#000080">[meinArray:'1','1','1']</font><br />echo <font color="#000080">[meinArray:'1','1','2']</font><br />echo <font color="#000080">[meinArray:'1','2']</font><br />echo <font color="#000080">[meinArray:'2']</font></div><!-- code END-->Speziell f&uuml;r die Wiederverwertung bzw. Aufl&ouml;sung nicht mehr ben&ouml;tigter Arrays und deren Speicherressourcen gibt es in RapidBATCH 5 auch eine M&ouml;glichkeit, ein Array komplett zu l&ouml;schen (z.B. damit es neu aufgef&uuml;llt werden kann): Die RESET-Anweisung! RESET tut genau das Gegenteil von der Anweisung DEC zum Deklarieren von Variablen und Arrays. Mit der RESET-Anweisung kann ein ganzes Array oder auch nur eine einzelne Dimension eines Arrays wieder freigegeben, also aus dem Speicher entfernt werden. Anzumerken sei hierbei, dass RESET nicht die Variable des Arrays selbst, sondern nur das Array bzw. den Inhalt der Variablen vom Speicher entfernt und zur erneuten Verwendung freigibt.<br /><br />Einfaches Beispiel:<br /><br /><!-- code BEGIN --><div class="code"><font color="#000080">[meinArray:'1']</font> = <font color="#0000ff">'Ich bin der erste Eintrag in dem Array'</font><br /><font color="#000080">[meinArray:'2']</font> = <font color="#0000ff">'Ich bin der zweite Eintrag in dem Array'</font><br /><font color="#000080">[meinArray:'3']</font> = <font color="#0000ff">'Ich bin der letzte Eintrag in dem Array'</font><br />echo <font color="#0000ff">'Das Array beinhaltet momentan '</font> # <font color="#000080">[meinArray:'0']</font> # <font color="#0000ff">' Elemente'</font><br /><br /><font color="#808080">rem Array l&ouml;schen</font><br /><b>reset</b> <font color="#000080">[meinArray]</font><br />echo <font color="#0000ff">'Das Array beinhaltet momentan '</font> # <font color="#000080">[meinArray:'0']</font> # <font color="#0000ff">' Elemente'</font><br /><br /><font color="#000080">[meinArray:'1']</font> = <font color="#0000ff">'Neuer Inhalt'</font><br /><font color="#000080">[meinArray:'2']</font> = <font color="#0000ff">'Noch ein neuer Inhalt'</font><br />echo <font color="#0000ff">'Das Array beinhaltet momentan '</font> # <font color="#000080">[meinArray:'0']</font> # <font color="#0000ff">' Elemente'</font><br /><b>end</b></div><!-- code END-->Die Vorteile, die Arrays in RapidBATCH mit sich bringen, sind sehr vielf&auml;ltig, vor allem ihre 100%ige Dynamik, die andere Programmier- und Scriptsprachen gar nicht oder nicht in diesem Umfang bieten.<br /><br />

		<div class="line">&nbsp;</div>

		<div id="copyright">
			Copyright &copy; 2000-2006 by J.M.K S.F. Software Technologies, Jan Max Meyer<br />
			All rights reserved.
		</div>
	</body>
</html>
