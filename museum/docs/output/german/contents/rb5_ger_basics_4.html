<html>
	<head>
		<title>Bedingungen und Schleifen</title>
		<link rel="stylesheet" href="jmksf.css" type="text/css"></link>
	</head>

	<body>
		<div id="top">
			<img src="rb5.png" alt="RapidBATCH Logo" />
			Bedingungen und Schleifen
		</div>
		
		<div class="line">&nbsp;</div>
		
		Nachdem Sie nun die &auml;usserst komplexen M&ouml;glichkeiten der variablen Programmierung kennen gelernt haben, kommen wir zu einem weiteren, wichtigen Teil der Ereignis-orientierten Programmierung, den Bedingungen.<br />Bisher haben wir n&auml;mlich nur Scripts geschrieben, die kontinuierlich von vorne nach hinten durchlaufen. Solche Programme sind mehr oder minder uninteressant f&uuml;r die Entwicklung von Software-Programmen. Doch in RapidBATCH gibt es verschiedene M&ouml;glichkeiten, variable Werte zu pr&uuml;fen und den Programmablauf somit bedingt zu gestalten.<br /><br />Beginnen wir mit einem einfachen Script, das ein Passwort solange abfragt, bis der Benutzer das korrekte Wort eingibt. Zu diesem Zweck verwenden wir die Schleifenanweisungen REPEAT und UNTIL zur Konstruktion einer Schleife. Eine Schleife ist ein Block von Anweisungen, der solange wiederholt wird, bis eine gegebene Bedingung erfolgreich gepr&uuml;ft wird. Ist dies der Fall, wird die Schleife verlassen und das Script fortgef&uuml;hrt.<br /><br />Der Code f&uuml;r eine Passwort-Abfrage:<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem Schleife solange wiederholen, bis Passwort "hallo" eingetippt wurde</font><br /><b>repeat</b><br />&nbsp;&nbsp;&nbsp;&nbsp;pwdbox <font color="#000080">[password]</font> = <font color="#0000ff">'Login'</font>, <font color="#0000ff">'Bitte geben Sie Ihr Kennwort ein:'</font>, <font color="#0000ff">''</font><br /><b>until</b> <font color="#000080">[password]</font> = <font color="#0000ff">'hallo'</font><br />echo <font color="#0000ff">'Das Kennwort war richtig.'</font><br /><b>end</b></div><!-- code END-->Wie Sie sehen werden, wird das PWDBOX-Eingabefenster (eine INPUTBOX mit verstecktem Eingabefeld f&uuml;r Passw&ouml;rter) solange wieder angezeigt, bis der Benutzer das richtige Passwort, in diesem Fall &quot;hallo&quot;, eingegeben hat. Bei dieser Bedingung handelt es sich um eine Gleichheitsbedingung, d.h. sie liefert das Ergebnis WAHR, wenn beide zu vergleichende Werte exakt den selben Wert beinhalten. Neben dem Gleichheitsoperator (=) kann man bei Bedingungen in RapidBATCH auch die Bedingungsoperatoren ungleich (!), gr&ouml;ﬂer-als (&gt;), kleiner-als (&lt;) sowie gr&ouml;ﬂer-gleich (&gt;=) und kleiner-gleich (&lt;=) verwenden, um eine Bedingung zu konstruieren. Die letzten vier k&ouml;nnen in RapidBATCH 5 auch mit Strings benutzt werden, da z.B. der Buchstabe 'A' kleiner als der Buchstabe 'B' ist. In RapidBATCH 4.x waren gr&ouml;ﬂer-als und kleiner-als Bedingungen nur mit numerischen Werten m&ouml;glich.<br /><br />Zudem empfehle ich, den Code, welchen Sie zwischen die Anweisungen REPEAT und UNTIL schreiben, mit Leerzeichen oder Tabs einzur&uuml;cken, denn dies verbessert die Lesbarkeit des Codes erheblich und tr&auml;gt zur schnelleren Fehlersuche bei, da der Code, der zur Schleife geh&ouml;rt, durch die Einr&uuml;ckung direkt hervorsticht.<br /><br />Schleifen sind jedoch nur eine M&ouml;glichkeit der bedingten Programmierung in RapidBATCH. Die andere, viel h&auml;ufiger verwendete Methode ist die IF-Anweisung, die zusammen mit den Anweisungen ELSEIF, ELSE und ENDIF in den verschiedensten Variationen eingesetzt werden kann. Folgende Beispiele demonstrieren einmal ein paar Einsatzf&auml;lle f&uuml;r IF-Konstruktionen.<br /><br />Eine einfache IF-Anweisung (zu deutsch: &quot;Wenn&quot;) w&auml;re z.B.<br /><br /><!-- code BEGIN --><div class="code"><b>if</b> <font color="#000080">[eingabe]</font> = <font color="#0000ff">'hallo'</font> echo <font color="#0000ff">'Das eingegebene Wort wurde erfolgreich auf "hallo" gepr&uuml;ft'</font></div><!-- code END-->Hier folgt direkt hinter der IF-Anweisung und der dazugeh&ouml;renden Bedingung die auszuf&uuml;hrende Anweisung. M&ouml;chte man zwei oder mehr Anweisungen hinter einem IF ausf&uuml;hren, gibt man diese in einem so genannten IF-Block an:<br /><br /><!-- code BEGIN --><div class="code"><b>if</b> <font color="#000080">[eingabe]</font> = <font color="#0000ff">'hallo'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Das eingegebene Wort wurde erfolgreich auf "hallo" gepr&uuml;ft'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[x]</font> + <font color="#0000ff">'2'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[x]</font> &gt; <font color="#0000ff">'32'</font> <b>halt</b><br /><b>endif</b></div><!-- code END-->Der Zeilenumbruch hinter der Bedingung weist den Interpreter bzw. Compiler an, dass er, wenn die Bedingung erfolgreich ist, den gesamten Code bis zum n&auml;chsten ENDIF (oder ELSEIF/ELSE) ausf&uuml;hren soll. Die HALT Anweisung, die hier verwendet wird, beendet das Script.<br /><br />Wenn man mehrere verschiedene Bedingungen in unterschiedlichen IF-Bl&ouml;cken pr&uuml;fen m&ouml;chte, verwendet man die ELSEIF-Anweisung:<br /><br /><!-- code BEGIN --><div class="code"><b>if</b> <font color="#000080">[eingabe]</font> = <font color="#0000ff">'hallo'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Das eingegebene Wort wurde erfolgreich auf "hallo" gepr&uuml;ft'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[x]</font> + <font color="#0000ff">'2'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[x]</font> &gt; <font color="#0000ff">'32'</font> <b>halt</b><br /><b>elseif</b> <font color="#000080">[eingabe]</font> = <font color="#0000ff">'tsch&uuml;ss'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Auf wiedersehen!'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>halt</b><br /><b>endif</b></div><!-- code END-->Wenn keine der Bedingungen eintritt, also alle IF/ELSEIF-Bedingungen unwahr sind, so kann man auch einen bestimmten Anweisungsblock in einem ELSE (zu deutsch: &quot;Ansonsten&quot;) zusammenfassen, der eben nur dann Ausgef&uuml;hrt wird, wenn alles andere fehlschl&auml;gt:<br /><br /><!-- code BEGIN --><div class="code"><b>if</b> <font color="#000080">[eingabe]</font> = <font color="#0000ff">'hallo'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Das eingegebene Wort wurde erfolgreich auf "hallo" gepr&uuml;ft'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[x]</font> + <font color="#0000ff">'2'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[x]</font> &gt; <font color="#0000ff">'32'</font> <b>halt</b><br /><b>elseif</b> <font color="#000080">[eingabe]</font> = <font color="#0000ff">'tsch&uuml;ss'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Auf wiedersehen!'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>halt</b><br /><b>else</b><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Eingabe ungenau.'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>goto</b> neustart<br /><b>endif</b></div><!-- code END-->Manchmal ist es auch von N&ouml;ten, mehr als einen Vergleich bei einer REPEAT...UNTIL oder IF/ELSEIF-Bedingung zu pr&uuml;fen. Zu diesem Zweck stellt RapidBATCH zwei so genannte logische Verkn&uuml;pfungsoperatoren bereit, die UND-Verkn&uuml;pfung (&quot;&amp;&quot;-Operator) sowie die ODER-Verkn&uuml;pfung (&quot;|&quot;-Operator). Diese Operatoren werden verwendet, um zwei (oder mehr) Vergleiche logisch zu einer gesamten Bedingung zu verkn&uuml;pfen.<br />Bei der ODER-Verkn&uuml;pfung muss eine der verkn&uuml;pften Bedingungen wahr sein, damit die Abfrage erfolgreich gepr&uuml;ft wird.<br /><br />Beispiel ist folgendes Script. Es gibt nur eine Willkommensnachricht aus, wenn der eingegebene Name &quot;Stefan&quot; oder &quot;Peter&quot; ist.<br /><br /><!-- code BEGIN --><div class="code">inputbox <font color="#000080">[name]</font> = <font color="#0000ff">'Log in'</font>, <font color="#0000ff">'Wie heiﬂt du?'</font>, <font color="#0000ff">''</font><br /><b>if</b> <font color="#000080">[name]</font> = <font color="#0000ff">'Stefan'</font> | <font color="#000080">[name]</font> = <font color="#0000ff">'Peter'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Herzlich Willkommen!'</font><br /><b>else</b><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Du bist nicht Stefan oder Peter!'</font><br /><b>endif</b><br /><b>end</b></div><!-- code END-->Anders ist es bei der UND-Verkn&uuml;pfung: Hier m&uuml;ssen beide Bedingungen wahr ergeben, damit die Abfrage als erfolgreich gepr&uuml;ft wird.<br /><br /><!-- code BEGIN --><div class="code">inputbox <font color="#000080">[name]</font> = <font color="#0000ff">'Nachname'</font>, <font color="#0000ff">'Wie ist dein Nachname?'</font>, <font color="#0000ff">''</font><br />inputbox <font color="#000080">[vorname]</font> = <font color="#0000ff">'Vorname'</font>, <font color="#0000ff">'Wie ist dein Vorname?'</font>, <font color="#0000ff">''</font><br /><br /><b>if</b> <font color="#000080">[name]</font> ! <font color="#0000ff">''</font> & <font color="#000080">[vorname]</font> ! <font color="#0000ff">''</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Hallo '</font> # <font color="#000080">[vorname]</font> # <font color="#0000ff">' '</font> # <font color="#000080">[name]</font><br /><b>else</b><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Sie haben nicht alle Werte eingegeben!'</font><br /><b>endif</b><br /><b>end</b></div><!-- code END-->Nat&uuml;rlich k&ouml;nnen auch UND- und ODER-Verkn&uuml;pfungen beliebig hintereinander geschaltet werden, nur m&uuml;ssen Sie darauf achten, dass die gegebenen Bedingungen auch wirklich erreicht werden k&ouml;nnen.<br /><br />

		<div class="line">&nbsp;</div>

		<div id="copyright">
			Copyright &copy; 2000-2006 by J.M.K S.F. Software Technologies, Jan Max Meyer<br />
			All rights reserved.
		</div>
	</body>
</html>
