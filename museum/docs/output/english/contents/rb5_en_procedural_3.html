<html>
	<head>
		<title>Pointers</title>
		<link rel="stylesheet" href="jmksf.css" type="text/css"></link>
	</head>

	<body>
		<div id="top">
			<img src="rb5.png" alt="RapidBATCH Logo" />
			Pointers
		</div>
		
		<div class="line">&nbsp;</div>
		
		In all of previous examples using procedures, we had already worked with parameters. Thereby, we applied the &quot;call-by-value&quot;-method, that means that the value that is specified at the procedure call is copied into the locally declared parameter variable of the procedure. But RapidBATCH also supports another method, the &quot;call-by-reference&quot;-method. This method does not copy a variable, but it creates a so called pointer to a variable specified at the procedure call. This locally declared &quot;pseudo-variable&quot; points to the target variable which can be a global variable or a local variable of a previously called procedure. The advantage of this method is, that it is also possible to pass arrays to procedures, so that these procedures can handle with the whole array. The call-by-reference method is also the only possibility to access variables beyond the current procedure call, for example, as already mentioned, you can pass the pointer of an already locally declared variable of a procedure to another procedure, that can access this variable.<br /><br />A parameter is marked as a pointer by specifying a leading asterisk (*) character at the beginning of the parameter's variable name. This asterisk does not belong the the name of the variable, it is just an identifying character telling RapidBATCH that you want to get a pointer as this parameter.The following script shows how pointers are declared, specified and used in a simple procedure:<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem procedure for writing a string over a pointer to a variable</font><br /><b>proc</b> get_new_value: <font color="#000080">[*a]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'The value of [a] is currently: '</font> # <font color="#000080">[a]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[a]</font> = <font color="#0000ff">'This is a new value written over the pointer.'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'The value of [a] is now: '</font> # <font color="#000080">[a]</font><br /><b>endproc</b><br /><br /><font color="#808080">rem main script part</font><br /><font color="#000080">[test]</font> = <font color="#0000ff">'Hello World'</font><br />echo <font color="#0000ff">'The value of [test] is currently: '</font> # <font color="#000080">[test]</font><br />get_new_value <font color="#000080">[test]</font><br />echo <font color="#0000ff">'The value of [test] is now: '</font> # <font color="#000080">[test]</font><br /><b>end</b></div><!-- code END-->As already mentioned above, pointers are also the only way to process on external arrays within procedures. The best example is the procedure &quot;viewArray&quot; defined in the RapidBATCH array help function library, ARRAY.RB.<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem viewArray :: displays all elements of an array on the screen</font><br /><b>proc</b> viewArray: <font color="#000080">[*array]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>dec</b> <font color="#000080">[i]</font>,<font color="#000080">[text]</font><br /><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem on error, exit procedure!</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[array:'0']</font> = <font color="#0000ff">'0'</font> <b>ret</b><br /><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem build the string that will be displayed</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>repeat</b><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[i]</font> = <font color="#000080">[i]</font> + <font color="#0000ff">'1'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[text]</font> # <font color="#0000ff">'Index '</font> # <font color="#000080">[i]</font> # <font color="#0000ff">': '</font> # <font color="#000080">[array[i]]</font> # <font color="#000080">[new_line]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>until</b> <font color="#000080">[i]</font> = <font color="#000080">[array'0']</font><br /><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem output the string in a messagebox</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#000080">[text]</font><br /><b>endproc</b><br /><br /><font color="#808080">rem --- main script part</font><br /><font color="#808080">rem declare and fill an array of 10 elements</font><br /><b>dec</b> <font color="#000080">[names:'10']</font><br /><font color="#000080">[names:'1']</font> = <font color="#0000ff">'Neo'</font><br /><font color="#000080">[names:'2']</font> = <font color="#0000ff">'Trinity'</font><br /><font color="#000080">[names:'3']</font> = <font color="#0000ff">'Morpheus'</font><br /><font color="#000080">[names:'4']</font> = <font color="#0000ff">'Roy'</font><br /><font color="#000080">[names:'5']</font> = <font color="#0000ff">'Earl'</font><br /><font color="#000080">[names:'6']</font> = <font color="#0000ff">'Dagobert'</font><br /><font color="#000080">[names:'7']</font> = <font color="#0000ff">'Michael'</font><br /><font color="#000080">[names:'8']</font> = <font color="#0000ff">'Marty'</font><br /><font color="#000080">[names:'9']</font> = <font color="#0000ff">'Doc Brown'</font><br /><font color="#000080">[names:'10']</font> = <font color="#0000ff">'Einstein'</font><br /><br /><font color="#808080">rem display the array</font><br />viewarray <font color="#000080">[names]</font><br /><b>end</b></div><!-- code END-->As a matter of course you can also change any element in any dimension using the pointer, like if you work with an ordinary array variable. The next script squares every element of the array and writes the result back to the same element.<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem viewArray :: displays all elements of an array on the screen</font><br /><b>proc</b> viewArray: <font color="#000080">[*array]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>dec</b> <font color="#000080">[i]</font>,<font color="#000080">[text]</font><br /><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem on error, exit procedure!</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[array:'0']</font> = <font color="#0000ff">'0'</font> <b>ret</b><br /><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem build the string that will be displayed</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>repeat</b><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[i]</font> = <font color="#000080">[i]</font> + <font color="#0000ff">'1'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[text]</font> # <font color="#0000ff">'Index '</font> # <font color="#000080">[i]</font> # <font color="#0000ff">': '</font> # <font color="#000080">[array[i]]</font> # <font color="#000080">[new_line]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>until</b> <font color="#000080">[i]</font> = <font color="#000080">[array'0']</font><br /><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem output the string in a messagebox</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#000080">[text]</font><br /><b>endproc</b><br /><br /><font color="#808080">rem square_array :: squares every element of an array</font><br /><b>proc</b> square_array: <font color="#000080">[*array]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>dec</b> <font color="#000080">[i]</font>, <font color="#000080">[text]</font><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[array:'0']</font> = <font color="#0000ff">'0'</font> <b>ret</b><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>repeat</b><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[i]</font> + <font color="#0000ff">'1'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[array:[i]]</font> * <font color="#000080">[array:[i]]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>until</b> <font color="#000080">[i]</font> = <font color="#000080">[array:'0']</font><br /><b>endproc</b><br /><br /><font color="#808080">rem --- main script part</font><br /><font color="#808080">rem create randomized values between 0 and 100</font><br /><font color="#000080">[i]</font> = <font color="#0000ff">'0'</font><br /><b>repeat</b><br />&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[i]</font> + <font color="#0000ff">'1'</font><br /><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem calling the random number generator</font><br />&nbsp;&nbsp;&nbsp;&nbsp;randvar <font color="#000080">[some_numbers:[i]]</font> = <font color="#0000ff">'100'</font><br /><b>until</b> <font color="#000080">[i]</font> = <font color="#0000ff">'5'</font><br /><br /><font color="#808080">rem display the values</font><br />viewarray <font color="#000080">[some_numbers]</font><br /><br /><font color="#808080">rem square the values</font><br />square_array <font color="#000080">[some_numbers]</font><br /><br /><font color="#808080">rem display the values again</font><br />viewarray <font color="#000080">[some_numbers]</font><br /><b>end</b></div><!-- code END-->It is also possible to pass an already existing pointer to another procedure pointer. For example, when you call a procedure using a pointer, this procedure can call a completely other procedure by passing its pointer as a pointer-pointer to the next procedure call. These chains of pointers can be repeated (theoretically) infinitely.<br /><br />

		<div class="line">&nbsp;</div>

		<div id="copyright">
			Copyright &copy; 2000-2006 by J.M.K S.F. Software Technologies, Jan Max Meyer<br />
			All rights reserved.
		</div>
	</body>
</html>
