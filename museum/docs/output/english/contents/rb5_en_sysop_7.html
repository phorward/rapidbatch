<html>
	<head>
		<title>Using pre-declared variables</title>
		<link rel="stylesheet" href="jmksf.css" type="text/css"></link>
	</head>

	<body>
		<div id="top">
			<img src="rb5.png" alt="RapidBATCH Logo" />
			Using pre-declared variables
		</div>
		
		<div class="line">&nbsp;</div>
		
		Maybe the chapter &quot;system operations&quot; is not the right place to discuss all pre-declared variables RapidBATCH provides, but many of the pre-declared variables are dealing with system-specific purposes. Until now, you had already learned some of the so called &quot;pre-declated variables&quot;. Pre-declared variables are automatically created and filled by the interpreter at the start-up of each script that is executed. Some of the pre-declared variables can be changed, others are directly evaluated when they are called.<br />In this chapter, I don't want to discuss all, system-specific variables RapidBATCH provides, but the most important ones. To get detailed information on every of the pre-declared variables RapidBATCH provides, take a look into the reference manual.<br /><br />Oftenly it is required to pass parameters, for example options or processing informations to a program over its command-line call. This feature may not miss in RapidBATCH! The variable [command] contains all parameters which where passed on to the script file or compiled program at its start-up. If the script is executed by the interpreter, [command] contains all parameters that where specified behind the script's file name at the interpreter call (RBI32.EXE), in compiled scripts (stand-alone EXE-files), all parameters specified behind the exe-file's name can be determined from [command].<br />A good example is the following script. It simply outputs the content of [command] in a ECHO-messagebox. For testing and debugging purposes, the RapidBATCH Builder directly provides a function you can call over the &quot;Script&quot;-menu by choosing the menu item &quot;Set [command]...&quot;. A dialog will open where you can enter any desired value that is assigned by RapidBATCH Builder to the script each time it is executed.<br /><br /><!-- code BEGIN --><div class="code">echo <font color="#0000ff">'Command-line parameters passed to this script call: '</font> # <font color="#000080">[command]</font><br /><b>end</b></div><!-- code END--><div class="image"><img src="img/sysop_pdvar1.gif" alt="Function to enter command-line parameters directly from RapidBATCH Builder" title="Setting command-line parameters" /><br />The function &quot;Set [command]...&quot; is very useful to easily assign command-line parameters...</div><div class="image"><img src="img/sysop_pdvar2.gif" alt="Displaying the assigned command-line parameters." title="Displaying [command]" /><br />...with success!</div><div class="remark">Note: The values that are assigned to [command] can be directly transferred into an array of parameters by calling the procedure <i>GETCMDLINEPARMS</i> from the SYSTEM.RB extending function library.</div><!-- Geilo: Groove Coverage - Force Of Nature h&ouml;r *fieps* -->Your script should handle with texts from the clipboard? By performing a simple assignment of a value to the variable [clipboard], the value can be made accessable to all applications the current user is running. By reading [clipboard], values other applications copied to the clipboard can be read and used within the script.<br /><br />A simple example is the following script, that copies a value into the clipboard and directly demonstrates its use in a Notepad editor, by pasting it remotely.<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem show me the current content of the clipboard</font><br />echo <font color="#0000ff">'Currently in the clipboard: '</font> # <font color="#000080">[clipboard]</font><br /><br /><font color="#808080">rem let's write a "Hello World" into the clipboard!</font><br /><font color="#000080">[clipboard]</font> = <font color="#0000ff">'Hello World by RapidBATCH'</font><br />echo <font color="#0000ff">'New content of the clipboard: '</font> # <font color="#000080">[clipboard]</font><br /><br /><font color="#808080">rem demonstrating the clipboard's content in Notepad</font><br />shell <font color="#000080">[windir]</font> # <font color="#0000ff">'\notepad.exe'</font>, <font color="#0000ff">'show'</font><br />wait <font color="#0000ff">'500'</font><br />sendkeys <font color="#000080">[active_window]</font>: <font color="#0000ff">'The current content of the clipboard is: #271v#017'</font><br /><b>end</b></div><!-- code END-->And there you can also find the next, pre-declared variable in the above script: [active_window]! [active_window] contains the title bar's text of the currently activated window, so in the above case it will contain &quot;Untitled - Notepad&quot;. The advantage of this variable is, that the script can be run language idependend. For example, in the german version of Windows XP, Notepad's title is &quot;Unbenannt - Editor&quot; instead of &quot;Untitled - Notepad&quot;.<br />Next to [active_window], the above script uses the variable [windir], containing the path to the Windows system directory, where notepad.exe is stored to.<br /><br />Reading the system date and system time is also no problem for RapidBATCH. The following script displays a clock, showing the current date and time, using the INFOBOX dialog. The clock will appear for 10 seconds until the script stops, and shows its informations to the second.<br /><br /><!-- code BEGIN --><div class="code"><font color="#000080">[i]</font> = <font color="#0000ff">'0'</font><br /><b>repeat</b><br />&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[i]</font> + <font color="#0000ff">'1'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;infobox <font color="#0000ff">'It is '</font> # <font color="#000080">[time]</font> # <font color="#0000ff">' on '</font>  # <font color="#000080">[month]</font> # <font color="#0000ff">'/'</font> # <font color="#000080">[day]</font> # <font color="#0000ff">'.'</font> # <font color="#000080">[year]</font>, <font color="#0000ff">'show'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;wait <font color="#0000ff">'1000'</font><br /><b>until</b> <font color="#000080">[i]</font> = <font color="#0000ff">'10'</font><br /><b>end</b></div><!-- code END-->The variable [time] contains the current time and is updated with the current system time always when it is called. The format [time] uses is &quot;HH:MM:SS&quot;, for example &quot;13:37:45&quot;. The date information has been explicitly splitted to three variables: [day], [month] and [year]. This has been done for a fast date formatting, because RapidBATCH is an internationally provided product, and its scripts should be easily written for optimal language customization. For example, here in Germany, we write dates in the format &quot;DD.MM.YYYY&quot;, in western countries it is &quot;MM/DD/YYYY&quot; or another formatting. So the division into three variables is the best possibility for a fast and completely individual date output formatting.<br /><br /><div class="image"><img src="img/sysop_pdvar3.gif" alt="Displaying the current time and date within an INFOBOX-dialog window." title="The current time and date within an INFOBOX-dialog." /><br />The current time and date within an INFOBOX-dialog.</div>Oftenly it is also required to output special characters to files or even into messagebox-windows or dialogs. For this purpose, there had been five special character variables implemented which are the time-safing alternative instead of getting and building these values using the GETCHR-function with the particular ASCII-character codes. First of all, there is the [new_line]-variable. It contains a single line break (character code 10) and can be used both for files and for dialog outputs. On Windows operating systems, there is also a special line break used within files (e.g. text files) that is called Carriage Return/Line Feed (character codes 13 and 10). These two names, carriage return and line feed, are relicts from the stone age of the computer, where data and program output was primarily outputted to printers. There, a carriage return with a trailing line feed character was necessary to generate a line break. On Unix-based systems, the single line break as provided by [new_line] is the default, on Windows-like systems it is carriage return and line feed, that is provieded by the variable [crlf].<br />Next to [new_line] and [crlf], RapidBATCH provides the variable [tab] that contains a tabulator character as well as the variable [pipe], containing a pipe-character (|) that is primarily used as RapidBATCH default list separator at LISTBOX or PUTFILE, and many other functions and instructions. The last variable, [quot], contains the single quotation character (') that is used in the RapidBATCH script-code to separate strings. Using [quot], it can be displayed and saved into strings.<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem line breaks</font><br />echo <font color="#0000ff">'This is a'</font> # <font color="#000080">[new_line]</font> # <font color="#0000ff">'line break using'</font> # <font color="#000080">[crlf]</font> # <font color="#0000ff">'two methods'</font><br /><br /><font color="#808080">rem tabulators</font><br />echo <font color="#0000ff">'It is a '</font> # <font color="#000080">[tab]</font> # <font color="#0000ff">'tabulator!'</font><br /><br /><font color="#808080">rem pipe-character</font><br />echo <font color="#0000ff">'The as '</font> # <font color="#000080">[std_sep]</font> # <font color="#0000ff">' defined character is a '</font> # <font color="#000080">[pipe]</font> # <font color="#0000ff">' by default'</font><br /><br /><font color="#808080">rem quotation mark</font><br />echo <font color="#0000ff">'That'</font> # <font color="#000080">[quot]</font> # <font color="#0000ff">'s it!'</font></div><!-- code END-->Also known from the previous chapters is the variable [errorcode], which mostly receives the value '0' for &quot;true&quot; or &quot;operation succeeded&quot; or '-1' for &quot;false&quot; or &quot;operation failed&quot; (the only exceptions are the instructions SHELL and CALL, returning the program's PID at success instead of '0'). To verify this value in a more professional and dynamic way, there had been introduced the variables [true] (containing a '0') and [false] (containing a '-1') to be verified within an [errorcode] examination-condition. By using these variables, you also contribute for a better code readability.<br /><br /><!-- code BEGIN --><div class="code">chdir <font color="#0000ff">'C:\test'</font><br /><br /><b>if</b> <font color="#000080">[errorcode]</font> = <font color="#000080">[false]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Error, not able to change directory!'</font><br /><b>else</b><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'The directory change succeeded!'</font><br /><b>endif</b></div><!-- code END-->In the end of this chapter I want to discuss a variable that does, in the truest sense of the word, nothing: [null]! This variable has for example the purpose to catch return-values of functions (mostly self-implemented functions) that are not needed or to assign an emptystring instead of specifying &quot;''&quot; to a procedure, instruction or function. The advantage is, that the use of this variable for parameters or return values that are not needed is directly caught, and superfluous memory resources are saved.<br /><br />

		<div class="line">&nbsp;</div>

		<div id="copyright">
			Copyright &copy; 2000-2006 by J.M.K S.F. Software Technologies, Jan Max Meyer<br />
			All rights reserved.
		</div>
	</body>
</html>
