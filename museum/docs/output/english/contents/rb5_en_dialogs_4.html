<html>
	<head>
		<title>Dialogs for file- and folder-selection</title>
		<link rel="stylesheet" href="jmksf.css" type="text/css"></link>
	</head>

	<body>
		<div id="top">
			<img src="rb5.png" alt="RapidBATCH Logo" />
			Dialogs for file- and folder-selection
		</div>
		
		<div class="line">&nbsp;</div>
		
		Not rarely, it is especially when writing system maintainance scripts, required to ask the user for pathes, e.g. to filenames or folders. The usage of the INPUTBOX may be one possility to do this, but here, the user has to know the complete path to a file or directory, so that such a solution won't be the kindliest way for the user. But here, RapidBATCH will also support you with three great dialogs: OPENBOX, SAVEBOX and FOLDERBOX!<br /><br />The dialogs OPENBOX and SAVEBOX make it possible to select or enter a filename and to browse through the computer's file system. Additionally, a file-filter can be defined, displaying only a special group of files, following a pattern that is defined by a so called filter definition. This filter is set by using wildcards, * and ?, as it is known from the DOS prompt's dir-command.<br /><br />The following example script provides a file open dialog to select any file from the filesystem. The path to this file is displayed in the following ECHO-dialog.<br /><br /><!-- code BEGIN --><div class="code">openbox <font color="#000080">[file]</font> = <font color="#0000ff">'Please select a file...'</font>, <font color="#0000ff">'View all files|*.*'</font><br />echo <font color="#0000ff">'The path to your file is: '</font> # <font color="#000080">[file]</font><br /><b>end</b></div><!-- code END--><div class="image"><img src="img/openbox.gif" alt="Screenshot of an OPENBOX-dialog" title="The OPENBOX-Dialog" /><br />The OPENBOX function at run-time, presenting an &quot;Open file&quot;-dialog to the user</div>Equivalently to all of the yet disussed dialogs, OPENBOX (same behavior at SAVEBOX) returns an empty-string when the filename input-field was left blank, the dialog's close-button was pressed or the cancel-button was clicked. Else, the selected filename is returned and stored to the return variable in front of the parameter list. As parameters, both functions expect a dialog title, which can be a prompting text, and the above mentioned file filter, that needs to be specified as a list of items again in the following order:<br /><br /><b>Filter description or labeling | Filter</b><br /><br />The above script creates a filter *.* (= this whill filter all files having a file extension) and names it &quot;View all files&quot;. If we now only want to filter text-files (with the .TXT file extension), the following filter must be used:<br /><br /><b>Text-files|*.txt</b><br /><br />OPEN- and SAVEBOX allow both to switch between different filters, if more than one is given. To specify more than one file-filer, just add another filter, separated by a pipe-character (or the as [std_sep] defined standard separation character for lists) to the previous one. The following line shows how a filter is defined to switch between filters for EXE-files, COM-files and BAT-files.<br /><br /><b>EXE-Files|*.exe|COM-Files|*.com|Batch-Files|*.bat</b><br /><br />It is also possbile to use different filter masks under one general filter name. For this, each filter must be separated by a colon (;). The following filter displays all executable files (.EXE, .COM, .BAT) under the general filter name &quot;Executable files&quot;, and additionally provides another filter for viewing all types of files.<br /><br /><b>Executable files|*.exe;*.com;*.bat|All files|*.*</b><br /><br />By default, OPENBOX and SAVEBOX do only allow to select one file. But to allow a multiple selection of files, RapidBATCH provides the pre-declared variables [OpenBox_MultiSel] and [SaveBox_MultiSel]. If the corresponding variable for the desired dialog is set to 0 before the function is executed, more than one file can be selected. The selected files are returned as a list of items with this speciality: To save memory space, the first element of the list contains the path of the folder to the files the user selected, the next, by pipe-characters separated list items, are the single filenames within this folder.<br /><br />The following script demonstrates how multiple file selection are processed.<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem allow multiple file selection on the OPENBOX-dialog</font><br /><font color="#000080">[OpenBox_MultiSel]</font> = <font color="#0000ff">'0'</font><br /><br /><font color="#808080">rem let the user select the files</font><br />openbox <font color="#000080">[file_list]</font> = <font color="#0000ff">'Select multiple files'</font>, <font color="#0000ff">'All files|*.*'</font><br /><br /><b>if</b> <font color="#000080">[file_list]</font> ! <font color="#0000ff">''</font><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem read the path</font><br />&nbsp;&nbsp;&nbsp;&nbsp;gettok <font color="#000080">[path]</font> = <font color="#000080">[file_list]</font>, <font color="#0000ff">'|'</font>, <font color="#0000ff">'1'</font><br /><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem read the files list</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[i]</font> = <font color="#0000ff">'1'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>repeat</b><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[i]</font> + <font color="#0000ff">'1'</font><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rem read next file</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gettok <font color="#000080">[file]</font> = <font color="#000080">[file_list]</font>, <font color="#0000ff">'|'</font>, <font color="#000080">[i]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[file]</font> ! <font color="#0000ff">''</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'File No. '</font> # (<font color="#000080">[i]</font> - <font color="#0000ff">'1'</font>) # <font color="#0000ff">': '</font> # <font color="#000080">[path]</font> # <font color="#0000ff">'\'</font> # <font color="#000080">[file]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>elseif</b> <font color="#000080">[file]</font> = <font color="#0000ff">''</font> & <font color="#000080">[i]</font> = <font color="#0000ff">'2'</font><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rem if the user selected only one file, the file name is</font><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rem already stored in [path]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'The only chosen file is: '</font> # <font color="#000080">[path]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>endif</b><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>until</b> <font color="#000080">[file]</font> = <font color="#0000ff">''</font><br /><b>endif</b></div><!-- code END--><div class="image"><img src="img/openbox_multisel.gif" alt="Selection of multiple files within an OPENBOX-dialog" title="OPENBOX-dialog with multiple selections" /><br />Multiple selection of files within a &quot;File open&quot;-dialog</div>If [OpenBox_MultiSel] or [SaveBox_MultiSel] is set back to '-1' again, the dialog will support single file selection only.<br /><br />In many applications, the user don't wants to miss the comfort of a default file extension, that is automatically appended to the inserted filename without explicitly specifying it. For this comfort, RapidBATCH provides the pre-declared variables [OpenBox_DefFileExt] and equivalently again to SAVEBOX, [SaveBox_DefFileExt]. By setting this variable to a desired default-file extension (without the dot in front of it!), the respective dialog will append this extension to the returned filename automatically, if it is not given.<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem setting the default-extension for SAVEBOX: txt-file</font><br /><font color="#000080">[SaveBox_DefFileExt]</font> = <font color="#0000ff">'txt'</font><br /><br /><font color="#808080">rem asking for the filename</font><br />savebox <font color="#000080">[file]</font> = <font color="#0000ff">'Save file as...'</font>, <font color="#0000ff">'Text files|*.txt'</font><br /><br />echo <font color="#0000ff">'Filename (with extension!): '</font> # <font color="#000080">[file]</font></div><!-- code END--><div class="image"><img src="img/folderbox.gif" alt="Effortless selection of directories within the file system, using the FOLDERBOX-dialog" title="FOLDERBOX-dialog" /><br />Effortless and professional selection of a folder, using the FOLDERBOX-function.</div>Next to OPENBOX and SAVEBOX, RapidBATCH also provides the FOLDERBOX-function to let the user select a directory from the file-system. Return value is the absolute path to the selected folder. As parameters, FOLDERBOX expects a prompting text for the dialog, and an optional default path, that is automatically opened by default at dialog start up.<br />The following script opens a FOLDERBOX-dialog in the Windows system directory.<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem selecting a folder</font><br />folderbox <font color="#000080">[folder]</font> = <font color="#0000ff">'Please select a folder:'</font>, <font color="#000080">[windir]</font><br /><br /><font color="#808080">rem the return value is the absolute path to the selected folder</font><br /><b>if</b> <font color="#000080">[folder]</font> ! <font color="#0000ff">''</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'The selected folder is: '</font> # <font color="#000080">[folder]</font><br /><b>else</b><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'You did not selected any folder.'</font><br /><b>endif</b></div><!-- code END-->Same as in all the other build-in dialogs, FOLDERBOX will also return an empty-string when the user hits the dialog's close- or cancel-button, else the absolute folder path.<br /><br />

		<div class="line">&nbsp;</div>

		<div id="copyright">
			Copyright &copy; 2000-2006 by J.M.K S.F. Software Technologies, Jan Max Meyer<br />
			All rights reserved.
		</div>
	</body>
</html>
