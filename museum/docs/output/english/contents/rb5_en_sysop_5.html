<html>
	<head>
		<title>Controlling applications remotely</title>
		<link rel="stylesheet" href="jmksf.css" type="text/css"></link>
	</head>

	<body>
		<div id="top">
			<img src="rb5.png" alt="RapidBATCH Logo" />
			Controlling applications remotely
		</div>
		
		<div class="line">&nbsp;</div>
		
		Another, effective possibility of automation is the controlling of other applications remotely. RapidBATCH has the possibility to let any other application (even other RapidBATCH scripts ;)) think, the user is typing keystrokes to use the program, but in reality, the RapidBATCH script gives the commands. For this purpose, RapidBATCH provides the SENDKEYS-instruction to control other applications by using an easy-to-use command language for sending keystrokes and key commands as they are fed from the computer's keyboard.<br />The following script demonstrates how to control the Windows editor &quot;Notepad&quot;. It runs Notepad and prints the text &quot;Hello World&quot; into the edit window. Then it saves the file as TEST.TXT and aborts Notepad again. The script's code:<br /><br /><!-- code BEGIN --><div class="code">shell <font color="#000080">[windir]</font> # <font color="#0000ff">'\notepad.exe'</font>, <font color="#0000ff">'show'</font><br />sendkeys <font color="#0000ff">'Untitled - Notepad'</font>, <font color="#0000ff">'Hello World^(alt)fstest.txt(enter)^(alt)(f4)'</font><br /><b>end</b></div><!-- code END-->As its first parameter, SENDKEYS expects the title of the application window where the keystrokes should be send to. If you want to send keystrokes to the currently activated window, use the RapidBATCH system-variable [active_window], containing the active window's text in the title-bar.<br />The next parameter contains commands in the already mentioned macro command language, that are send to the specified application.<br /><br />So let's go a little bit deeper into this command language by using our example from above:<br /><br /><center>	<table class="std">	<tr>		<td>			<b>Sections:</b>		</td>		<td align="center">			A		</td>		<td align="center">			B		</td>		<td align="center">			C		</td>		<td align="center">			D		</td>	</tr>	<tr>		<td>			<b>Commands:</b>		</td>		<td align="center">			Hello World		</td>		<td align="center">			^(alt)fs		</td>		<td align="center">			test.txt(enter)		</td>		<td align="center">			^(alt)(f4)		</td>	</tr>	</table></center><br /><ul>	<li>		<b>Section A:</b><br />		At this point, we simply send the text &quot;Hello World&quot; to Notepad's edit field. It is important to first check if the input-cursor of the application you want to send text to is in the correct field. In the case of Notepad, the cursor is always directly set to the edit field to immediatelly start to enter text.<br />	</li>	<li>		<b>Section B:</b><br />		Now we want to open the &quot;Save as...&quot;-dialog to store the typed text to a text-file. For this case, we have to press ALT and D at the same time on a natural keyboard. To emulate this behavior in RapidBATCH, we first push down the ALT-key and hold it. This is done by prefixing a circumflex-character to the desired key that should be pressed. Because the ALT-key is a special sort of key, this key is specified by putting it into parentheses, so the internal macro language interpreter of the SENDKEYS-instruction knows that you don't want to send the text &quot;alt&quot;, but you want to send the ALT-key.<br />One important thing at this point: To send a left-parenthese as a character to a program, you must prefix this by a tilde-charactter (~). So the keystroke command &quot;~(&quot; will send a left-parenthese. Same with the curcumflex-character and even with the tilde-character itself. To send a circumflex, write &quot;~^&quot;, to send a single tilde, write &quot;~~&quot;.<br /><br />Ok, now that we are pressing and holding the ALT-key at this point, we immediatelly send an &quot;f&quot; to let Notepad open its File-menu. When this &quot;d&quot; is sent, all keys that where hold down before are left again. If you want to hold more than one key at one time, you have to prefix a circumflex to each of the desired keys, so for example, the keystroke CTRL+ALT+DEL is specified in RapidBATCH's SENDKEYS-macro notation as &quot;^(control)^(alt)^(del)&quot;.<br />To open the &quot;Save as...&quot; dialog, we simply send an &quot;s&quot afterwards. To find out which keys you have to press - especially in menus - watch out for the underlined characters. For example, the &quot;s&quot is the shortcut for the menu item &quot;Save&quot; in the Notepad-Editor's file menu.<br />	</li>	<li>		<b>Section C:</b><br />		Now, after opening the &quot;Save as...&quot;-dialog, we &quot;type&quot; in the filename, in this case &quot;test.txt&quot;, via SENDKEYS. Because this is even an ordinary text, no special characters are required. To confirm our input we then press the Enter key, which automatically activates the &quot;Save&quot;-button of the &quot;Save as...&quot;-dialog. This is done by simply specifying the command <i>(enter)</i>.<br />	</li>	<li>		<b>Section D:</b><br />		At the end, we send an ALT+F4, to close the application. Because ALT+F4 need to be pressed at the same time, we hold down ALT first (by specifying <i>^(alt)</i>), and then we press F4, by specifying <i>(f4)</i>. By the way, it is a damn how you write special key commands. You can specify (Alt) same als (ALT) and (AlT) - it will always identify the ALT-key!<br />	</li></ul><br />To get an overview about the possible special keys and their naming, take a look into the RapidBATCH language reference.<br /><br /><br />Next to SENDKEYS, RapidBATCH provides another possibilty to control other applications by remote: The MOUSEEVENT-instruction. MOUSEEVENTS lets you simulate any mouse events on your screen. The RapidBATCH-script can get the full control over the mouse of the computer and can take any mouse events like moves, clicks, doubleclicks or mouse key holds.<br /><br />Please note, that I only want to give a short introducion to this possibility, because it is not possible to create a well running demo-script using MOUSEEVENT that can be run the same way on any Windows-system RapidBATCH supports, additionally the different screen resolutions and languages. This means, that you should only use this feature within your scripts if you're sure that it runs on all systems your script is used on.<br /><br />The following call of MOUSEEVENT centers the cursor on the screen, using the variables [ScreenWidth] and [ScreenHeight] to retrieve the current screen resolution.<br /><br /><!-- code BEGIN --><div class="code">mouseevent <font color="#0000ff">'move'</font>, (<font color="#000080">[ScreenWidth]</font>/<font color="#0000ff">'2'</font>) # <font color="#0000ff">'|'</font> # (<font color="#000080">[ScreenHeight]</font>/<font color="#0000ff">'2'</font>)</div><!-- code END-->As you can get from the line above, MOUSEEVENT expects two parameters. The first one is the so called mouse action identifier, and second one the screen coordinates which are again specified as a list here in the format &quot;X|Y&quot;, where X and Y is the pixel position on the corresponding axis. Here, the mouse cursor is centered on the screen by specifing the half of the screen resolution on each of the two axes.<br /><br />As mouse action identifiers, you can specify one of the following values:<ul>  <li>'0' or 'MOVE' (move the mouse only, no click)</li>  <li>'1' or 'CLICK_LEFT' (perform single left-click)</li>  <li>'2' or 'DBLCLICK_LEFT' (perform double left-click)</li>  <li>'3' or 'CLICK_RIGHT' (perform single right-click)</li>  <li>'4' or 'DBLCLICK_RIGHT' (perform double right-click)</li>  <li>'5' or 'DOWN_LEFT' (hold left mouse key)</li>  <li>'6' or 'UP_LEFT' (leave left mouse key)</li>  <li>'7' or 'DOWN_RIGHT'  (hold right mouse key)</li>  <li>'8' or 'UP_RIGHT' (leave right mouse key)</li></ul><br /><br />

		<div class="line">&nbsp;</div>

		<div id="copyright">
			Copyright &copy; 2000-2006 by J.M.K S.F. Software Technologies, Jan Max Meyer<br />
			All rights reserved.
		</div>
	</body>
</html>
