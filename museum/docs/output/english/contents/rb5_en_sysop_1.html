<html>
	<head>
		<title>Running external programs</title>
		<link rel="stylesheet" href="jmksf.css" type="text/css"></link>
	</head>

	<body>
		<div id="top">
			<img src="rb5.png" alt="RapidBATCH Logo" />
			Running external programs
		</div>
		
		<div class="line">&nbsp;</div>
		
		Especially when developing batch programs it is frequently necessary to call external programs, automatizing certain methods to get the desired result. For this purpose, RapidBATCH provides even four different possibilities.<br /><br />First of all, there is the classic SHELL-instruction, which is used to start any program which will run parallely to the RapidBATCH script. SHELL expects as first parameter the absolute or relative path to the file that should be exectued, and as second parameter a so called show mode. This show mode defines the application window behavior at startup, but is not supported by every Windows program that can be run.<br />Possible show-mode values are 'SHOW', 'HIDE', 'MINIMIZED' and 'MAXIMIZED'. 'SHOW' displays the application's main window in its default size, 'HIDE' does not display the window, and is only recommended to use with programs or batch-files running in the background. The modes 'MINIMIZED' and 'MAXIMIZED' are minimizing or maximazing the window of the application that is executed.<br /><br />Take a look at the following script, running the Windows "Notepad" text editor.<br /><br /><!-- code BEGIN --><div class="code">shell <font color="#0000ff">'notepad.exe'</font>, <font color="#0000ff">'show'</font><br />echo <font color="#0000ff">'And now we run another Notepad with a maximized window!'</font><br />shell <font color="#0000ff">'notepad.exe'</font>, <font color="#0000ff">'maximized'</font><br />echo <font color="#0000ff">'Finished!'</font><br /><b>end</b></div><!-- code END-->Next to the SHELL-instruction, RapidBATCH is also providing the CALL-instruction. CALL is nearly equal to SHELL, and also expects the same parameters, but it features one important thing that SHELL is not featuring: CALL runs a program in a modal-mode; This means, that the RapidBATCH-script that executes an external program or DOS command using CALL, is halted until the called program is finished or closed by the user. <br /><br />This is an example, running Notepad again via CALL.<br /><br /><!-- code BEGIN --><div class="code">call <font color="#0000ff">'notepad.exe'</font>, <font color="#0000ff">'show'</font><br />echo <font color="#0000ff">'And now, we run Notepad again using another show mode...'</font><br />call <font color="#0000ff">'notepad.exe'</font>, <font color="#0000ff">'maximized'</font><br />echo <font color="#0000ff">'Ende!'</font><br /><b>end</b></div><!-- code END-->Oftenly it is also necessary to run the good old MS-DOS commands Windows features over the DOS prompt. There is also a way to do this using SHELL or CALL by running the CMD.EXE or COMMAND.COM command interpreter, but RapidBATCH does also feature a single instruction that directly allows the execution of any DOS commands: The SYSTEM-instruction.<br /><br />Example:<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem Pinging www.jmksf.de ...</font><br />system <font color="#0000ff">'ping www.jmksf.de'</font><br /><b>end</b></div><!-- code END-->By using CALL or SHELL, it is also possible to run DOS-commands in the background, without an upcoming DOS-box. The next example uses the READFILE-function to read out the file DIR wrote its output to. The READFILE-function will be discussed later in a more detailed way.<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem run DIR-command and save it temporary to test.txt</font><br />call <font color="#0000ff">'cmd.exe /C dir *.exe &gt;test.txt'</font>, <font color="#0000ff">'hide'</font><br /><br /><font color="#808080">rem read test.txt and display it</font><br />readfile <font color="#000080">[dir_output]</font> = <font color="#0000ff">'test.txt'</font>, <font color="#0000ff">'0'</font><br />echo <font color="#000080">[dir_output]</font><br /><br /><font color="#808080">rem finally, delete test.txt again!</font><br />delfile <font color="#0000ff">'test.txt'</font><br /><b>end</b></div><!-- code END--><div class="image"><img src="img/sysop_call_dir.gif" alt="Messagebox, displaying the output of the DIR-command, read from the file." title="Displaying system command outputs in an ECHO-dialog." /><br />The script from above, displaying the content of the current directory from the DIR-command within an ECHO-messagebox.</div><div class="remark">Note: When running the above script on Windows 95, 98 or Millenium Edition, the call of CMD.EXE must be replaced with COMMAND.COM, because Win 95/98/ME are not NT-based systems (like NT, 2000, XP and 2003) so that they use COMMAND.COM instead of CMD.EXE. The result of the script run will be the same on both system families.</div><br />The last, but also mostly primitive method to run external programs is the OPEN-instruction. OPEN can be used very versatile, e.g. it runs programs (same as a SHELL-instruction call using the mode 'SHOW'), opens documents with the corresponding program (e.g. by specifying a .DOC-file, the file is loaded to Word or WordPad) or opens internet URLs in the system's default-browser.<br /><br />Some examples using OPEN:<br /><br /><!-- code BEGIN --><div class="code">open <font color="#0000ff">'calc.exe'</font><br />open <font color="#0000ff">'C:\jmksf\rb5\license.txt'</font><br />open <font color="#0000ff">'http://www.rapidbatch.com'</font></div><!-- code END--><br /><br />

		<div class="line">&nbsp;</div>

		<div id="copyright">
			Copyright &copy; 2000-2006 by J.M.K S.F. Software Technologies, Jan Max Meyer<br />
			All rights reserved.
		</div>
	</body>
</html>
