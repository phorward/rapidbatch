<html>
	<head>
		<title>Recousive programming</title>
		<link rel="stylesheet" href="jmksf.css" type="text/css"></link>
	</head>

	<body>
		<div id="top">
			<img src="rb5.png" alt="RapidBATCH Logo" />
			Recousive programming
		</div>
		
		<div class="line">&nbsp;</div>
		
		When a procedure or function calls itself within its code, it performs a recoursive procedure call. Also the opposite call of two procedures is called a &quot;recoursion&quot;. When programming such structures, it is a must that a breaking condition is given, else the procedure calls itself (theoretically) again in a never-ending loop. The possibility of the recoursive programming provides a smart way of solving nested operations in a professional and quickly realized manner.<br /><br />As simple example of a recoursive executed program is the calculation of the factorial. For the calculation of the factoral, the following mathematical definition is given:<br /><ul/>	<li/>The factoral of the value zero is 1.</li/>         <li/>The factoral of an integer number, that is greater than 0 is the product of the number of the factoral of the next lower integer number.</li/></ul/><br />So let's write a script that calculates the factoral recoursively:<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem function "fac" to calculate the factoral</font><br /><b>func</b> fac: <font color="#000080">[x]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>dec</b> <font color="#000080">[result]</font><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[x]</font> = <font color="#0000ff">'0'</font><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rem this is the exit condition, no more</font><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rem recoursive call follows!</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[result]</font> = <font color="#0000ff">'1'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>else</b><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rem recoursive call of the function "fac"</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fac <font color="#000080">[result]</font> = <font color="#000080">[x]</font> - <font color="#0000ff">'1'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[result]</font> * <font color="#000080">[x]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>endif</b><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>ret</b> <font color="#000080">[result]</font><br /><b>endfunc</b><br /><br /><font color="#808080">rem first call of "fac", starting the recoursion</font><br />fac <font color="#000080">[factoral]</font> = <font color="#0000ff">'4'</font><br /><br /><font color="#808080">rem show the result</font><br />echo <font color="#0000ff">'The factoral of 4 is '</font> # <font color="#000080">[factoral]</font><br /><b>end</b></div><!-- code END-->That's already all! As you surely recognized, the function FAC calls itself again from its own body code, but with a to 1 decreased value of [x]. The exit condition is the case if the parameter [x] contains the value 0. If this happens, no more recoursions will follow, and the recoursion of the function is closed. A procedure or function can call itself more hundred - or even more thousand - of times again. All these calls are stored into an internal procedure call stack. By giving the breaking instruction, this stack will be closed call by call until the script can continue its execution behind the first, beginning call, of the recoursively called procedure. If no exit condition is given, the script (or even the entire operating system) will hang up caused by a memory overflow.<br /><br />To make the process of the recousion in our factorial-script more easier to undertand, let's insert some tracing messageboxes:<br /><br /><!-- code BEGIN --><div class="code"><font color="#000080">[rlevel]</font> = <font color="#0000ff">'0'</font><br /><br /><font color="#808080">rem function "fac" to calculate the factoral</font><br /><b>func</b> fac: <font color="#000080">[x]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>dec</b> <font color="#000080">[result]</font><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Calling fac in recoursion level '</font> # <font color="#000080">[rlevel]</font> # <font color="#0000ff">' with [x] = '</font> # <font color="#000080">[x]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[rlevel]</font> + <font color="#0000ff">'1'</font><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[x]</font> = <font color="#0000ff">'0'</font><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rem this is the breaking condition, no more</font><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rem recoursive call follows!</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[result]</font> = <font color="#0000ff">'1'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>else</b><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rem recoursive call of the function "fac"</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fac <font color="#000080">[result]</font> = <font color="#000080">[x]</font> - <font color="#0000ff">'1'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[result]</font> * <font color="#000080">[x]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>endif</b><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[rlevel]</font> - <font color="#0000ff">'1'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Leaving fac in recoursion level '</font> # <font color="#000080">[rlevel]</font> # <font color="#0000ff">' with [result] = '</font> # <font color="#000080">[result]</font><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>ret</b> <font color="#000080">[result]</font><br /><b>endfunc</b><br /><br /><br />echo <font color="#0000ff">'Script start...'</font><br /><br /><font color="#808080">rem first call of "fac", starting the recoursion</font><br />fac <font color="#000080">[factoral]</font> = <font color="#0000ff">'4'</font><br /><br />echo <font color="#0000ff">'Here, the script already closed the recoursion!'</font><br /><br /><font color="#808080">rem show the result</font><br />echo <font color="#0000ff">'The factoral of 4 is '</font> # <font color="#000080">[factoral]</font><br /><b>end</b></div><!-- code END-->This example also demonstrates the usage of local and global variables again: In every recoursive function call, all local variables of the function are re-declared and can be used with different values. As example, some thousand instances of the variable [x] can exist in the memory, but only the one in the current call of the function is the only valid one in the calling stack. Therefore, the values of the [x] instances below the current one can not be changed. If this would be possible, the recousive programming possibiliy - and also the whole model of structured programming - would be completely senseless.<br />In the opposite, we also use a global variable here, the variable [rlevel], showing us the recoursion level of the current call. This variable is global, and we increment (increase by one) it at the beginning of the function and decrement (decrease by one) it when the function call ends. When the script is executed, it can be recognized that the function calls itself for at least 5 times.<br /><br />The possibility of recoursive programming is very versatile and can also be very effective.<br />For example, to copy a complete directory, the procedure &quot;copydir&quot; was implemented into the RapidBATCH extending system functions library, SYSTEM.RB, and calls itself recoursively for each sub-directory.<br /><br /><!-- code BEGIN --><div class="code"><b>proc</b> copyDir: <font color="#000080">[source]</font>, <font color="#000080">[target]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>dec</b> <font color="#000080">[tok]</font>, <font color="#000080">[i]</font>, <font color="#000080">[files]</font><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;findfiles <font color="#000080">[files]</font> = <font color="#000080">[source]</font> # <font color="#0000ff">'\*'</font>, <font color="#0000ff">'1'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[files]</font> = <font color="#0000ff">''</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[errorcode]</font> = <font color="#0000ff">'-1'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>ret</b><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>endif</b><br />&nbsp;&nbsp;&nbsp;&nbsp;mkdir <font color="#000080">[target]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>repeat</b><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;calcvar <font color="#000080">[i]</font> = <font color="#000080">[i]</font> + <font color="#0000ff">'1'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gettok <font color="#000080">[tok]</font> = <font color="#000080">[files]</font>, <font color="#0000ff">'|'</font>, <font color="#000080">[i]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[tok]</font> ! <font color="#0000ff">''</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;getfileatt <font color="#000080">[isDir]</font> = <font color="#000080">[source]</font> # <font color="#0000ff">'\'</font> # <font color="#000080">[tok]</font>, <font color="#0000ff">'DIRECTORY'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[isDir]</font> = <font color="#0000ff">'0'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;copyDir <font color="#000080">[source]</font> # <font color="#0000ff">'\'</font> # <font color="#000080">[tok]</font>, <font color="#000080">[target]</font> # <font color="#0000ff">'\'</font> # <font color="#000080">[tok]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>else</b><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;copyfile <font color="#000080">[source]</font> # <font color="#0000ff">'\'</font> # <font color="#000080">[tok]</font>, <font color="#000080">[target]</font> # <font color="#0000ff">'\'</font> # <font color="#000080">[tok]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>endif</b><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>endif</b><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>until</b> <font color="#000080">[tok]</font> = <font color="#0000ff">''</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[errorcode]</font> = <font color="#0000ff">'0'</font><br /><b>endproc</b></div><!-- code END--><br /><br />

		<div class="line">&nbsp;</div>

		<div id="copyright">
			Copyright &copy; 2000-2006 by J.M.K S.F. Software Technologies, Jan Max Meyer<br />
			All rights reserved.
		</div>
	</body>
</html>
