<html>
	<head>
		<title>Creating an example application</title>
		<link rel="stylesheet" href="jmksf.css" type="text/css"></link>
	</head>

	<body>
		<div id="top">
			<img src="rb5.png" alt="RapidBATCH Logo" />
			Creating an example application
		</div>
		
		<div class="line">&nbsp;</div>
		
		As a demonstration on an implementation of a small, complete application using customized dialog windows in RapidBATCH, we will now write a number system converter. This small utility, let's call it the &quot;Bin/Oct/Hex Converter&quot;, should be able to convert values from the decimal number system into the binary, the octal and the hexadecimal number system and backward.<br /><br />To calculate the numbers of the different number systems, we use the functions &quot;base_to_decimal&quot; and &quot;decimal_to_base&quot;, defined in the RapidBATCH function library MATH.RB, because the focal point of this chapter is not the conversion of values into different number systems, but the usage and handling of the dialog-widgets, how they are merged together to a complete software application.<br /><br />First of all, however, I try to explain you the method of converting a decimal value into a binary value, to get you more involved in the purpose of our program. The decimal number system is the number system we daily use. It has 10 digits, (0,1,2,3,4,5,6,7,8,9), so we say, the decimal number system is hold to the base of 10. In contrast to this, there is the binary number system. The binary number system, that is used by every computer, has only two digits, 0 and 1, and is hold to the base of 2. We can store any number we have in decimal also in binary, but here, we need more digits to display one number. E.g. the decimal number &quot;1234&quot; is in binary &quot;10011010010&quot;. The calculation of this value is very easy: The base value, 1234, needs to be divided by the base of the target number system each time, until the rest value is completely 0. If you get a rest-value with a decimal place, the digit in the binary number system will be a 1. If there is no decimal place in your rest-value, you set a 0. Perform these steps with the integer rest of your rest-number only, until you reach a value of 0. Then, the entire number is converted into a binary number. By reversing this resulting string of digits you received (because the binary number is established from right to left), you're getting the desired number in the binary number system.<br />The other number systems are calculated the same way, but with other bases. The octal number system is hold to the base of 8, the hexadecimal number system is hold to the base of 16, where the digits 10, 11, 12, 13, 14 and 15 are replaced by A, B, C, D, E and F.<br /><br />Our converter program's user interface should now be made up as follows: A dialog-window with two input fields, where the upper one is to input and display the decimal number and the lower one is to input and display the value of the currently activated number system (binary, octal, hexadecimal). The target system should be changed over a menubar provided by the dialog, where the currently set conversion mode should be marked by a checkmark at the appropriate menu item. The conversion should be possible in both ways - that means when the user inputs a value in the decimal field, the value will be converted in the target number system or, when the user inputs a value (using the digits of the target system) into the target-system input field, it is converted into decimal. The conversion should be performed directly and &quot;live&quot; each time the user enters a digit in the particular input field.<br /><br />All these requirements to the program we want to create are no problem for RapidBATCH. For an experienced programmer, such an application is developed and finished in less than 15 minutes and a script file length of only 120 lines (including all commentars and empty lines ;)).<br /><br />As the first step in the development phase of this script we write a prototype. A prototype is a programmed and runable version of the user interface, but with no functionalities. Such a prototype is also a proven method to place and arrange the different widgets on the dialog window, making the user interface looking ergonomic and integrative.<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem PROTOTYPE: NO FUNCTIONALITY!!!</font><br /><br /><font color="#808080">rem --- creating and setting up the main window ---</font><br />newdialog <font color="#0000ff">'converter'</font>, <font color="#0000ff">'dialog'</font>, <font color="#0000ff">'1|1|270|100'</font><br /><br /><font color="#808080">rem set the dialog's title bar text and style</font><br />letdialog <font color="#0000ff">'converter'</font>, <font color="#0000ff">'caption'</font>, <font color="#0000ff">'Bin/Oct/Hex Converter'</font><br />letdialog <font color="#0000ff">'converter'</font>, <font color="#0000ff">'style'</font>, <font color="#0000ff">'single'</font><br /><br /><font color="#808080">rem assign menu tree</font><br /><font color="#000080">[menu]</font> = <font color="#0000ff">'&Mode:Decimal -&gt; &Binary|Decimal -&gt; &Octal|Decimal -&gt; &Hexadecimal;;'</font><br />letdialog <font color="#0000ff">'converter'</font>, <font color="#0000ff">'menu'</font>, <font color="#000080">[menu]</font><br /><br /><font color="#808080">rem --- creating input fields and labels ---</font><br /><br /><font color="#808080">rem label and input-field for the decimal number</font><br />newdialog <font color="#0000ff">'converter:l_decimal'</font>, <font color="#0000ff">'label'</font>, <font color="#0000ff">'5|8|100|22'</font><br />letdialog <font color="#0000ff">'converter:l_decimal'</font>, <font color="#0000ff">'caption'</font>, <font color="#0000ff">'Decimal value:'</font><br />newdialog <font color="#0000ff">'converter:decimal'</font>, <font color="#0000ff">'input'</font>, <font color="#0000ff">'110|4|150|25'</font><br />letdialog <font color="#0000ff">'converter:decimal'</font>, <font color="#0000ff">'font'</font>, <font color="#0000ff">'Sans Serif|10|2'</font><br /><br /><font color="#808080">rem label and input-field for the number in the target number system</font><br />newdialog <font color="#0000ff">'converter:l_target'</font>, <font color="#0000ff">'label'</font>, <font color="#0000ff">'5|34|100|22'</font><br />letdialog <font color="#0000ff">'converter:l_target'</font>, <font color="#0000ff">'caption'</font>, <font color="#0000ff">'Binary value:'</font><br />newdialog <font color="#0000ff">'converter:target'</font>, <font color="#0000ff">'input'</font>, <font color="#0000ff">'110|30|150|25'</font><br />letdialog <font color="#0000ff">'converter:target'</font>, <font color="#0000ff">'font'</font>, <font color="#0000ff">'Sans Serif|10|2'</font><br /><br /><font color="#808080">rem --- making the dialog visible ---</font><br />letdialog <font color="#0000ff">'converter'</font>, <font color="#0000ff">'visible'</font>, <font color="#000080">[true]</font><br /><br />rundialog <font color="#000080">[event]</font> = <font color="#0000ff">'0'</font><br /><b>end</b></div><!-- code END--><div class="image"><img src="img/conv_proto.gif" alt="Image of the running prototype" title="Screenshot" /><br />The already running prototype of the converter.</div>So let's go step-by-step trough the prototype script.<br /><br />First of all, we create a dialog basis window with a size of 270x100 pixels. In the following LETDIALOG-instructions we first set-up the dialog-title using the CAPTION-attribute, and then we set a so called dialog style using the STYLE-attribute. The &quot;SINGLE&quot;-style we are setting to the window in this case, changes the appeareance of the window insofar, that only a minimize-button and a close-button is available, because a maximize-button is not recommended to such a tiny application in this case. To get information on other style values, take a look to the RapidBATCH language reference.<br /><br />Last but not least, we assign a menu to the dialog, using the MENU-attribute at LETDIALOG. To create a menu, RapidBATCH uses a so called &quot;Menu-Descriptor&quot;, that describes the menu, the different items and levels. In this case, we create one menu-item &quot;Mode&quot; in the main menu bar, providing three selectable sub menu items (&quot;Decimal -> Binary&quot;, &quot;Decimal -> Octal&quot; and &quot;Decimal -> Hexadecimal&quot;). For more informations on menu bar descriptors and their definition, take a look at the RapidBATCH language reference.<div class="remark">Note: The RapidBATCH Visual Dialog Designer, as mentioned also in the introducion of the individual dialog development chapter, enables you to build such a menu in a comfort dialog window, where you can move and change the items. The Visual Dialog Designer then generates the necessary menu descriptor for the desired menu-tree.</div><br /><br />In the second part of the prototype script, we create four new widgets, in each case two input fields and two static text fields, displaying a description in front of the input-fields. By using the FONT-attribute at the followed LETDIALOG-instruction call, we set an alternative font type and size, here &quot;Sans Serif, 10 Pixels, Bold&quot; to each of the input-fields.<br /><br /><br />On the base of this prototype, we can now implement the functionalities to our script.<br /><br />First of all, we import the RapidBATCH library MATH.RB, providing the conversion routines &quot;decimal_to_base&quot; and &quot;base_to_decimal&quot;. Also, DIALOG.RB is imported, providing useful help functions for user defined dialog development, e.g. the &quot;centerdialog&quot;-procedure, centering a dialog on the screen. The import of these libraries is done as the first step in our script, using the INCLUDE-instruction.<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem --- importing library help functions ---</font><br /><font color="#008000">include 'math.rb'</font><br /><font color="#008000">include 'dialog.rb'</font></div><!-- code END-->The functions decimal_to_base and base_to_decimal, provided by the MATH.RB library, do each expect, as the second parameter, a string containing all digits of the number system the value should be calculated to or from; The amount of these digits automatically defines the number system's base that should be used. To define the three number systems for binary, octal and hexadecimal, we declare three global variables, containing these digits for each of the number system. The fourth variable, [current_base], is used to store the digits of the currently used number system, and is needed later when we implement event handling procedures.<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem --- global variables (bases and digits of the number systems) ---</font><br /><b>dec</b> <font color="#000080">[bin]</font>, <font color="#000080">[oct]</font>, <font color="#000080">[hex]</font>, <font color="#000080">[current_base]</font><br /><br /><font color="#808080">rem basis 2 (binary number system)</font><br /><font color="#000080">[bin]</font> = <font color="#0000ff">'01'</font><br /><font color="#808080">rem basis 8 (octal number system)</font><br /><font color="#000080">[oct]</font> = <font color="#0000ff">'01234567'</font><br /><font color="#808080">rem basis 16 (hexadecimal number system)</font><br /><font color="#000080">[hex]</font> = <font color="#0000ff">'0123456789ABCDEF'</font></div><!-- code END-->Before we implement the event handling now for the menu and the automatic &quot;live&quot; conversion of values, let's write two procedures, where each is reading out the corresponding input field, converts the value using the particular function to or from the currently set number system, and update this converted value in the corresponding text field. To keep up the simplicity, we call these two procedures &quot;calc_target_value&quot;, converting the value of the decimal field to the currently set number system, and &quot;calc_decimal_value&quot;, converting the number entered in the value field of the currently set number system to decimal again. In case of a calculation error (e.g. if a value contains invalid digits), both conversion functions base_to_decimal and decimal_to_base) return '-1'. In this case, we output the message &quot;Error&quot; in the particular conversion field, to let the user know that he entered a wrong digit or value.<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem --- implementation of the procedure "calc_target_value" ---</font><br /><b>proc</b> calc_target_value<br />&nbsp;&nbsp;&nbsp;&nbsp;<b>dec</b> <font color="#000080">[decimal]</font>, <font color="#000080">[convert]</font><br /><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem calculate value in the target number system from the decimal value</font><br />&nbsp;&nbsp;&nbsp;&nbsp;getdialog <font color="#000080">[decimal]</font> = <font color="#0000ff">'converter:decimal'</font>, <font color="#0000ff">'text'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[decimal]</font> ! <font color="#0000ff">''</font><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rem calculating the value</font><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rem (using the decimal_to_base-library function)</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decimal_to_base <font color="#000080">[target]</font> = <font color="#000080">[decimal]</font>, <font color="#000080">[current_base]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[target]</font> = <font color="#0000ff">'-1'</font> <font color="#000080">[target]</font> = <font color="#0000ff">'Error'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>endif</b><br /><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem set the calculated value to the target field</font><br />&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'converter:target'</font>, <font color="#0000ff">'text'</font>, <font color="#000080">[target]</font><br /><b>endproc</b><br /><br /><font color="#808080">rem --- implementation of the procedure "calc_decimal_value" ---</font><br /><b>proc</b> calc_decimal_value<br />&nbsp;&nbsp;&nbsp;&nbsp;<b>dec</b> <font color="#000080">[decimal]</font>, <font color="#000080">[target]</font><br /><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem calculating the decimal value from the currently activated number system</font><br />&nbsp;&nbsp;&nbsp;&nbsp;getdialog <font color="#000080">[target]</font> = <font color="#0000ff">'converter:target'</font>, <font color="#0000ff">'text'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[target]</font> ! <font color="#0000ff">''</font><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rem calculating the decimal value</font><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rem (using the base_to_decimal-library function)</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base_to_decimal <font color="#000080">[decimal]</font> = <font color="#000080">[target]</font>, <font color="#000080">[current_base]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[decimal]</font> = <font color="#0000ff">'-1'</font> <font color="#000080">[decimal]</font> = <font color="#0000ff">'Error'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>endif</b><br /><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem set the calculated value to the decimal field</font><br />&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'converter:decimal'</font>, <font color="#0000ff">'text'</font>, <font color="#000080">[decimal]</font><br /><b>endproc</b><br /><br /></div><!-- code END-->Before we now begin to write nearly the same event handling steps that need to be done when the number system should be changed for about three times, we simply implement another, third procedure performing these steps. This procedure, let's call it &quot;set_number_system&quot;, expects as parameter one of the three number system definitions we created as global variables later, when we use it in the event handling for the menu. The first step set_number_system performs is to remove the checkmarks from all menu items (only one menu item really has one!).<br />Menu attributes can be accessed and changed by using the widget-labels in the format &quot;<i>Dialog-Label</i>:Menu_<i>Menu-Item-Text</i>&quot;, that are automatically created by RapidBATCH when a menu-descriptor is assigned to a dialog-window. Please note, that these widget-labels that allow to access and change menu item attributes are only created to those items that are selectable in the menubar. Parenting menu-items, providing sub-menus, can't be selected or modified.<br />After the checkmark is removed from all items, it is set again to the particular menu item in the corresponding block of the IF-construction. Here, the static text in front of the input field of the target number system to be converted in, is also set to the particular number system name.<br /><br />At the end of the procedure, we assign the variable [current_base], that we defined above, to the new number system definition to be used for the following conversions, and directly call calc_decimal_value to update the value to the just changed number system. <br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem --- implementation of the procedure "set_number_system" ---</font><br /><b>proc</b> set_number_system: <font color="#000080">[number_system]</font><br /><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem removing the checkmarks from the menu items</font><br />&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'converter:Menu_Decimal -&gt; &Octal'</font>, <font color="#0000ff">'checked'</font>, <font color="#000080">[false]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'converter:Menu_Decimal -&gt; &Hexadecimal'</font>, <font color="#0000ff">'checked'</font>, <font color="#000080">[false]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'converter:Menu_Decimal -&gt; &Binary'</font>, <font color="#0000ff">'checked'</font>, <font color="#000080">[false]</font><br /><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem updating the label in front of the target fields, check the</font><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem particular menu item again</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[number_system]</font> = <font color="#000080">[bin]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'converter:l_target'</font>, <font color="#0000ff">'caption'</font>, <font color="#0000ff">'Binary value:'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'converter:Menu_Decimal -&gt; &Binary'</font>, <font color="#0000ff">'checked'</font>, <font color="#000080">[true]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>elseif</b> <font color="#000080">[number_system]</font> = <font color="#000080">[oct]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'converter:l_target'</font>, <font color="#0000ff">'caption'</font>, <font color="#0000ff">'Octal value:'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'converter:Menu_Decimal -&gt; &Octal'</font>, <font color="#0000ff">'checked'</font>, <font color="#000080">[true]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>elseif</b> <font color="#000080">[number_system]</font> = <font color="#000080">[hex]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'converter:l_target'</font>, <font color="#0000ff">'caption'</font>, <font color="#0000ff">'Hexadecimal value:'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'converter:Menu_Decimal -&gt; &Hexadecimal'</font>, <font color="#0000ff">'checked'</font>, <font color="#000080">[true]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>endif</b><br /><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem update the currently used base to the assigned value</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[current_base]</font> = <font color="#000080">[number_system]</font><br /><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem recalculate the target value</font><br />&nbsp;&nbsp;&nbsp;&nbsp;calc_target_value<br /><b>endproc</b></div><!-- code END-->Now, our nice little application is nearly finished. The only thing that is missing now is an event handling routine.<br /><br />For this, we first modify the section where we're creating the input fields for the values to a LETDIALOG call, switching the CHANGE-event for each input-field on. When the CHANGE-event is switched on, RUNDIALOG recognizes if anything in a text input-field is changed, e.g. when the user presses a key, so RUNDIALOG returns a corresponding event string. By default, the CHANGE event is turned of when a new widget with the INPUT-type is created. By using the value EVENT_&lt;Event-Name&gt; as attribute identifier, we can switch all events of a widget on or off (on = [true] or '0', off = [false] or '-1').<br /><br />After creating the input- and label-widgets and switching on the events, we perform a call of set_number_system with the [bin] variable as parameter, to the script directly switches to the binary number system as default conversion mode when the converter starts.<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem --- creating input fields and labels ---</font><br /><br /><font color="#808080">rem label and input-field for the decimal number</font><br />newdialog <font color="#0000ff">'converter:l_decimal'</font>, <font color="#0000ff">'label'</font>, <font color="#0000ff">'5|8|100|22'</font><br />letdialog <font color="#0000ff">'converter:l_decimal'</font>, <font color="#0000ff">'caption'</font>, <font color="#0000ff">'Decimal value:'</font><br />newdialog <font color="#0000ff">'converter:decimal'</font>, <font color="#0000ff">'input'</font>, <font color="#0000ff">'110|4|150|25'</font><br />letdialog <font color="#0000ff">'converter:decimal'</font>, <font color="#0000ff">'font'</font>, <font color="#0000ff">'Sans Serif|10|2'</font><br />letdialog <font color="#0000ff">'converter:decimal'</font>, <font color="#0000ff">'event_change'</font>, <font color="#000080">[true]</font><br /><br /><font color="#808080">rem label and input-field for the number in the target number system</font><br />newdialog <font color="#0000ff">'converter:l_target'</font>, <font color="#0000ff">'label'</font>, <font color="#0000ff">'5|34|100|22'</font><br />newdialog <font color="#0000ff">'converter:target'</font>, <font color="#0000ff">'input'</font>, <font color="#0000ff">'110|30|150|25'</font><br />letdialog <font color="#0000ff">'converter:target'</font>, <font color="#0000ff">'font'</font>, <font color="#0000ff">'Sans Serif|10|2'</font><br />letdialog <font color="#0000ff">'converter:target'</font>, <font color="#0000ff">'event_change'</font>, <font color="#000080">[true]</font><br /><br /><font color="#808080">rem by default, use binary number system</font><br />set_number_system <font color="#000080">[bin]</font></div><!-- code END-->For the sake of completeness, we center the dialog window on the screen, using the procedure &quot;centerdialog&quot; provided by the above imported DIALOG.RB library, and set the input-focus to the decimal input field and make the dialog window visible.<br /><br />In the event handling routine, that we realize here again as in our first script with a customized dialog window using a REPEAT...UNTIL loop, the script performs a leading RUNDIALOG call waiting for events first, and then verifies the corresponding of the only six possible events, that can occur, using an IF...ELSEIF...ENDIF-construction. Because of our excellent implementation of the three procedures calc_target_value, calc_decimal_value and set_number_system, we just need to call them - in case of set_number_system with the particular number system as parameter - in each event.<br /><br /><div class="image"><img src="img/converter.gif" alt="The finished converter program in action!" title="Screenshot" /><br />The finished version of the Hex/Oct/Bin Converter.</div>Now, nothing more needs to be done, and our number system converter is finished:<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem ********************************************</font><br /><font color="#808080">rem ** Bin/Oct/Hex Converter&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**</font><br /><font color="#808080">rem ** Number systems conversation utility&nbsp;&nbsp;&nbsp;&nbsp;**</font><br /><font color="#808080">rem ********************************************</font><br /><font color="#808080">rem ** Copyright (C) 2005 by J.M. Meyer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**</font><br /><font color="#808080">rem ********************************************</font><br /><br /><font color="#808080">rem *************</font><br /><font color="#808080">rem ** GLOBALS **</font><br /><font color="#808080">rem *************</font><br /><br /><font color="#808080">rem --- importing library help functions ---</font><br /><font color="#008000">include 'math.rb'</font><br /><font color="#008000">include 'dialog.rb'</font><br /><br /><font color="#808080">rem --- global variables (bases and digits of the number systems) ---</font><br /><b>dec</b> <font color="#000080">[bin]</font>, <font color="#000080">[oct]</font>, <font color="#000080">[hex]</font>, <font color="#000080">[current_base]</font><br /><br /><font color="#808080">rem basis 2 (binary number system)</font><br /><font color="#000080">[bin]</font> = <font color="#0000ff">'01'</font><br /><font color="#808080">rem basis 8 (octal number system)</font><br /><font color="#000080">[oct]</font> = <font color="#0000ff">'01234567'</font><br /><font color="#808080">rem basis 16 (hexadecimal number system)</font><br /><font color="#000080">[hex]</font> = <font color="#0000ff">'0123456789ABCDEF'</font><br /><br /><font color="#808080">rem *********************</font><br /><font color="#808080">rem ** IMPLEMENTATIONS **</font><br /><font color="#808080">rem *********************</font><br /><br /><font color="#808080">rem --- implementation of the procedure "calc_target_value" ---</font><br /><b>proc</b> calc_target_value<br />&nbsp;&nbsp;&nbsp;&nbsp;<b>dec</b> <font color="#000080">[decimal]</font>, <font color="#000080">[convert]</font><br /><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem calculate value in the target number system from the decimal value</font><br />&nbsp;&nbsp;&nbsp;&nbsp;getdialog <font color="#000080">[decimal]</font> = <font color="#0000ff">'converter:decimal'</font>, <font color="#0000ff">'text'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[decimal]</font> ! <font color="#0000ff">''</font><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rem calculating the value</font><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rem (using the decimal_to_base-library function)</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decimal_to_base <font color="#000080">[target]</font> = <font color="#000080">[decimal]</font>, <font color="#000080">[current_base]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[target]</font> = <font color="#0000ff">'-1'</font> <font color="#000080">[target]</font> = <font color="#0000ff">'Error'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>endif</b><br /><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem set the calculated value to the target field</font><br />&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'converter:target'</font>, <font color="#0000ff">'text'</font>, <font color="#000080">[target]</font><br /><b>endproc</b><br /><br /><font color="#808080">rem --- implementation of the procedure "calc_decimal_value" ---</font><br /><b>proc</b> calc_decimal_value<br />&nbsp;&nbsp;&nbsp;&nbsp;<b>dec</b> <font color="#000080">[decimal]</font>, <font color="#000080">[target]</font><br /><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem calculating the decimal value from the currently activated number system</font><br />&nbsp;&nbsp;&nbsp;&nbsp;getdialog <font color="#000080">[target]</font> = <font color="#0000ff">'converter:target'</font>, <font color="#0000ff">'text'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[target]</font> ! <font color="#0000ff">''</font><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rem calculating the decimal value</font><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rem (using the base_to_decimal-library function)</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base_to_decimal <font color="#000080">[decimal]</font> = <font color="#000080">[target]</font>, <font color="#000080">[current_base]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[decimal]</font> = <font color="#0000ff">'-1'</font> <font color="#000080">[decimal]</font> = <font color="#0000ff">'Error'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>endif</b><br /><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem set the calculated value to the decimal field</font><br />&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'converter:decimal'</font>, <font color="#0000ff">'text'</font>, <font color="#000080">[decimal]</font><br /><b>endproc</b><br /><br /><font color="#808080">rem --- implementation of the procedure "set_number_system" ---</font><br /><b>proc</b> set_number_system: <font color="#000080">[number_system]</font><br /><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem removing the checkmarks from the menu items</font><br />&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'converter:Menu_Decimal -&gt; &Octal'</font>, <font color="#0000ff">'checked'</font>, <font color="#000080">[false]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'converter:Menu_Decimal -&gt; &Hexadecimal'</font>, <font color="#0000ff">'checked'</font>, <font color="#000080">[false]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'converter:Menu_Decimal -&gt; &Binary'</font>, <font color="#0000ff">'checked'</font>, <font color="#000080">[false]</font><br /><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem updating the label in front of the target fields, check the</font><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem particular menu item again</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[number_system]</font> = <font color="#000080">[bin]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'converter:l_target'</font>, <font color="#0000ff">'caption'</font>, <font color="#0000ff">'Binary value:'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'converter:Menu_Decimal -&gt; &Binary'</font>, <font color="#0000ff">'checked'</font>, <font color="#000080">[true]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>elseif</b> <font color="#000080">[number_system]</font> = <font color="#000080">[oct]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'converter:l_target'</font>, <font color="#0000ff">'caption'</font>, <font color="#0000ff">'Octal value:'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'converter:Menu_Decimal -&gt; &Octal'</font>, <font color="#0000ff">'checked'</font>, <font color="#000080">[true]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>elseif</b> <font color="#000080">[number_system]</font> = <font color="#000080">[hex]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'converter:l_target'</font>, <font color="#0000ff">'caption'</font>, <font color="#0000ff">'Hexadecimal value:'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;letdialog <font color="#0000ff">'converter:Menu_Decimal -&gt; &Hexadecimal'</font>, <font color="#0000ff">'checked'</font>, <font color="#000080">[true]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>endif</b><br /><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem update the currently used base to the assigned value</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[current_base]</font> = <font color="#000080">[number_system]</font><br /><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem recalculate the target value</font><br />&nbsp;&nbsp;&nbsp;&nbsp;calc_target_value<br /><b>endproc</b><br /><br /><font color="#808080">rem *****************</font><br /><font color="#808080">rem ** MAIN SCRIPT **</font><br /><font color="#808080">rem *****************</font><br /><br /><font color="#808080">rem --- creating and setting up the main window ---</font><br />newdialog <font color="#0000ff">'converter'</font>, <font color="#0000ff">'dialog'</font>, <font color="#0000ff">'1|1|270|100'</font><br /><br /><font color="#808080">rem set the dialog's title bar text and style</font><br />letdialog <font color="#0000ff">'converter'</font>, <font color="#0000ff">'caption'</font>, <font color="#0000ff">'Bin/Oct/Hex Converter'</font><br />letdialog <font color="#0000ff">'converter'</font>, <font color="#0000ff">'style'</font>, <font color="#0000ff">'single'</font><br /><br /><font color="#808080">rem assign menu tree</font><br /><font color="#000080">[menu]</font> = <font color="#0000ff">'&Mode:Decimal -&gt; &Binary|Decimal -&gt; &Octal|Decimal -&gt; &Hexadecimal;;'</font><br />letdialog <font color="#0000ff">'converter'</font>, <font color="#0000ff">'menu'</font>, <font color="#000080">[menu]</font><br /><br /><font color="#808080">rem --- creating input fields and labels ---</font><br /><br /><font color="#808080">rem label and input-field for the decimal number</font><br />newdialog <font color="#0000ff">'converter:l_decimal'</font>, <font color="#0000ff">'label'</font>, <font color="#0000ff">'5|8|100|22'</font><br />letdialog <font color="#0000ff">'converter:l_decimal'</font>, <font color="#0000ff">'caption'</font>, <font color="#0000ff">'Decimal value:'</font><br />newdialog <font color="#0000ff">'converter:decimal'</font>, <font color="#0000ff">'input'</font>, <font color="#0000ff">'110|4|150|25'</font><br />letdialog <font color="#0000ff">'converter:decimal'</font>, <font color="#0000ff">'font'</font>, <font color="#0000ff">'Sans Serif|10|2'</font><br />letdialog <font color="#0000ff">'converter:decimal'</font>, <font color="#0000ff">'event_change'</font>, <font color="#000080">[true]</font><br /><br /><font color="#808080">rem label and input-field for the number in the target number system</font><br />newdialog <font color="#0000ff">'converter:l_target'</font>, <font color="#0000ff">'label'</font>, <font color="#0000ff">'5|34|100|22'</font><br />newdialog <font color="#0000ff">'converter:target'</font>, <font color="#0000ff">'input'</font>, <font color="#0000ff">'110|30|150|25'</font><br />letdialog <font color="#0000ff">'converter:target'</font>, <font color="#0000ff">'font'</font>, <font color="#0000ff">'Sans Serif|10|2'</font><br />letdialog <font color="#0000ff">'converter:target'</font>, <font color="#0000ff">'event_change'</font>, <font color="#000080">[true]</font><br /><br /><font color="#808080">rem by default, use binary number system</font><br />set_number_system <font color="#000080">[bin]</font><br /><br /><font color="#808080">rem --- centering the dialog on the screen and makeing it visible ---</font><br />centerdialog <font color="#0000ff">'converter'</font><br />letdialog <font color="#0000ff">'converter'</font>, <font color="#0000ff">'visible'</font>, <font color="#000080">[true]</font><br />letdialog <font color="#0000ff">'converter:decimal'</font>, <font color="#0000ff">'focus'</font>, <font color="#000080">[true]</font><br /><br /><font color="#808080">rem --- start the dialog event handling loop ---</font><br /><b>repeat</b><br />&nbsp;&nbsp;&nbsp;&nbsp;rundialog <font color="#000080">[event]</font> = <font color="#0000ff">'0'</font><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[event]</font> = <font color="#0000ff">'change_converter:decimal'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;calc_target_value<br />&nbsp;&nbsp;&nbsp;&nbsp;<b>elseif</b> <font color="#000080">[event]</font> = <font color="#0000ff">'change_converter:target'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;calc_decimal_value<br />&nbsp;&nbsp;&nbsp;&nbsp;<b>elseif</b> <font color="#000080">[event]</font> = <font color="#0000ff">'click_converter:Menu_Decimal -&gt; &Binary'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set_number_system <font color="#000080">[bin]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>elseif</b> <font color="#000080">[event]</font> = <font color="#0000ff">'click_converter:Menu_Decimal -&gt; &Octal'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set_number_system <font color="#000080">[oct]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>elseif</b> <font color="#000080">[event]</font> = <font color="#0000ff">'click_converter:Menu_Decimal -&gt; &Hexadecimal'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set_number_system <font color="#000080">[hex]</font>&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;<b>endif</b><br /><br /><b>until</b> <font color="#000080">[event]</font> = <font color="#0000ff">'close_converter'</font><br /><b>end</b></div><!-- code END--><br /><br />

		<div class="line">&nbsp;</div>

		<div id="copyright">
			Copyright &copy; 2000-2006 by J.M.K S.F. Software Technologies, Jan Max Meyer<br />
			All rights reserved.
		</div>
	</body>
</html>
