<html>
	<head>
		<title>Arrays</title>
		<link rel="stylesheet" href="jmksf.css" type="text/css"></link>
	</head>

	<body>
		<div id="top">
			<img src="rb5.png" alt="RapidBATCH Logo" />
			Arrays
		</div>
		
		<div class="line">&nbsp;</div>
		
		Let's talk about one of the most powerful innovations coming along with RapidBATCH 5: Arrays!<br /><br />An array is a group of variables which are stored to one shared variable-name. On the one hand, arrays are used to access and store a huge amount of variables quickly, on the other hand, arrays make it possible to access variable data directly by specifying an indexing counter value.<br />In general, arrays provide the possibility to store nearly unlimited values in even multi-nested dimensions, using one single variable name. An array can be imagined as a table in the memory, where each line contains a value that can be accessed by the mentioned index counter.<br /><br />Many programming languages are providing both static and dynamic arrays. Static arrays are once defined and can only store the amount of values that has been specified. Dynamic arrays can contain a variable amount of values, that means the necessary memory for the dynamic array is completely reserved (and changed) at run-time. RapidBATCH uses only the second, even more powerful and flexible method: completely dynamic arrays. The script-programmer doesn't have to deal with the internal memory management of the array he uses - RapidBATCH handles the memory reservation and dimensioning of its arrays completely auotmated.<br /><br />A simple demonstration for the usage of an array is the following script. It stores 10 different names in one array that is declared as [names]. In the loop below, each row of the array is read out and shown in a messagebox.<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem declare and fill an array of 10 elements</font><br /><b>dec</b> <font color="#000080">[names:'10']</font><br /><font color="#000080">[names:'1']</font> = <font color="#0000ff">'Neo'</font><br /><font color="#000080">[names:'2']</font> = <font color="#0000ff">'Trinity'</font><br /><font color="#000080">[names:'3']</font> = <font color="#0000ff">'Morpheus'</font><br /><font color="#000080">[names:'4']</font> = <font color="#0000ff">'Roy'</font><br /><font color="#000080">[names:'5']</font> = <font color="#0000ff">'Earl'</font><br /><font color="#000080">[names:'6']</font> = <font color="#0000ff">'Dagobert'</font><br /><font color="#000080">[names:'7']</font> = <font color="#0000ff">'Michael'</font><br /><font color="#000080">[names:'8']</font> = <font color="#0000ff">'Marty'</font><br /><font color="#000080">[names:'9']</font> = <font color="#0000ff">'Doc Brown'</font><br /><font color="#000080">[names:'10']</font> = <font color="#0000ff">'Einstein'</font><br /><br /><font color="#808080">rem step through each array element and display it</font><br /><font color="#000080">[index]</font> = <font color="#0000ff">'0'</font><br /><b>repeat</b><br />&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[index]</font> + <font color="#0000ff">'1'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Name at position '</font> # <font color="#000080">[index]</font> # <font color="#0000ff">' is: '</font> # <font color="#000080">[names:[index]]</font><br /><b>until</b> <font color="#000080">[index]</font> = <font color="#0000ff">'10'</font><br /><b>end</b></div><!-- code END-->The next table visualizes how RapidBATCH stores the data of the array that is filled up in the above script.<br /><br /><table class="std" width="200" style="margin-left: 20px;">	<tr>		<td><b>Index:</b></td>		<td><b>Value:</b></td>	</tr>	<tr>		<td>1</td>		<td>Neo</td>	</tr>	<tr>		<td>2</td>		<td>Trinity</td>	</tr>	<tr>		<td>3</td>		<td>Morpheus</td>	</tr>	<tr>		<td>4</td>		<td>Roy</td>	</tr>	<tr>		<td>5</td>		<td>Earl</td>	</tr>	<tr>		<td>6</td>		<td>Dagobert</td>	</tr>	<tr>		<td>7</td>		<td>Michael</td>	</tr>	<tr>		<td>8</td>		<td>Marty</td>	</tr>	<tr>		<td>9</td>		<td>Doc Brown</td>	</tr>	<tr>		<td>10</td>		<td>Einstein</td>	</tr></table><br />Arrays can be defined, dimensioned and re-dimensioned using different ways. A simple array featuring for the time a number of 10 elements as used above can be pre-declared using the DEC-instruction: <br /><br /><!-- code BEGIN --><div class="code"><b>dec</b> <font color="#000080">[myArray:'10']</font></div><!-- code END-->In RapidBATCH, it is really a damn how the index value (in this case the constant value '10') is specified. It can be passed using the following ways:<br /><br /><!-- code BEGIN --><div class="code"><b>dec</b> <font color="#000080">[myArray'10']</font><br /><b>dec</b> <font color="#000080">[myArray '10']</font><br /><b>dec</b> <font color="#000080">['10'myArray]</font><br /><b>dec</b> <font color="#000080">[my'10'Array]</font></div><!-- code END-->Even the last line, that really looks very strange is a valid index value, and the array is declared as [myArray].<br /><br />As a matter of course, it is also possible to use a variable as an index counter to an array:<br /><br /><!-- code BEGIN --><div class="code"><font color="#000080">[index]</font> = <font color="#0000ff">'10'</font><br /><b>dec</b> <font color="#000080">[myArray:[index]]</font><br /><b>dec</b> <font color="#000080">[myArray[index]]</font><br /><b>dec</b> <font color="#000080">[my[index]Array]</font></div><!-- code END-->Colons, comas and blanks are simply ignored in the variable name, that means they are not urgently expected.<br /><br />Arrays are also declared automatically if a value is passed to any dimension that does not exist. This does also mean, that any ordinary variable which is available and used in RapidBATCH can be transformed into an array just by performing one assignment to an unexisting array index. The following script creates an array with three elements without a prior declaration. The elements are shown in reverse order.<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem fill up an array dynamically with three elements</font><br /><font color="#000080">[myArray:'1']</font> = <font color="#0000ff">'This is the first entry.'</font><br /><font color="#000080">[myArray:'2']</font> = <font color="#0000ff">'This is the second entry.'</font><br /><font color="#000080">[myArray:'3']</font> = <font color="#0000ff">'Finally, this is the third entry.'</font><br /><br /><font color="#808080">rem output the array in reverse order</font><br /><font color="#000080">[i]</font> = <font color="#0000ff">'3'</font><br /><b>repeat</b><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#000080">[myArray:[i]]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[i]</font> - <font color="#0000ff">'1'</font><br /><b>until</b> <font color="#000080">[i]</font> = <font color="#0000ff">'0'</font><br /><b>end</b></div><!-- code END-->To receive the number of elements within one dimension of an array, the element index '0' can be used. It returns the amount of entries within the given array dimension.<br /><br /><!-- code BEGIN --><div class="code"><font color="#000080">[myArray:'1']</font> = <font color="#0000ff">'This is the first entry.'</font><br /><font color="#000080">[myArray:'2']</font> = <font color="#0000ff">'This is the second entry.'</font><br /><font color="#000080">[myArray:'3']</font> = <font color="#0000ff">'Finally, this is the third entry.'</font><br /><br />echo <font color="#0000ff">'The array contains currently '</font> # <font color="#000080">[myArray:'0']</font> # <font color="#0000ff">' entries.'</font><br /><br /><font color="#000080">[i]</font> = <font color="#0000ff">'0'</font><br /><b>repeat</b><br />&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[i]</font> + <font color="#0000ff">'1'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Entry No. '</font> # <font color="#000080">[i]</font> # <font color="#0000ff">': '</font> # <font color="#000080">[myArray:[i]]</font><br /><b>until</b> <font color="#000080">[i]</font> = <font color="#000080">[myArray:'0']</font><br /><b>end</b></div><!-- code END-->As already mentioned above, arrays can feature different, nested dimensions. One dimension can be described as a sub-array in an array element, that means one array element has again one array it is associated with. An element of this second dimension can also contain another array-dimension. This can be done up to 9 different array dimensions, an immensely huge capacity that, if possible, never will be utilized.<br /><br />A multi-dimensional array is declared the same way as an &quot;ordinary&quot; array (whereas single-dimensional and multi-dimensional arrays are the same ;)) just by assigning a value to an inexistent dimension or by pre-declaring the array using the DEC statement - RapidBATCH handles the internal memory management completely itself.<br /><br />An example (whereas the use of the DEC statement is even optionally!):<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem declaring an array with 10x10x10 dimensions</font><br /><b>dec</b> <font color="#000080">[myArray:'10','10','10']</font><br /><font color="#000080">[myArray:'1','1','1']</font> = <font color="#0000ff">'Hello World'</font><br /><font color="#000080">[myArray:'1','1','2']</font> = <font color="#0000ff">'Arrays are very easy'</font><br /><font color="#000080">[myArray:'1','1','3']</font> = <font color="#0000ff">'to use and handle with'</font><br /><font color="#000080">[myArray:'1','2','1']</font> = <font color="#0000ff">'We currently '</font><br /><font color="#000080">[myArray:'1','2','2']</font> = <font color="#0000ff">'save values in'</font><br /><font color="#000080">[myArray:'1','2','3']</font> = <font color="#0000ff">'different dimensions!'</font></div><!-- code END-->At this point, RapidBATCH does also provide a special feature, that is never known from a programming language so far: Values can be saved into ANY dimension of an array at the same time! That means, you can save and access a value to [myArray:'1'] and also a completely different value to [myArray:'1','1'].<br /><br />A concretely example:<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem filling data to the array into different dimensions</font><br /><font color="#000080">[meinArray]</font> = <font color="#0000ff">'Basis'</font><br /><font color="#000080">[meinArray:'1']</font> = <font color="#0000ff">'First dimension, value 1'</font><br /><font color="#000080">[meinArray:'1','1']</font> = <font color="#0000ff">'Second dimension, value 1'</font><br /><font color="#000080">[meinArray:'1','1','1']</font> = <font color="#0000ff">'Third dimension, value 1'</font><br /><font color="#000080">[meinArray:'1','1','2']</font> = <font color="#0000ff">'Third dimension, value 2'</font><br /><font color="#000080">[meinArray:'1','2']</font> = <font color="#0000ff">'Second dimension, value 2'</font><br /><font color="#000080">[meinArray:'2']</font> = <font color="#0000ff">'First dimension, value 2'</font></div><!-- code END-->Especially to re-use and clean-up arrays, the RESET statement has been implemented to RapidBATCH. RESET cleans up a complete array and every dimension of it, so the array can be used again for other purposes or another run to fill it with data. E.g., this is very useful when a script maps files into an array within a REPEAT...UNTIL-loop. For each file, the array needs to be resetted using RESET and can be used again to map the next file.<br />RESET cleans a single variable (here, an empty string is assigned), a complete array including all dimensions, a single dimension of an array or even one single element, if it does not contain any sub-dimensions.<br /><br />A simple example that is demonstrating the usage of RESET:<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem fill an array with data</font><br /><font color="#000080">[myArray:'1']</font> = <font color="#0000ff">'This is the first entry.'</font><br /><font color="#000080">[myArray:'2']</font> = <font color="#0000ff">'This is the second entry.'</font><br /><font color="#000080">[myArray:'3']</font> = <font color="#0000ff">'Finally, this is the third entry.'</font><br />echo <font color="#0000ff">'The array does currently contain '</font> # <font color="#000080">[myArray:'0']</font> # <font color="#0000ff">' elements'</font><br /><br /><font color="#808080">rem reset the array</font><br /><b>reset</b> <font color="#000080">[myArray]</font><br />echo <font color="#0000ff">'The array does currently contain '</font> # <font color="#000080">[myArray:'0']</font> # <font color="#0000ff">' elements'</font><br /><br /><font color="#808080">rem refill the array again</font><br /><font color="#000080">[myArray:'1']</font> = <font color="#0000ff">'New content...'</font><br /><font color="#000080">[myArray:'2']</font> = <font color="#0000ff">'...and a second one ;)'</font><br />echo <font color="#0000ff">'The array does currently contain '</font> # <font color="#000080">[myArray:'0']</font> # <font color="#0000ff">' elements'</font><br /><b>end</b></div><!-- code END-->The advantages arrays provide are very versatile, especially their flexible dynamic, that is not featured by other programming- and scripting languages in this scale as it is the case in RapidBATCH 5 so far.<br /><br />

		<div class="line">&nbsp;</div>

		<div id="copyright">
			Copyright &copy; 2000-2006 by J.M.K S.F. Software Technologies, Jan Max Meyer<br />
			All rights reserved.
		</div>
	</body>
</html>
