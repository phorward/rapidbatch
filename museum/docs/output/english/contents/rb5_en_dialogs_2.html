<html>
	<head>
		<title>Prompting data from the user</title>
		<link rel="stylesheet" href="jmksf.css" type="text/css"></link>
	</head>

	<body>
		<div id="top">
			<img src="rb5.png" alt="RapidBATCH Logo" />
			Prompting data from the user
		</div>
		
		<div class="line">&nbsp;</div>
		
		To prompt values and information from the user, RapidBATCH provides three different, powerful build-in dialogs.<br /><br />The mostly used one is the INPUTBOX, that you had already learned to know in the previous examples. This dialog allows to prompt smaller values, e.g. numbers, names or labels, from the user. INPUTBOX is called as a function, which returns the text the user entered in the INPUTBOX's input-field to the corresponding return variable. As parameters, INPUTBOX expects three values: A dialog-title, a prompting text and an optional, pre-defined value that is displayed in the input-field of the dialog. This value can be modified and replaced by the user at dialog run-time.<br /><br />A simple example is the already in the basics-chapter presented script, where the script prompts the user for a name and displays this name in an ECHO-dialog.<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem Ask for the user's name</font><br />inputbox <font color="#000080">[user]</font> = <font color="#0000ff">'Name?'</font>, <font color="#0000ff">'What is your name?'</font>, <font color="#0000ff">''</font><br /><br /><font color="#808080">rem Output the prompted name</font><br />echo <font color="#0000ff">'Your name is: '</font> # <font color="#000080">[user]</font><br /><b>end</b></div><!-- code END--><div class="image"><img src="img/inputbox.gif" alt="Image of INPUTBOX-Dialog" title="INFOBOX-Dialog" /><br />The INPUTBOX-dialog for prompting value from the user</div>If the user clicks the OK-button (or also by simply pressing the Enter-key on the keyboard), the text that has been entered in the text-field is returned by the function. Else, if the user hits the Cancel-button (or presses Esc-key on the keyboard), an empty string is returned.<br /><br />The captions displayed on the buttons can be changed by setting the pre-declared variables [InputBox_Ok] and [InputBox_Cancel] to any desired value, for example in other languages than english. By default, the INPUTBOX is displayed centered on the screen; But this can also be changed, using the variables [InputBox_X] and [InputBox_Y]. This has the same effect as with the INFOBOX-dialog: The dialog can be moved to any position on the screen. By setting the value '0' to the particular variable (which is also the default value here again!), the dialog is centered on the particular axis.<br /><br /><!-- code BEGIN --><div class="code"><font color="#000080">[InputBox_Ok]</font> = <font color="#0000ff">'All right!'</font><br /><font color="#000080">[InputBox_Cancel]</font> = <font color="#0000ff">'Stop!!!'</font><br />inputbox <font color="#000080">[test]</font> = <font color="#0000ff">'Changed button captions'</font>, <font color="#0000ff">'Please enter something:'</font>, <font color="#0000ff">'Hello World'</font><br />echo <font color="#000080">[test]</font><br /><b>end</b></div><!-- code END-->Next to the INPUTBOX-dialog, RapidBATCH also provides the PWDBOX-dialog, which is nothing more than an &quot;INPUTBOX for prompting passwords&quot;, providing instead of a normal input-field a masked input-field, replacing each character with an asterisks (*). A PWDBOX-dialog may (and should!) only be used to prompt on passwords (because of that the &quot;PWD&quot; in &quot;PWDBOX&quot;, a shortcut for &quot;PassWorD&quot;). The parameters for the PWDBOX dialog are the same (also with the same effect) as the ones from INPUTBOX. Because PWDBOX interally uses the same dialog-window than INPUTBOX, the dialog's position is also defined by the variables [InputBox_X] and [InputBox_Y], and also the caption of the buttons can modified by setting [InputBox_Ok] and [InputBox_Cancel] to the desired values.<br /><br /><!-- code BEGIN --><div class="code">pwdbox <font color="#000080">[password]</font> = <font color="#0000ff">'Password'</font>, <font color="#0000ff">'Please enter your password:'</font>, <font color="#0000ff">''</font><br />echo <font color="#0000ff">'Your password is: '</font> # <font color="#000080">[password]</font><br /><b>end</b></div><!-- code END-->Yet, we only had been able to get single-line inputs from the user; Surely these will suffice in the most of all cases, but sometimes it is also necessary to let the user edit huger texts than just one single line. For this purpose, RapidBATCH provides the third of its build-in data input dialogs: The EDITBOX! The EDITBOX-dialog allows to edit a complete text, as it is known from the Windows Notepad-Editor. This dialog provides nothing more than a window, which can be resized, containing one multi-line edit field where text can be edited. On the bottom of the EDITBOX, an OK- and Cancel-button is available, to confirm or cancel the dialog. The success of an EDITBOX can be verified the same way like INPUTBOX: If the OK-button was hit, the function returns the text the user edited, else an empty string.<br /><div class="image"><img src="img/editbox.gif" alt="Screenshot of an EDITBOX-dialog" title="EDITBOX-Dialog" /><br />The EDITBOX-dialog to edit huger amounts of texts</div>Parameters of the EDITBOX-function are a dialog-title, an optional, pre-defined text that is displayed in the edit field at dialog startup and at least a so called mode-style value. This mode-style allows to use EDITBOX in two different modes: The edit-mode (default mode, turned on by specifying the value 'writeable', '0' or [true]) where the user can edit the text displayed in the text-field, and the readonly-mode (turned on by specifying the value 'readonly', '-1' or [false]), making the text read-only, so that it only can be viewed, but not changed. <br /><br />Example:<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem Editing larger texts like with a text editor using the EDITBOX-dialog</font><br />editbox <font color="#000080">[text]</font> = <font color="#0000ff">'Please enter a text:'</font>, <font color="#0000ff">''</font>, <font color="#0000ff">'writeable'</font><br />msgbox <font color="#0000ff">'The text you entered:'</font>, <font color="#000080">[text]</font>, <font color="#0000ff">'64'</font><br /><b>end</b></div><!-- code END-->The EDITBOX-dialog can be sized before the dialog startup using the variables [EditBox_Width] and [EditBox_Height]. Same as described in the previous dialogs, EDITBOX is also displayed centered, by default. To change its position to any desired screen-position, use the variables [EditBox_X] and [EditBox_Y], and set them to any pixel position you wish. By setting one of these two variables to value '0', the dialog is centered on the screen on the particular axis, as it is the case at the allready described dialogs.<br /><br />The captions of the buttons displayed on the EDITBOX-dialog can be changed equivalently to INPUTBOX, by using the pre-declared variables [EditBox_Ok] and [EditBox_Cancel]. By setting one of these variables to an empty-string, the particular button becomes invisible, so that it is not shown on the dialog at run-time. This can be useful, e.g. when you just want to view a text and provide a &quot;Next&quot;-button only. The following example, a file-viewer script, shows how this is be done (the functions OPENBOX and READFILE are discussed later):<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem file-viewer script using the EDITBOX-dialog</font><br /><br /><font color="#808080">rem prompt a filename to open and view</font><br />openbox <font color="#000080">[file]</font> = <font color="#0000ff">'Please select a file:'</font>, <font color="#0000ff">'Text files|*.txt'</font><br /><b>if</b> <font color="#000080">[file]</font> = <font color="#0000ff">''</font> <b>halt</b><br /><br /><font color="#808080">rem read file content to [text]</font><br />readfile <font color="#000080">[text]</font> = <font color="#000080">[file]</font>, <font color="#0000ff">'0'</font><br /><br /><font color="#808080">rem customize EDITBOX</font><br /><font color="#000080">[EditBox_Ok]</font> = <font color="#0000ff">''</font><br /><font color="#000080">[EditBox_Cancel]</font> = <font color="#0000ff">'&Next &gt;'</font><br /><font color="#000080">[EditBox_Width]</font> = <font color="#0000ff">'450'</font><br /><font color="#000080">[EditBox_Height]</font> = <font color="#0000ff">'480'</font><br /><br /><font color="#808080">rem display the text...</font><br />editbox <font color="#000080">[text]</font> = <font color="#0000ff">'Content of '</font> # <font color="#000080">[file]</font>, <font color="#000080">[text]</font>, <font color="#0000ff">'readonly'</font><br /><b>end</b></div><!-- code END--><br /><br />

		<div class="line">&nbsp;</div>

		<div id="copyright">
			Copyright &copy; 2000-2006 by J.M.K S.F. Software Technologies, Jan Max Meyer<br />
			All rights reserved.
		</div>
	</body>
</html>
