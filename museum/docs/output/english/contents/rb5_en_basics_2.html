<html>
	<head>
		<title>Working with variables</title>
		<link rel="stylesheet" href="jmksf.css" type="text/css"></link>
	</head>

	<body>
		<div id="top">
			<img src="rb5.png" alt="RapidBATCH Logo" />
			Working with variables
		</div>
		
		<div class="line">&nbsp;</div>
		
		Now that you have written and ran your first script, we will begin a slightly different part of programming, the <i>variables</i>. Variables are the key to complex and flexible computer programs which act and run on the basis of variable data (because the workflow of a program depends on this variable data).<br />The next script should now demonstrate how variables are used and what an (important) role they can play. Create a new, empty script in the RapidBATCH Builder and enter the following source code:<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem Ask for the user's name</font><br />inputbox <font color="#000080">[user]</font> = <font color="#0000ff">'Name?'</font>, <font color="#0000ff">'What is your name?'</font>, <font color="#0000ff">''</font><br /><br /><font color="#808080">rem Output the prompted name</font><br />echo <font color="#000080">[user]</font><br /><b>end</b></div><!-- code END-->This script prompts the user for his name by using the INPUTBOX-function. The name the user enters will be saved in the variable with the variable-name [user] in front of the equal-character (=). Variables are always written between brackets, and can be used anywhere you can use constant values. This is done by directly specifying the variable instead of the constant value. That's the case in the ECHO instruction following the INPUTBOX dialog. We specify the variable name instead of a constant data to the instruction, that means we output the dynamic content of the variable [user] (which can be any name or data the user entered) in this ECHO-messagebox.<br /><br />Variables in RapidBATCH can store both texts (also called &quot;strings&quot;, even character strings) and numbers (numerical values). The conversion between the different data types occurs internally so that you, the programmer, don't have to deal with this subject.<br />In the past versions of the RapidBATCH-series (until RapidBATCH 4.0), it had always been necessary to declare variables explicitly before their first usage by using the DEC instruction. You can still use DEC if you like, but variables are declared automatically now right when any value is assigned to them. DEC will also play an important role later, when we build own procedures and functions.<br /><br />Probably you have already noticed how variables are handled: You can store data into them and use this variable data instead of constant values in all instructions.<br /><br />To assign a constant value or the value of another variable to a variable, you need to do a so called assignment by following this scheme:<br /><br /><!-- code BEGIN --><div class="code"><font color="#000080">[variable]</font> = <font color="#0000ff">'Value'</font></div><!-- code END-->e.g.<br /><br /><!-- code BEGIN --><div class="code"><font color="#000080">[user]</font> = <font color="#0000ff">'Neo'</font></div><!-- code END-->or by assigning the content of an existing variable to a new one:<br /><br /><!-- code BEGIN --><div class="code"><font color="#000080">[user]</font> = <font color="#000080">[name]</font></div><!-- code END-->In variable assignments, values can also be joined and calculated. For this case, RapidBATCH provides six different operators which can be used to join values together or calculate values to receive a result.<br />The following script joins two values, a constant value with a variable value, using the join-operator (#), and assigns this new value to the variable [output]:<br /><br /><!-- code BEGIN --><div class="code"><font color="#000080">[output]</font> = <font color="#0000ff">'Your name is: '</font> # <font color="#000080">[user]</font></div><!-- code END-->Such a join (and also a calculation) can also be assigned as a parameter value to any instruction/function:<br /><br /><!-- code BEGIN --><div class="code">echo <font color="#0000ff">'Your name is: '</font> # <font color="#000080">[user]</font></div><!-- code END-->Using the operators +, -, *, / and ~ for addition, subtraction, multiplication, division and modulo, variables and also values can be calculated. The only condition that must be given is, that all values used within the calculation contain numerical data. For example, when you want to calculate a variable containing the string 'Hello', RapidBATCH internally handles it as value '0'.<br /><br />The following script demonstrates how to sum two values together using the addition-operator (+): <br /><br /><!-- code BEGIN --><div class="code"><font color="#000080">[a]</font> = <font color="#0000ff">'2'</font><br /><font color="#000080">[b]</font> = <font color="#0000ff">'5'</font><br /><font color="#000080">[result]</font> = <font color="#000080">[a]</font> + <font color="#000080">[b]</font><br />echo <font color="#000080">[a]</font> # <font color="#0000ff">' + '</font> # <font color="#000080">[b]</font> # <font color="#0000ff">' results '</font> # <font color="#000080">[result]</font><br /><b>end</b></div><!-- code END-->Because calculations can be performed everywhere, the following scripts brings the same result<br /><br /><!-- code BEGIN --><div class="code"><font color="#000080">[a]</font> = <font color="#0000ff">'2'</font><br /><font color="#000080">[b]</font> = <font color="#0000ff">'5'</font><br />echo <font color="#000080">[a]</font> # <font color="#0000ff">' + '</font> # <font color="#000080">[b]</font> # <font color="#0000ff">' results '</font> # (<font color="#000080">[a]</font> + <font color="#000080">[b]</font>)<br /><b>end</b></div><!-- code END-->Here, we don't assign the result of the calculation to a variable first but we directly calculate it when we perform the output. Brackets (...) can be used within formulas and joins wherever wanted. RapidBATCH 5 is very flexible and versatile in performing calculations - It is also possible to calculate huge formulas in one single line.<br /><br /><!-- code BEGIN --><div class="code"><font color="#000080">[a]</font> = <font color="#0000ff">'5'</font><br /><font color="#000080">[b]</font> = <font color="#0000ff">'12'</font><br />echo <font color="#000080">[a]</font> * (<font color="#000080">[b]</font> + <font color="#0000ff">'4'</font> * (<font color="#000080">[a]</font> - <font color="#0000ff">'2'</font>)) / <font color="#000080">[b]</font><br /><b>end</b></div><!-- code END-->The above script will result the value 10 when it is executed!<br /><br />Sometimes it is necessary to calculate a variable and assign this calculated value to the variable again. For such cases, RapidBATCH 5 provides a shortcut as used in the following assignment:<br /><br /><!-- code BEGIN --><div class="code"><font color="#000080">[a]</font> + <font color="#0000ff">'5'</font></div><!-- code END-->the above line is equal to the following assignment:<br /><br /><!-- code BEGIN --><div class="code"><font color="#000080">[a]</font> = <font color="#000080">[a]</font> + <font color="#0000ff">'5'</font></div><!-- code END-->The short assignments can be used with all RapidBATCH standard-operators (#,+,-,*,/,~).<br /><br />

		<div class="line">&nbsp;</div>

		<div id="copyright">
			Copyright &copy; 2000-2006 by J.M.K S.F. Software Technologies, Jan Max Meyer<br />
			All rights reserved.
		</div>
	</body>
</html>
