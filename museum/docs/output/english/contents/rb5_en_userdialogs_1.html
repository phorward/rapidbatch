<html>
	<head>
		<title>Implementing user-defined dialog windows</title>
		<link rel="stylesheet" href="jmksf.css" type="text/css"></link>
	</head>

	<body>
		<div id="top">
			<img src="rb5.png" alt="RapidBATCH Logo" />
			Implementing user-defined dialog windows
		</div>
		
		<div class="line">&nbsp;</div>
		
		With RapidBATCH 5, implementing user-defined dialog windows is now possible for the first time! RapidBATCH uses a simple, but very efficient, elaborated and easy to use system, making it possibile to create dialog window elements and change and read out their behavior, appeareance and contents.<br /><br />With only five different instructions and functions, you're able to develop and design completely individual Windows-applications of any kind by yourself!<br /><br />When implementing own dialogs using the RapidBATCH scripting platform, you have to implement your applications by following these four steps:<ul>	<li>Creating the dialog widgets</li>	<li>Setting up the dialog widget's attributes and behavior</li>	<li>Making the dialog window visible</li>	<li>Runing the dialog, react on events</li></ul>The following script does exactly these four steps. It creates a dialog with an input-field and a button. If the user clicks the button, the text, that was inserted into the input-field, is displayed in a messagebox.<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem creating the dialog widgets</font><br />newdialog <font color="#0000ff">'myDialog'</font>, <font color="#0000ff">'DIALOG'</font>, <font color="#0000ff">'1|1|300|80'</font><br />newdialog <font color="#0000ff">'myDialog:Input'</font>, <font color="#0000ff">'INPUT'</font>, <font color="#0000ff">'10|1|273|25'</font><br />newdialog <font color="#0000ff">'myDialog:Go'</font>, <font color="#0000ff">'BUTTON'</font>, <font color="#0000ff">'80|27|140|25'</font><br /><br /><font color="#808080">rem setting up the dialog widget's attributes and behavior</font><br />letdialog <font color="#0000ff">'myDialog'</font>, <font color="#0000ff">'CAPTION'</font>, <font color="#0000ff">'Hello World'</font><br />letdialog <font color="#0000ff">'myDialog:Input'</font>, <font color="#0000ff">'TEXT'</font>, <font color="#0000ff">'This is a text you can edit!'</font><br />letdialog <font color="#0000ff">'myDialog:Go'</font>, <font color="#0000ff">'CAPTION'</font>, <font color="#0000ff">'Click me!'</font><br /><br /><font color="#808080">rem make the dialog window visible</font><br />letdialog <font color="#0000ff">'myDialog'</font>, <font color="#0000ff">'VISIBLE'</font>, <font color="#000080">[true]</font><br /><br /><b>repeat</b><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem run the dialog</font><br />&nbsp;&nbsp;&nbsp;&nbsp;rundialog <font color="#000080">[event]</font> = <font color="#0000ff">'0'</font><br /><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem evaluate the event</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[event]</font> = <font color="#0000ff">'click_myDialog:Go'</font><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rem get the text from the input field</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;getdialog <font color="#000080">[text]</font> = <font color="#0000ff">'myDialog:Input'</font>, <font color="#0000ff">'TEXT'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'The value in the input field is: '</font> # <font color="#000080">[text]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>endif</b><br /><b>until</b> <font color="#000080">[event]</font> = <font color="#0000ff">'close_myDialog'</font><br /><b>end</b></div><!-- code END--><div class="image"><img src="img/dlgapp_01.gif" alt="User-defined dialog window" title="Screenshot" /><br />Script with an individually designed dialog window</div>I will now introduce you step-by-step into this world of the nearly unlimited possibilites, because this new, very effective feature lifts RapidBATCH up to a powerful, high-level Windows programming language enabling you to build and develop your own user interfaces and powerful software-applications for the Windows&reg; operating system.<div class="remark">Note: In the following, I will use the word &quot;Widget&quot; for many times. As widget, a abbreviation for &quot;Window Gadget&quot;, I both mean dialog windows themselves as well as the so called dialog elements like buttons or input-fields, that are positioned and displayed on the dialog. The difference between dialog windows and dialog elements is described later.</div><div class="remark">Tip: If you're using RapidBATCH Professional Edition, you have the possibility of creating dialogs very easily using the &quot;RapidBATCH Visual Dialog Designer&quot;, a very useful utility that allows the real-time creation, positioning and editing of widgets in a WYSIWYG-environment (What You See Is What You Get). When you finished your design, the program generates the complete RapidBATCH script source code that is necessary to show and set-up the whole dialog you designed. Only the events for the different widgets need to be implemented into this generated script. But anyway, when you decide to use the Visual Dialog Designer to create your dialogs, please continue reading this chapter to understand how user-defined dialog programming is performed manually in the RapidBATCH scripting language.</div>To create widgets, the instruction NEWDIALOG is used. As it appears in the above example, NEWDIALOG expects as parameter values a so called widget-label, which can be seen as a &quot;name&quot; for the window object. This label must be unique, it is not possible to manage different widgets under the same label. Next to the widget-label, NEWDIALOG expects the type of the widget that should be created, for example a dialog, an input-field or a button, etc.. As the third parameter, the coordinates where the widget should be placed at, is specified. These coordinates, in pixels, are specified in the format &quot;X-Position|Y-Position|Width|Height&quot;, where each coordinate is separated by the standard list separation character (by default, the pipe-character, &quot;|&quot;): <br /><br />With the line<br /><br /><!-- code BEGIN --><div class="code">newdialog <font color="#0000ff">'myDialog'</font>, <font color="#0000ff">'DIALOG'</font>, <font color="#0000ff">'1|1|300|80'</font></div><!-- code END-->from our example-script, we're creating a new widget of the type &quot;DIALOG&quot; (which defines a dialog-basic window) with a width of 300 pixels and a height of 80 pixels, that is placed in the upper-left corner of the screen (X- and Y-coordinates 1|1). This dialog-window is associated with the name &quot;myDialog&quot;, to access it for later purposes.<br /><br />The following, two NEWDIALOG-instructions<br /><br /><!-- code BEGIN --><div class="code">newdialog <font color="#0000ff">'myDialog:Input'</font>, <font color="#0000ff">'INPUT'</font>, <font color="#0000ff">'10|1|273|25'</font><br />newdialog <font color="#0000ff">'myDialog:Go'</font>, <font color="#0000ff">'BUTTON'</font>, <font color="#0000ff">'80|27|140|25'</font></div><!-- code END-->are creating a single-line input-field (widget-type: &quot;INPUT&quot;) and a button (widget-type: &quot;BUTTON&quot;) on the dialog window &quot;myDialog&quot;. That these elements are placed and hold on the dialog-window &quot;myDialog&quot; can be seen on the prefixed &quot;myDialog:&quot;; The colon (:) advises RapidBATCH to create the widget as a child-element of &quot;myDialog&quot;. The widget will be created and associated with this label, for example &quot;myDialog:Input&quot;, that means that the parent window identifier &quot;myDialog&quot;, seperated by the colon from the proper widget name, &quot;Input&quot;, are building the unique labeling of the child-widget.<br /><br />The pixel positions that are specified at the child-elements being created are relative to the parent window, that means the objects are located on the specified coordinates, where position 1|1 is the upper-left corner of the parent-dialog's client area. Only the parent-dialog itself is located on the screen via screen-coordinates.<br /><br />After creating the widgets now, different values are set to them. In our case, the parent-dialog's caption is getting the caption &quot;Hello World&quot; in its title bar, the button gets the caption &quot;Click me!&quot; and the input-field gets the text &quot;This is a text you can edit!&quot;.<br /><!-- code BEGIN --><div class="code"><font color="#808080">rem setting up the dialog widget's attributes and behavior</font><br />letdialog <font color="#0000ff">'myDialog'</font>, <font color="#0000ff">'CAPTION'</font>, <font color="#0000ff">'Hello World'</font><br />letdialog <font color="#0000ff">'myDialog:Input'</font>, <font color="#0000ff">'TEXT'</font>, <font color="#0000ff">'This is a text you can edit!'</font><br />letdialog <font color="#0000ff">'myDialog:Go'</font>, <font color="#0000ff">'CAPTION'</font>, <font color="#0000ff">'Click me!'</font></div><!-- code END-->Each value is set using the LETDIALOG-instruction. LETDIALOG expects as parameter values the target widget's identifying label, the attribute-identifier of the attribute that should be changed or set-up and at least the related value. This last parameter sometimes must be specified in a formatted order which is based on the attribute that is specified.<br />The attribute identifier &quot;CAPTION&quot; sets the labeling of a widget, for example the dialog-window's title bar or the text displayed on the button. &quot;TEXT&quot; is used to set the text of an &quot;INPUT&quot;, &quot;EDIT&quot;, or &quot;COMBO&quot;-typed widget. Which attributes a widget provides is different from widget to widget. There is no widget supporting all attributes that are possible, e.g. a listbox has no caption, but a button having a caption can not store or display a list of items, which is the case at the listbox. More of these attributes will be discussed later.<br /><br />At least, by using the line<br /><br /><!-- code BEGIN --><div class="code">letdialog <font color="#0000ff">'myDialog'</font>, <font color="#0000ff">'VISIBLE'</font>, <font color="#000080">[true]</font></div><!-- code END-->the parent-dialog widget is made visible, by setting the VISIBLE-attribute of the dialog to [true] or '0'.<br />Only at parent-dialog widgets, the VISIBLE-attribute is set to '-1' or [false] (which means: Not visible) by default, when they are created. Child-widgets are automatically set to visible when they are created with NEWDIALOG. The reason for this is, that it is recommended to first create all dialog widgets and then make the parent-widget, which is the dialog-window itself, visible. If you make the dialog immediatelly visible after its creation, there may be a short flickering for some milliseconds when the other widgets are created on your dialog, and this does not look that nice. On smaller dialogs, this phenomen will not appear, but if you create greater dialogs, maybe based on dynamic data, this possibility is advantageous. You should always perform this, even more professional way.<div class="remark">Important: When you're creating dialogs in RapidBATCH by your own, make sure that the window really is visible before you execute the RUNDIALOG-function (which is discussed next). If no dialog window is visible and RUNDIALOG is executed without a timeout-value, the script waits for user events that can appear on the invisible dialog. And this will never be the case, because how should the user click e.g. a button that is not visible?</div>When all widget creations and their attribute-settings are done, the RapidBATCH-script calls the so called RUNDIALOG-function. This function starts an internal waiting loop that is executed until the user initiates a so called event with the existing dialog child-widgets or the dialog-window itself.<br /><br /><!-- code BEGIN --><div class="code">rundialog <font color="#000080">[event]</font> = <font color="#0000ff">'0'</font></div><!-- code END-->When this line is executed, the dialog can be used. When the user hits, for example, the button on our dialog, the function generates and returns a so called event-string, that is formatted in the order &quot;Event_Widget-IdentLabel&quot;. So if the user hits the &quot;Click me!&quot; button in our above example, RUNDIALOG returns the event-string &quot;click_myDialog:Go&quot;.<br />The numerical parameter that is specified at RUNDIALOG is an optional timeout value. If this value is set to '0' or a negative value, RUNDIALOG has no timeout and waits, until an event is initiated by the user (like in our current example). If this timeout is specified, e.g. the value '10000' (a timeout of 10 seconds), RUNDIALOG will wait for events only for these 10 seconds. If the user clicks the button within this time, an event-string is returned by RUNDIALOG, if nothing happens and the timeout is reached, RUNDIALOG returns an empty-string and continues the script execution.<br /><br />In the following IF-block, our script checks if the button was pressed, by comparing the event-string returned by RUNDIALOG with the constant verification string &quot;click_myDialog:Go&quot;. If this condition results true, the text from the input-field is determined, using the GETDIALOG-function, and displayed to the user over an ECHO-messagebox.<!-- code BEGIN --><div class="code"><b>repeat</b><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem run the dialog</font><br />&nbsp;&nbsp;&nbsp;&nbsp;rundialog <font color="#000080">[event]</font> = <font color="#0000ff">'0'</font><br /><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem evaluate the event</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[event]</font> = <font color="#0000ff">'click_myDialog:Go'</font><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rem get the text from the input field</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;getdialog <font color="#000080">[text]</font> = <font color="#0000ff">'myDialog:Input'</font>, <font color="#0000ff">'TEXT'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'The value in the input field is: '</font> # <font color="#000080">[text]</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>endif</b><br /><b>until</b> <font color="#000080">[event]</font> = <font color="#0000ff">'close_myDialog'</font></div><!-- code END-->GETDIALOG is the opposite of LETDIALOG. It does not set a widget's attribut, but reads it out and returns it. GETDIALOG expects the widget's label that should be read and the particular attribute. The return string is (not in all, but in the most cases) the same as specified at LETDIALOG.<br /><br />Now, I think you had understood the basics of individual, user-defined dialog creation in RapidBATCH. The concept RapidBATCH uses is very simple, but also very dynamic together. You can create a dynamic number of widgets and evenly work with them. In the next chapter, the different widgets RapidBATCH provides to create your individual dialog windows are discussed more detailed.<br /><br />The best way to get familar with these new possibilities, take a look to the numerous example scripts the RapidBATCH scripting package comes with, using user-defined dialogs and interfaces.<br /><br />

		<div class="line">&nbsp;</div>

		<div id="copyright">
			Copyright &copy; 2000-2006 by J.M.K S.F. Software Technologies, Jan Max Meyer<br />
			All rights reserved.
		</div>
	</body>
</html>
