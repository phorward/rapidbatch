<html>
	<head>
		<title>Message- and Statusboxes</title>
		<link rel="stylesheet" href="jmksf.css" type="text/css"></link>
	</head>

	<body>
		<div id="top">
			<img src="rb5.png" alt="RapidBATCH Logo" />
			Message- and Statusboxes
		</div>
		
		<div class="line">&nbsp;</div>
		
		RapidBATCH is equipped with many build-in dialog windows, that can be individually customized and optimized for the script they're used in. Before you begin to design your completely customized dialog windows in RapidBATCH (this subject will be discussed later), you first should take a look at the already existing build-in dialogs. These build-in dialogs mostly fit the needs of your RapidBATCH scripts. The advantage of using the build-in dialogs is, that you always have to write just one single line of code for e.g. read a value from the user or to display a text-message. Also you don't have to pay attention to the whole event-handling that is needed to make a dialog useable. Sure, for more powerful, individual and specialized dialog windows, you better should implement them for your own as described later, but there, you also have to code the complete event handing that has to be done behind the dialog. But anyway, this chapter now describes RapidBATCH's powerful build-in dialogs, how they're used and customized to bestly fit your purposes and use.<br /><br />Message windows, the so called messageboxes, are the simpliest form to present messages and data to the user, and can also be used for simple user interaction (to let the user match an option). You had already learned to know the ECHO-instruction, displaying a simple messagebox on the screen. ECHO is the simpliest possibility to dispay an information, which is also one of the reasons why it is mostly used within our examples, to output a value or something like that.<div class="image"><img src="img/echo.gif" alt="Image of an ECHO-dialog" title="ECHO-Dialog" /><br />Simple text output with the ECHO-instruction</div>A slightly similar purpose performs the CONFIRM-function, that displays a user dialog with a Yes-No-option. CONFIRM expects a return-variable (that gives information on the selected button), and a prompting text or question as parameter, that can be answered with &quot;Yes&quot; or &quot;No&quot;. If the user hits the &quot;Yes&quot;-button, CONFIRM will return the value '0', else '-1', so this &quot;answer&quot; can be verified within a condition specified at IF/ELSEIF or UNTIL.<div class="image"><img src="img/confirm.gif" alt="Image of a CONFIRM-dialog" title="CONFIRM-Dialog" /><br />A simple Yes-No-confirmation with the CONFIRM-dialog.</div>An example for the usage of the CONFIRM-function is the following script:<br /><br /><!-- code BEGIN --><div class="code">%start<br /><font color="#808080">rem ask to stop the script</font><br />confirm <font color="#000080">[stop]</font> = <font color="#0000ff">'Do you want to stop the script?'</font><br /><br /><font color="#808080">rem if "No" was hit, call the label "start"</font><br /><b>if</b> <font color="#000080">[stop]</font> = <font color="#0000ff">'-1'</font> <b>goto</b> <font color="#0000ff">'start'</font><br />echo <font color="#0000ff">'script was halted.'</font><br /><b>end</b></div><!-- code END-->Thus, ECHO and CONFIRM provide the most simple possibility to quickly display a message or to realize a Yes-No-prompt in your scripts.<br /><br />To create more individual messageboxes, RapidBATCH also provides the MSGBOX-instruction. MSGBOX exists both as an instruction and as a function, having the same name! The reason for this special usage of MSGBOX is, that the MSGBOX-instruction is supported for RapidBATCH script backward compatibility. Programmers should deal more with MSGBOX as a function, but MSGBOX as instruction will also be possible in future versions.<br /><br />MSGBOX expects as parameters a messagebox title, a message-text, and a so called messagebox-style value, that is represented by a calculated number.<br />A very simple messagebox is the result of the following line:<br /><br /><!-- code BEGIN --><div class="code">msgbox <font color="#0000ff">'Information'</font>, <font color="#0000ff">'Hello World'</font>, <font color="#0000ff">'0'</font></div><!-- code END-->Or, if we call it as a function:<br /><br /><!-- code BEGIN --><div class="code">msgbox <font color="#000080">[result]</font> = <font color="#0000ff">'Information'</font>, <font color="#0000ff">'Hello World'</font>, <font color="#0000ff">'0'</font></div><!-- code END-->The messagebox-style, that is assigned as the third parameter to the MSGBOX function or instruction, is composed of a value specifying the set of buttons that should be shown, a value that specifies which of the four messagebox-icons should be displayed, and at least a value, which of the displayed buttons should be focussed by default. To retrieve, which button has been pressed, MSGBOX returns a corresponding, numerical value to the variable [errorcode], or, in case of using MSGBOX as a function, to the particular return-variable that is specified.<br /><br />Possible button style values for messageboxes are the following ones:<br /><br /><!-- MESSAGEBOX-BUTTON-STYLES ------------------------------------------------------------------><table class="std" style="margin-left: 20px;" cellspacing="10"><tr>  <td style="padding-right: 10px;"><b>Style-ID:</b></td>  <td><b>Example:</b></td>  <td><b>Button-Style (particular return value for each button in brackets):</b></td></tr><tr>  <td>0</td><td style="padding-right: 10px;"><img src="img/msgbox_style0.gif" alt="Screenshot MSGBOX-Style 0" /></td><td>OK (1)</td></tr><tr>  <td>1</td><td style="padding-right: 10px;"><img src="img/msgbox_style1.gif" alt="Screenshot MSGBOX-Style 1" /></td><td>OK (1) + CANCEL (2)</td></tr><tr>  <td>2</td><td style="padding-right: 10px;"><img src="img/msgbox_style2.gif" alt="Screenshot MSGBOX-Style 2" /></td><td>CANCEL (3) + RETRY (4) + IGNORE (5)</td></tr><tr>  <td>3</td><td style="padding-right: 10px;"><img src="img/msgbox_style3.gif" alt="Screenshot MSGBOX-Style 3" /></td><td>YES (6) + NO (7) + CANCEL (2)</td></tr><tr>  <td>4</td><td style="padding-right: 10px;"><img src="img/msgbox_style4.gif" alt="Screenshot MSGBOX-Style 4" /></td><td>YES (6) + NO (7)</td></tr><tr>  <td>5</td><td style="padding-right: 10px;"><img src="img/msgbox_style5.gif" alt="Screenshot MSGBOX-Style 5" /></td><td>RETRY (4) + CANCEL (2)</td></tr></table><!-- END MESSAGEBOX-BUTTON-STYLES --------------------------------------------------------------><br /><br />By adding one of the following values to the desired button-style, it is also possible to determine an icon that should be displayed on the left of the message text.<br /><br /><!-- MESSAGEBOX-ICON-STYLES ------------------------------------------------------------------><table class="std" style="margin-left: 20px;" cellspacing="10"><tr>  <td style="padding-right: 10px;"><b>Icon-Style:</b></td>  <td><b>Example:</b></td></tr><tr>  <td>0</td><td style="padding-right: 10px;"><img src="img/msgbox_icon0.gif" alt="Screenshot without Icon-Style" /></td></tr><tr>  <td>16</td><td style="padding-right: 10px;"><img src="img/msgbox_icon16.gif" alt="Screenshot MSGBOX-Icon-Style 16" /></td></tr><tr>  <td>32</td><td style="padding-right: 10px;"><img src="img/msgbox_icon32.gif" alt="Screenshot MSGBOX-Icon-Style 32" /></td></tr><tr>  <td>48</td><td style="padding-right: 10px;"><img src="img/msgbox_icon48.gif" alt="Screenshot MSGBOX-Icon-Style 48" /></td></tr><tr>  <td>64</td><td style="padding-right: 10px;"><img src="img/msgbox_icon64.gif" alt="Screenshot MSGBOX-Icon-Style 64" /></td></tr></table><!-- END MESSAGEBOX-BUTTON-STYLES --------------------------------------------------------------><br /><br />An example for an individual messagebox with three buttons and a warning icon is the following:<br /><br /><!-- code BEGIN --><div class="code">%start<br />msgbox <font color="#000080">[button]</font> = <font color="#0000ff">'A simple question!'</font>, <font color="#0000ff">'Please hit one of the buttons.'</font>, <font color="#0000ff">'48'</font> + <font color="#0000ff">'3'</font><br /><br /><b>if</b> <font color="#000080">[button]</font> = <font color="#0000ff">'6'</font><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem Case: Yes</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'You hit the "Yes"-button'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>goto</b> start<br /><b>elseif</b> <font color="#000080">[button]</font> = <font color="#0000ff">'7'</font><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem Case: No</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'You hit the "No"-button'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>goto</b> start<br /><b>else</b><br /><font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;rem Case: Canel</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Goodbye!'</font><br /><b>endif</b></div><!-- code END-->By adding the value 0 to this style (for the first), 256 (for the second) or 512 (for the third) button, the keyboard input focus can be set to the desired button. Which button has the focus can be seen on the small, dashed rectagle around the button.<br /><br />Example:<br /><br /><!-- code BEGIN --><div class="code">msgbox <font color="#0000ff">'Test1'</font>, <font color="#0000ff">'Focus 1'</font>, <font color="#0000ff">'64'</font> + <font color="#0000ff">'3'</font> + <font color="#0000ff">'0'</font><br />msgbox <font color="#0000ff">'Test2'</font>, <font color="#0000ff">'Focus 2'</font>, <font color="#0000ff">'64'</font> + <font color="#0000ff">'3'</font> + <font color="#0000ff">'256'</font><br />msgbox <font color="#0000ff">'Test3'</font>, <font color="#0000ff">'Focus 3'</font>, <font color="#0000ff">'64'</font> + <font color="#0000ff">'3'</font> + <font color="#0000ff">'512'</font><br /><b>end</b></div><!-- code END-->Additionally to the messageboxes we talked about until now, RapidBATCH does also provide another possibility to display message- and status-information: The INFOBOX!<br /><br />Sometimes it is necessary to display status-informations, e.g. a &quot;Please wait...&quot;-message, when the script is performing a huge amount of system operations or by performing operations that need a lot of computing time. The INFOBOX-dialog can be shown or hidden whenever you, the programmer, wants this. It neither features any OK-button or something like that, nor it can be put into the background. It is just a box with information, displayed on the screen.<div class="image"><img src="img/infobox.gif" alt="Image of an INFOBOX-Dialog" title="INFOBOX-Dialog" /><br />Image of an INFOBOX-dialog displayed on the screen.</div>A simple example for the use of the INFOBOX-dialog is the following script, just showing a &quot;Hello World&quot; within an INFOBOX, delaying for a time of 5 seconds until it disappears again. To stop the script execution for a desired time, we use the WAIT-instruction here, which expects the number of milliseconds to be waited until the script is continued. 1 second is 1000 milliseconds.<br /><br /><!-- code BEGIN --><div class="code">infobox <font color="#0000ff">'Hello World'</font>, <font color="#0000ff">'show'</font><br />wait <font color="#0000ff">'5000'</font><br /><b>end</b></div><!-- code END-->In our case, INFOBOX is hidden automatically, because the script finished. To hide it manually, recall INFOBOX again in the following form<br /><br /><!-- code BEGIN --><div class="code">infobox <font color="#0000ff">''</font>, <font color="#0000ff">'hide'</font></div><!-- code END-->or hide it using the more professional method, over the pre-declared variable [InfoBox_Enabled]. Is [InfoBox_Enabled] set to '-1' (also represented by the pre-declated variable [false]) or the value 'hide', the dialog is hidden. By setting it to a value of 0 (also represented by the pre-declated variable [true]) or 'show', RapidBATCH shows INFOBOX again with the same message that was set at the last INFOBOX call.<br /><br />Example:<br /><br /><!-- code BEGIN --><div class="code">echo <font color="#0000ff">'INFOBOX becomes shown now...'</font><br /><br />infobox <font color="#0000ff">'Hello World'</font>, <font color="#0000ff">'show'</font><br />wait <font color="#0000ff">'2000'</font><br /><br />echo <font color="#0000ff">'INFOBOX becomes hidden now...'</font><br /><br /><font color="#000080">[InfoBox_Enabled]</font> = <font color="#0000ff">'hide'</font><br /><font color="#808080">rem also possible:</font><br /><font color="#808080">rem [InfoBox_Enabled] = [false]</font><br /><font color="#808080">rem [InfoBox_Enabled] = '-1'</font><br /><br />echo <font color="#0000ff">'INFOBOX is hidden now!'</font><br /><b>end</b></div><!-- code END-->Because INFOBOX is an own dialog provided by RapidBATCH (unlike the above discussed messageboxes, which are internally provided by the Windows&reg; operating system itself), INFOBOX can be completely individualized. For example, the programmer can define an individual width and height for the INFOBOX by setting the variables [InfoBox_Height] and [InfoBox_Width] to the desired size of pixels. By setting [InfoBox_X] and [InfoBox_Y] to a desired pixel position, the dialog can also be move to any point on the screen. By setting these variables to the value '0', the dialog is centered on the corresponding axis. By default, [InfoBox_X] and [InfoBox_Y] are both set to '0', centering the dialog automatically on the screen each time it is called.<br /><br />

		<div class="line">&nbsp;</div>

		<div id="copyright">
			Copyright &copy; 2000-2006 by J.M.K S.F. Software Technologies, Jan Max Meyer<br />
			All rights reserved.
		</div>
	</body>
</html>
