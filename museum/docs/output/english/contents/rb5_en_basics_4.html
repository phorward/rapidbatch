<html>
	<head>
		<title>Conditional programming</title>
		<link rel="stylesheet" href="jmksf.css" type="text/css"></link>
	</head>

	<body>
		<div id="top">
			<img src="rb5.png" alt="RapidBATCH Logo" />
			Conditional programming
		</div>
		
		<div class="line">&nbsp;</div>
		
		Now that you have gotten to know the great features of flexible programming using variables, this chapter will discuss how to handle conditions, that means how you can operate on this variable data in your scripts using conditions and loops.<br /><br />Let's begin with a simple script that asks for a password until the right password is entered. In this case, we use the instructions REPEAT and UNTIL to construct a loop, that repeats the PWDBOX-function (providing a hidden INPUTBOX-likely dialog to enter passwords) until the given password verification condition results true.<br /><br /><!-- code BEGIN --><div class="code"><font color="#808080">rem Ask for the password until the user enters 'hello'</font><br /><b>repeat</b><br />&nbsp;&nbsp;&nbsp;&nbsp;pwdbox <font color="#000080">[password]</font> = <font color="#0000ff">'Login'</font>, <font color="#0000ff">'Please enter the password:'</font>, <font color="#0000ff">''</font><br /><b>until</b> <font color="#000080">[password]</font> = <font color="#0000ff">'hello'</font><br /><br />echo <font color="#0000ff">'This password was right!'</font><br /><b>end</b></div><!-- code END-->When you run the script, you can see that the INPUTBOX always appears again until you enter the right password (&quot;hello&quot;). For this condition, we use the equal operator to verify the two values (which are the content of the variable [password] and the constant value 'hello') if they are equal. Possible operators are the equal-operator (=), the not-equal operator (!), the greater-than operator (&gt;), the lower-than operator (&lt;) and the greater-equal (&gt;=) and lower-equal (&lt;=) operators.<br />I advise insetting all the code between REPEAT and UNTIL using tabs or spaces. This contributes to a better code readability and makes it easier to find program errors (so called &quot;bugs&quot;) in huger scripts, because you're getting an overview of the script's structure much faster.<br /><br />But loops are not the only possibility in the conditional programming of RapidBATCH. The other, and more frequently used possibility is the IF instruction. This can be used with the instructions ELSEIF, ELSE and ENDIF in various, very complex constructions and algorithms.<br />The following examples demonstrate how these instructions can be used.<br /><br />A simple IF instruction would be<br /><br /><!-- code BEGIN --><div class="code"><b>if</b> <font color="#000080">[input]</font> = <font color="#0000ff">'hello'</font> echo <font color="#0000ff">'The prompted word was successfully verified to "hello"'</font></div><!-- code END-->In this case, the instruction (or function), that should be executed when the condition succeeds, is directly written behind the condition. To execute more than one instructions to one IF condition, you need to construct a so called &quot;IF block&quot;. It begins with an IF and the condition, then the code that should be executed when the condition succeeds and finally a closing ENDIF instruction at the bottom that marks the end of this IF block.<br /><br /><!-- code BEGIN --><div class="code"><b>if</b> <font color="#000080">[input]</font> = <font color="#0000ff">'hello'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'The prompted word was sucessfully verified to "hello"'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[x]</font> + <font color="#0000ff">'2'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[x]</font> &gt; <font color="#0000ff">'32'</font> <b>halt</b><br /><b>endif</b></div><!-- code END-->The line break behind the condition instructs the interpreter (or compiler), that the following lines belong to this instruction as an IF block, until the next ELSEIF, ELSE or ENDIF instruction.<br />To perform more than one verification in one IF block, use the ELSEIF instruction to verify another condition if the first condition fails:<br /><br /><!-- code BEGIN --><div class="code"><b>if</b> <font color="#000080">[input]</font> = <font color="#0000ff">'hello'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'The prompted word was sucessfully verified to "hello"'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[x]</font> + <font color="#0000ff">'2'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[x]</font> &gt; <font color="#0000ff">'32'</font> <b>halt</b><br /><b>elseif</b> <font color="#000080">[input]</font> = <font color="#0000ff">'bye'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Goodbye!'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>halt</b><br /><b>endif</b></div><!-- code END-->If none of the conditions succeed, if all IF/ELSEIF conditions fail, you can add an ELSE block that is executed in this case.<!-- code BEGIN --><div class="code"><b>if</b> <font color="#000080">[input]</font> = <font color="#0000ff">'hello'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'The prompted word was sucessfully verified to "hello"'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">[x]</font> + <font color="#0000ff">'2'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b> <font color="#000080">[x]</font> &gt; <font color="#0000ff">'32'</font> <b>halt</b><br /><b>elseif</b> <font color="#000080">[input]</font> = <font color="#0000ff">'bye'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Goodbye!'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>halt</b><br /><b>else</b><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'ERROR: Submission undefined.'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<b>goto</b> restart<br /><b>endif</b></div><!-- code END-->ELSE blocks are only allowed behind all ELSEIF blocks.<br />Sometimes it is necessary to perform more than one verifications within a REPEAT...UNTIL or IF/ELSEIF condition. For such cases, RapidBATCH provides so called logical condition operators, the AND-operator (&amp;) and the OR-operator (|). These operators are used to join two or more different verifications logically together, so that the whole condition is only true when all parts of it, based on the way they are joined, result true.<br /><br />When two conditions are joined with the OR-operator, only one of both verifications needs to be true. The following IF condition is executed when the prompted name is &quot;Peter&quot; or &quot;Maik&quot;.<br /><br /><!-- code BEGIN --><div class="code">inputbox <font color="#000080">[name]</font> = <font color="#0000ff">'Name?'</font>, <font color="#0000ff">'What is your name?'</font>, <font color="#0000ff">''</font><br /><br /><font color="#808080">rem is the name Peter or Maik?</font><br /><b>if</b> <font color="#000080">[name]</font> = <font color="#0000ff">'Peter'</font> | <font color="#000080">[name]</font> = <font color="#0000ff">'Maik'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Welcome '</font> # <font color="#000080">[name]</font><br /><b>else</b><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'You are not Peter or Maik!'</font><br /><b>endif</b><br /><b>end</b></div><!-- code END-->When joining two conditions using the AND-operator, both verifycations need to be true, else the condition is not fulfilled. The following script displays an error message when the users leaves both values blank.<br /><br /><!-- code BEGIN --><div class="code">inputbox <font color="#000080">[name]</font> = <font color="#0000ff">'Surname?'</font>, <font color="#0000ff">'What is your family name?'</font>, <font color="#0000ff">''</font><br />inputbox <font color="#000080">[fname]</font> = <font color="#0000ff">'First Name?'</font>, <font color="#0000ff">'And what is your first name?'</font>, <font color="#0000ff">''</font><br /><br /><font color="#808080">rem are name and first name both not empty?</font><br /><b>if</b> <font color="#000080">[name]</font> ! <font color="#0000ff">''</font> & <font color="#000080">[fname]</font> ! <font color="#0000ff">''</font><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'Hello '</font> # <font color="#000080">[fname]</font> # <font color="#0000ff">' '</font> # <font color="#000080">[name]</font><br /><b>else</b><br />&nbsp;&nbsp;&nbsp;&nbsp;echo <font color="#0000ff">'You have to enter both values!'</font><br /><b>endif</b><br /><b>end</b></div><!-- code END--><br /><br />

		<div class="line">&nbsp;</div>

		<div id="copyright">
			Copyright &copy; 2000-2006 by J.M.K S.F. Software Technologies, Jan Max Meyer<br />
			All rights reserved.
		</div>
	</body>
</html>
